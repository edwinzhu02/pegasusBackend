2019-07-16 10:18:11.229 +12:00 [INF] User profile is available. Using '/Users/oliver/.aspnet/DataProtection-Keys' as key repository; keys will not be encrypted at rest.
2019-07-16 10:44:58.410 +12:00 [INF] User profile is available. Using '/Users/oliver/.aspnet/DataProtection-Keys' as key repository; keys will not be encrypted at rest.
2019-07-16 10:45:40.286 +12:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/api/lesson/GetLessonsForReceptionist/3/2019-07-16  
2019-07-16 10:45:40.318 +12:00 [WRN] Failed to determine the https port for redirect.
2019-07-16 10:45:40.468 +12:00 [INF] Route matched with {action = "GetLessonsForReceptionist", controller = "Lesson"}. Executing action Pegasus_backend.Controllers.LessonController.GetLessonsForReceptionist (Pegasus_backend)
2019-07-16 10:45:40.601 +12:00 [INF] Executing action method Pegasus_backend.Controllers.LessonController.GetLessonsForReceptionist (Pegasus_backend) with arguments (["3","07/16/2019 00:00:00"]) - Validation state: "Valid"
2019-07-16 10:45:41.483 +12:00 [INF] Entity Framework Core 2.1.8-servicing-32085 initialized 'ablemusicContext' using provider 'MySql.Data.EntityFrameworkCore' with options: None
2019-07-16 10:45:44.949 +12:00 [INF] Executed DbCommand (62ms) [Parameters=[@__8__locals1_userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT `s`.`staff_id`, `s`.`dob`, `s`.`email`, `s`.`expiry_date`, `s`.`first_name`, `s`.`gender`, `s`.`home_phone`, `s`.`id_number`, `s`.`id_photo`, `s`.`id_type`, `s`.`ird_number`, `s`.`is_activate`, `s`.`last_name`, `s`.`mobile_phone`, `s`.`photo`, `s`.`user_id`, `s`.`visa`
FROM `ablemusic`.`staff` AS `s`
WHERE `s`.`user_id` = @__8__locals1_userId_0
LIMIT 1
2019-07-16 10:45:45.214 +12:00 [INF] Executed DbCommand (52ms) [Parameters=[@__staff_StaffId_0='?' (DbType = Int16)], CommandType='"Text"', CommandTimeout='30']
SELECT `s`.`staff_org_id`, `s`.`is_activate`, `s`.`org_id`, `s`.`staff_id`
FROM `ablemusic`.`staff_org` AS `s`
WHERE `s`.`staff_id` = @__staff_StaffId_0
LIMIT 1
2019-07-16 10:45:45.279 +12:00 [WRN] The Include operation for navigation '[s].CourseInstance' is unnecessary and was ignored because the navigation is not reachable in the final query results. See https://go.microsoft.com/fwlink/?linkid=850303 for more information.
2019-07-16 10:45:45.281 +12:00 [WRN] The Include operation for navigation '[s].Learner' is unnecessary and was ignored because the navigation is not reachable in the final query results. See https://go.microsoft.com/fwlink/?linkid=850303 for more information.
2019-07-16 10:45:45.281 +12:00 [WRN] The Include operation for navigation '[s].Teacher' is unnecessary and was ignored because the navigation is not reachable in the final query results. See https://go.microsoft.com/fwlink/?linkid=850303 for more information.
2019-07-16 10:45:45.281 +12:00 [WRN] The Include operation for navigation '[s].Room' is unnecessary and was ignored because the navigation is not reachable in the final query results. See https://go.microsoft.com/fwlink/?linkid=850303 for more information.
2019-07-16 10:45:45.281 +12:00 [WRN] The Include operation for navigation '[s].Org' is unnecessary and was ignored because the navigation is not reachable in the final query results. See https://go.microsoft.com/fwlink/?linkid=850303 for more information.
2019-07-16 10:45:45.281 +12:00 [WRN] The Include operation for navigation '[s].TrialCourse' is unnecessary and was ignored because the navigation is not reachable in the final query results. See https://go.microsoft.com/fwlink/?linkid=850303 for more information.
2019-07-16 10:45:45.282 +12:00 [WRN] The Include operation for navigation '[s].GroupCourseInstance.LearnerGroupCourse.Learner' is unnecessary and was ignored because the navigation is not reachable in the final query results. See https://go.microsoft.com/fwlink/?linkid=850303 for more information.
2019-07-16 10:45:45.282 +12:00 [WRN] The Include operation for navigation '[s].AwaitMakeUpLessonNewLesson' is unnecessary and was ignored because the navigation is not reachable in the final query results. See https://go.microsoft.com/fwlink/?linkid=850303 for more information.
2019-07-16 10:45:45.346 +12:00 [WRN] The LINQ expression 'where ((((Convert(Convert([s].OrgId, Int32), Nullable`1) == Convert(__orgId_0, Nullable`1)) AndAlso (Convert([s].BeginTime, DateTime).Year == __8__locals1_date_Year_1)) AndAlso (Convert([s].BeginTime, DateTime).Month == __8__locals1_date_Month_2)) AndAlso (Convert([s].BeginTime, DateTime).Day == __8__locals1_date_Day_3))' could not be translated and will be evaluated locally.
2019-07-16 10:45:45.631 +12:00 [INF] Executed DbCommand (104ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT `s.CourseInstance`.`course_instance_id`, `s.CourseInstance`.`begin_date`, `s.CourseInstance`.`course_id`, `s.CourseInstance`.`end_date`, `s.CourseInstance`.`invoice_date`, `s.CourseInstance`.`learner_id`, `s.CourseInstance`.`org_id`, `s.CourseInstance`.`room_id`, `s.CourseInstance`.`teacher_id`, `s.GroupCourseInstance`.`group_course_instance_id`, `s.GroupCourseInstance`.`begin_date`, `s.GroupCourseInstance`.`course_id`, `s.GroupCourseInstance`.`end_date`, `s.GroupCourseInstance`.`invoice_date`, `s.GroupCourseInstance`.`is_activate`, `s.GroupCourseInstance`.`is_started`, `s.GroupCourseInstance`.`org_id`, `s.GroupCourseInstance`.`room_id`, `s.GroupCourseInstance`.`teacher_id`, `s`.`org_id` AS `OrgId`, `s`.`begin_time` AS `start`, `s`.`lesson_id` AS `id`, `s`.`room_id` AS `resourceId`, `s`.`end_time` AS `end`, `s.Teacher`.`first_name` AS `TeacherName`, `s`.`is_canceled` AS `IsCanceled`, `s`.`is_confirm` AS `IsConfirm`, `s`.`is_changed` AS `IsChanged`, `s`.`reason`, CASE
    WHEN `s`.`is_paid` = 1
    THEN 0 ELSE 1
END, CASE
    WHEN (
        SELECT `q1`.`quantity`
        FROM `ablemusic`.`lesson_remain` AS `q1`
        WHERE ((`q1`.`learner_id` = `s`.`learner_id`) OR (`q1`.`learner_id` IS NULL AND `s`.`learner_id` IS NULL)) AND ((`q1`.`course_instance_id` = `s`.`course_instance_id`) OR (`q1`.`course_instance_id` IS NULL AND `s`.`course_instance_id` IS NULL))
        LIMIT 1
    ) <= 3
    THEN 1 ELSE 0
END, `s.Learner`.`first_name` AS `FirstName`, `s`.`learner_id` AS `LearnerId`, `s.Room`.`room_name` AS `RoomName`, `s.Org`.`org_name` AS `OrgName`, `s`.`teacher_id` AS `TeacherId`, `s.GroupCourseInstance.Course`.`course_name`, `s.TrialCourse`.`course_name`, `s.CourseInstance.Course`.`course_name`, `s.GroupCourseInstance.Course`.`course_id`, `s`.`trial_course_id`, `s.CourseInstance.Course`.`course_id`, `s`.`learner_id` AS `LearnerId0`
FROM `ablemusic`.`lesson` AS `s`
LEFT JOIN `ablemusic`.`course` AS `s.TrialCourse` ON `s`.`trial_course_id` = `s.TrialCourse`.`course_id`
INNER JOIN `ablemusic`.`org` AS `s.Org` ON `s`.`org_id` = `s.Org`.`org_id`
LEFT JOIN `ablemusic`.`room` AS `s.Room` ON `s`.`room_id` = `s.Room`.`room_id`
LEFT JOIN `ablemusic`.`learner` AS `s.Learner` ON `s`.`learner_id` = `s.Learner`.`learner_id`
LEFT JOIN `ablemusic`.`teacher` AS `s.Teacher` ON `s`.`teacher_id` = `s.Teacher`.`teacher_id`
LEFT JOIN `ablemusic`.`one2one_course_instance` AS `s.CourseInstance` ON `s`.`course_instance_id` = `s.CourseInstance`.`course_instance_id`
LEFT JOIN `ablemusic`.`course` AS `s.CourseInstance.Course` ON `s.CourseInstance`.`course_id` = `s.CourseInstance.Course`.`course_id`
LEFT JOIN `ablemusic`.`group_course_instance` AS `s.GroupCourseInstance` ON `s`.`group_course_instance_id` = `s.GroupCourseInstance`.`group_course_instance_id`
LEFT JOIN `ablemusic`.`course` AS `s.GroupCourseInstance.Course` ON `s.GroupCourseInstance`.`course_id` = `s.GroupCourseInstance.Course`.`course_id`
2019-07-16 10:45:46.574 +12:00 [INF] Executed DbCommand (638ms) [Parameters=[@_outer_LessonId='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT `r`.`lesson_id`, `r`.`begin_time`, `r`.`course_instance_id`, `r`.`created_at`, `r`.`end_time`, `r`.`group_course_instance_id`, `r`.`invoice_id`, `r`.`is_canceled`, `r`.`is_changed`, `r`.`is_confirm`, `r`.`is_paid`, `r`.`is_trial`, `r`.`learner_id`, `r`.`new_lesson_id`, `r`.`org_id`, `r`.`reason`, `r`.`room_id`, `r`.`teacher_id`, `r`.`trial_course_id`
FROM `ablemusic`.`lesson` AS `r`
WHERE `r`.`lesson_id` = @_outer_LessonId
LIMIT 1
2019-07-16 10:45:46.811 +12:00 [INF] Executed DbCommand (61ms) [Parameters=[@_outer_LessonId='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT `r`.`lesson_id`, `r`.`begin_time`, `r`.`course_instance_id`, `r`.`created_at`, `r`.`end_time`, `r`.`group_course_instance_id`, `r`.`invoice_id`, `r`.`is_canceled`, `r`.`is_changed`, `r`.`is_confirm`, `r`.`is_paid`, `r`.`is_trial`, `r`.`learner_id`, `r`.`new_lesson_id`, `r`.`org_id`, `r`.`reason`, `r`.`room_id`, `r`.`teacher_id`, `r`.`trial_course_id`
FROM `ablemusic`.`lesson` AS `r`
WHERE `r`.`lesson_id` = @_outer_LessonId
LIMIT 1
2019-07-16 10:45:47.019 +12:00 [INF] Executed DbCommand (58ms) [Parameters=[@_outer_LessonId='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT `r`.`lesson_id`, `r`.`begin_time`, `r`.`course_instance_id`, `r`.`created_at`, `r`.`end_time`, `r`.`group_course_instance_id`, `r`.`invoice_id`, `r`.`is_canceled`, `r`.`is_changed`, `r`.`is_confirm`, `r`.`is_paid`, `r`.`is_trial`, `r`.`learner_id`, `r`.`new_lesson_id`, `r`.`org_id`, `r`.`reason`, `r`.`room_id`, `r`.`teacher_id`, `r`.`trial_course_id`
FROM `ablemusic`.`lesson` AS `r`
WHERE `r`.`lesson_id` = @_outer_LessonId
LIMIT 1
2019-07-16 10:45:47.027 +12:00 [INF] Executed action method Pegasus_backend.Controllers.LessonController.GetLessonsForReceptionist (Pegasus_backend), returned result Microsoft.AspNetCore.Mvc.OkObjectResult in 6413.9491000000007ms.
2019-07-16 10:45:47.034 +12:00 [INF] Executing ObjectResult, writing value of type 'Pegasus_backend.Models.Result`1[[System.Object, System.Private.CoreLib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2019-07-16 10:45:47.126 +12:00 [INF] Executed action Pegasus_backend.Controllers.LessonController.GetLessonsForReceptionist (Pegasus_backend) in 6655.9452ms
2019-07-16 10:45:47.130 +12:00 [INF] Request finished in 6845.5029ms 200 application/json; charset=utf-8
2019-07-16 10:46:36.162 +12:00 [INF] User profile is available. Using '/Users/oliver/.aspnet/DataProtection-Keys' as key repository; keys will not be encrypted at rest.
2019-07-16 10:46:38.829 +12:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/api/lesson/GetLessonsForReceptionist/3/2019-07-16  
2019-07-16 10:46:38.855 +12:00 [WRN] Failed to determine the https port for redirect.
2019-07-16 10:46:38.987 +12:00 [INF] Route matched with {action = "GetLessonsForReceptionist", controller = "Lesson"}. Executing action Pegasus_backend.Controllers.LessonController.GetLessonsForReceptionist (Pegasus_backend)
2019-07-16 10:46:39.107 +12:00 [INF] Executing action method Pegasus_backend.Controllers.LessonController.GetLessonsForReceptionist (Pegasus_backend) with arguments (["3","07/16/2019 00:00:00"]) - Validation state: "Valid"
2019-07-16 10:46:39.926 +12:00 [INF] Entity Framework Core 2.1.8-servicing-32085 initialized 'ablemusicContext' using provider 'MySql.Data.EntityFrameworkCore' with options: None
2019-07-16 10:46:40.863 +12:00 [INF] Executed DbCommand (61ms) [Parameters=[@__8__locals1_userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT `s`.`staff_id`, `s`.`dob`, `s`.`email`, `s`.`expiry_date`, `s`.`first_name`, `s`.`gender`, `s`.`home_phone`, `s`.`id_number`, `s`.`id_photo`, `s`.`id_type`, `s`.`ird_number`, `s`.`is_activate`, `s`.`last_name`, `s`.`mobile_phone`, `s`.`photo`, `s`.`user_id`, `s`.`visa`
FROM `ablemusic`.`staff` AS `s`
WHERE `s`.`user_id` = @__8__locals1_userId_0
LIMIT 1
2019-07-16 10:46:41.123 +12:00 [INF] Executed DbCommand (53ms) [Parameters=[@__staff_StaffId_0='?' (DbType = Int16)], CommandType='"Text"', CommandTimeout='30']
SELECT `s`.`staff_org_id`, `s`.`is_activate`, `s`.`org_id`, `s`.`staff_id`
FROM `ablemusic`.`staff_org` AS `s`
WHERE `s`.`staff_id` = @__staff_StaffId_0
LIMIT 1
2019-07-16 10:46:41.172 +12:00 [WRN] The Include operation for navigation '[s].CourseInstance' is unnecessary and was ignored because the navigation is not reachable in the final query results. See https://go.microsoft.com/fwlink/?linkid=850303 for more information.
2019-07-16 10:46:41.174 +12:00 [WRN] The Include operation for navigation '[s].Learner' is unnecessary and was ignored because the navigation is not reachable in the final query results. See https://go.microsoft.com/fwlink/?linkid=850303 for more information.
2019-07-16 10:46:41.174 +12:00 [WRN] The Include operation for navigation '[s].Teacher' is unnecessary and was ignored because the navigation is not reachable in the final query results. See https://go.microsoft.com/fwlink/?linkid=850303 for more information.
2019-07-16 10:46:41.174 +12:00 [WRN] The Include operation for navigation '[s].Room' is unnecessary and was ignored because the navigation is not reachable in the final query results. See https://go.microsoft.com/fwlink/?linkid=850303 for more information.
2019-07-16 10:46:41.174 +12:00 [WRN] The Include operation for navigation '[s].Org' is unnecessary and was ignored because the navigation is not reachable in the final query results. See https://go.microsoft.com/fwlink/?linkid=850303 for more information.
2019-07-16 10:46:41.174 +12:00 [WRN] The Include operation for navigation '[s].TrialCourse' is unnecessary and was ignored because the navigation is not reachable in the final query results. See https://go.microsoft.com/fwlink/?linkid=850303 for more information.
2019-07-16 10:46:41.174 +12:00 [WRN] The Include operation for navigation '[s].GroupCourseInstance.LearnerGroupCourse.Learner' is unnecessary and was ignored because the navigation is not reachable in the final query results. See https://go.microsoft.com/fwlink/?linkid=850303 for more information.
2019-07-16 10:46:41.175 +12:00 [WRN] The Include operation for navigation '[s].AwaitMakeUpLessonNewLesson' is unnecessary and was ignored because the navigation is not reachable in the final query results. See https://go.microsoft.com/fwlink/?linkid=850303 for more information.
2019-07-16 10:46:41.233 +12:00 [WRN] The LINQ expression 'where ((((Convert(Convert([s].OrgId, Int32), Nullable`1) == Convert(__orgId_0, Nullable`1)) AndAlso (Convert([s].BeginTime, DateTime).Year == __8__locals1_date_Year_1)) AndAlso (Convert([s].BeginTime, DateTime).Month == __8__locals1_date_Month_2)) AndAlso (Convert([s].BeginTime, DateTime).Day == __8__locals1_date_Day_3))' could not be translated and will be evaluated locally.
2019-07-16 10:46:41.524 +12:00 [INF] Executed DbCommand (91ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT `s.CourseInstance`.`course_instance_id`, `s.CourseInstance`.`begin_date`, `s.CourseInstance`.`course_id`, `s.CourseInstance`.`end_date`, `s.CourseInstance`.`invoice_date`, `s.CourseInstance`.`learner_id`, `s.CourseInstance`.`org_id`, `s.CourseInstance`.`room_id`, `s.CourseInstance`.`teacher_id`, `s.GroupCourseInstance`.`group_course_instance_id`, `s.GroupCourseInstance`.`begin_date`, `s.GroupCourseInstance`.`course_id`, `s.GroupCourseInstance`.`end_date`, `s.GroupCourseInstance`.`invoice_date`, `s.GroupCourseInstance`.`is_activate`, `s.GroupCourseInstance`.`is_started`, `s.GroupCourseInstance`.`org_id`, `s.GroupCourseInstance`.`room_id`, `s.GroupCourseInstance`.`teacher_id`, `s`.`org_id` AS `OrgId`, `s`.`begin_time` AS `start`, `s`.`lesson_id` AS `id`, `s`.`room_id` AS `resourceId`, `s`.`end_time` AS `end`, `s.Teacher`.`first_name` AS `TeacherName`, `s`.`is_canceled` AS `IsCanceled`, `s`.`is_confirm` AS `IsConfirm`, `s`.`is_changed` AS `IsChanged`, `s`.`new_lesson_id`, `s`.`reason`, CASE
    WHEN `s`.`is_paid` = 1
    THEN 0 ELSE 1
END, CASE
    WHEN (
        SELECT `q1`.`quantity`
        FROM `ablemusic`.`lesson_remain` AS `q1`
        WHERE ((`q1`.`learner_id` = `s`.`learner_id`) OR (`q1`.`learner_id` IS NULL AND `s`.`learner_id` IS NULL)) AND ((`q1`.`course_instance_id` = `s`.`course_instance_id`) OR (`q1`.`course_instance_id` IS NULL AND `s`.`course_instance_id` IS NULL))
        LIMIT 1
    ) <= 3
    THEN 1 ELSE 0
END, `s.Learner`.`first_name` AS `FirstName`, `s`.`learner_id` AS `LearnerId`, `s.Room`.`room_name` AS `RoomName`, `s.Org`.`org_name` AS `OrgName`, `s`.`teacher_id` AS `TeacherId`, `s.GroupCourseInstance.Course`.`course_name`, `s.TrialCourse`.`course_name`, `s.CourseInstance.Course`.`course_name`, `s.GroupCourseInstance.Course`.`course_id`, `s`.`trial_course_id`, `s.CourseInstance.Course`.`course_id`, `s`.`learner_id` AS `LearnerId0`
FROM `ablemusic`.`lesson` AS `s`
LEFT JOIN `ablemusic`.`course` AS `s.TrialCourse` ON `s`.`trial_course_id` = `s.TrialCourse`.`course_id`
INNER JOIN `ablemusic`.`org` AS `s.Org` ON `s`.`org_id` = `s.Org`.`org_id`
LEFT JOIN `ablemusic`.`room` AS `s.Room` ON `s`.`room_id` = `s.Room`.`room_id`
LEFT JOIN `ablemusic`.`learner` AS `s.Learner` ON `s`.`learner_id` = `s.Learner`.`learner_id`
LEFT JOIN `ablemusic`.`teacher` AS `s.Teacher` ON `s`.`teacher_id` = `s.Teacher`.`teacher_id`
LEFT JOIN `ablemusic`.`one2one_course_instance` AS `s.CourseInstance` ON `s`.`course_instance_id` = `s.CourseInstance`.`course_instance_id`
LEFT JOIN `ablemusic`.`course` AS `s.CourseInstance.Course` ON `s.CourseInstance`.`course_id` = `s.CourseInstance.Course`.`course_id`
LEFT JOIN `ablemusic`.`group_course_instance` AS `s.GroupCourseInstance` ON `s`.`group_course_instance_id` = `s.GroupCourseInstance`.`group_course_instance_id`
LEFT JOIN `ablemusic`.`course` AS `s.GroupCourseInstance.Course` ON `s.GroupCourseInstance`.`course_id` = `s.GroupCourseInstance.Course`.`course_id`
2019-07-16 10:46:41.736 +12:00 [INF] Executed DbCommand (59ms) [Parameters=[@_outer_NewLessonId='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT `r`.`lesson_id`, `r`.`begin_time`, `r`.`course_instance_id`, `r`.`created_at`, `r`.`end_time`, `r`.`group_course_instance_id`, `r`.`invoice_id`, `r`.`is_canceled`, `r`.`is_changed`, `r`.`is_confirm`, `r`.`is_paid`, `r`.`is_trial`, `r`.`learner_id`, `r`.`new_lesson_id`, `r`.`org_id`, `r`.`reason`, `r`.`room_id`, `r`.`teacher_id`, `r`.`trial_course_id`
FROM `ablemusic`.`lesson` AS `r`
WHERE `r`.`lesson_id` = @_outer_NewLessonId
LIMIT 1
2019-07-16 10:46:42.303 +12:00 [INF] Executed DbCommand (165ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT `r`.`lesson_id`, `r`.`begin_time`, `r`.`course_instance_id`, `r`.`created_at`, `r`.`end_time`, `r`.`group_course_instance_id`, `r`.`invoice_id`, `r`.`is_canceled`, `r`.`is_changed`, `r`.`is_confirm`, `r`.`is_paid`, `r`.`is_trial`, `r`.`learner_id`, `r`.`new_lesson_id`, `r`.`org_id`, `r`.`reason`, `r`.`room_id`, `r`.`teacher_id`, `r`.`trial_course_id`
FROM `ablemusic`.`lesson` AS `r`
WHERE `r`.`lesson_id` IS NULL
LIMIT 1
2019-07-16 10:46:43.006 +12:00 [INF] Executed DbCommand (56ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT `r`.`lesson_id`, `r`.`begin_time`, `r`.`course_instance_id`, `r`.`created_at`, `r`.`end_time`, `r`.`group_course_instance_id`, `r`.`invoice_id`, `r`.`is_canceled`, `r`.`is_changed`, `r`.`is_confirm`, `r`.`is_paid`, `r`.`is_trial`, `r`.`learner_id`, `r`.`new_lesson_id`, `r`.`org_id`, `r`.`reason`, `r`.`room_id`, `r`.`teacher_id`, `r`.`trial_course_id`
FROM `ablemusic`.`lesson` AS `r`
WHERE `r`.`lesson_id` IS NULL
LIMIT 1
2019-07-16 10:46:43.013 +12:00 [INF] Executed action method Pegasus_backend.Controllers.LessonController.GetLessonsForReceptionist (Pegasus_backend), returned result Microsoft.AspNetCore.Mvc.OkObjectResult in 3894.2146000000002ms.
2019-07-16 10:46:43.020 +12:00 [INF] Executing ObjectResult, writing value of type 'Pegasus_backend.Models.Result`1[[System.Object, System.Private.CoreLib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2019-07-16 10:46:43.107 +12:00 [INF] Executed action Pegasus_backend.Controllers.LessonController.GetLessonsForReceptionist (Pegasus_backend) in 4117.5509ms
2019-07-16 10:46:43.110 +12:00 [INF] Request finished in 4282.4378ms 200 application/json; charset=utf-8
2019-07-16 10:51:35.742 +12:00 [INF] User profile is available. Using '/Users/oliver/.aspnet/DataProtection-Keys' as key repository; keys will not be encrypted at rest.
2019-07-16 10:51:42.345 +12:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/api/lesson/GetLessonsForReceptionist/3/2019-07-16  
2019-07-16 10:51:42.374 +12:00 [WRN] Failed to determine the https port for redirect.
2019-07-16 10:51:42.511 +12:00 [INF] Route matched with {action = "GetLessonsForReceptionist", controller = "Lesson"}. Executing action Pegasus_backend.Controllers.LessonController.GetLessonsForReceptionist (Pegasus_backend)
2019-07-16 10:51:42.631 +12:00 [INF] Executing action method Pegasus_backend.Controllers.LessonController.GetLessonsForReceptionist (Pegasus_backend) with arguments (["3","07/16/2019 00:00:00"]) - Validation state: "Valid"
2019-07-16 10:51:43.495 +12:00 [INF] Entity Framework Core 2.1.8-servicing-32085 initialized 'ablemusicContext' using provider 'MySql.Data.EntityFrameworkCore' with options: None
2019-07-16 10:51:44.413 +12:00 [INF] Executed DbCommand (60ms) [Parameters=[@__8__locals1_userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT `s`.`staff_id`, `s`.`dob`, `s`.`email`, `s`.`expiry_date`, `s`.`first_name`, `s`.`gender`, `s`.`home_phone`, `s`.`id_number`, `s`.`id_photo`, `s`.`id_type`, `s`.`ird_number`, `s`.`is_activate`, `s`.`last_name`, `s`.`mobile_phone`, `s`.`photo`, `s`.`user_id`, `s`.`visa`
FROM `ablemusic`.`staff` AS `s`
WHERE `s`.`user_id` = @__8__locals1_userId_0
LIMIT 1
2019-07-16 10:51:44.673 +12:00 [INF] Executed DbCommand (55ms) [Parameters=[@__staff_StaffId_0='?' (DbType = Int16)], CommandType='"Text"', CommandTimeout='30']
SELECT `s`.`staff_org_id`, `s`.`is_activate`, `s`.`org_id`, `s`.`staff_id`
FROM `ablemusic`.`staff_org` AS `s`
WHERE `s`.`staff_id` = @__staff_StaffId_0
LIMIT 1
2019-07-16 10:51:44.727 +12:00 [WRN] The Include operation for navigation '[s].CourseInstance' is unnecessary and was ignored because the navigation is not reachable in the final query results. See https://go.microsoft.com/fwlink/?linkid=850303 for more information.
2019-07-16 10:51:44.728 +12:00 [WRN] The Include operation for navigation '[s].Learner' is unnecessary and was ignored because the navigation is not reachable in the final query results. See https://go.microsoft.com/fwlink/?linkid=850303 for more information.
2019-07-16 10:51:44.728 +12:00 [WRN] The Include operation for navigation '[s].Teacher' is unnecessary and was ignored because the navigation is not reachable in the final query results. See https://go.microsoft.com/fwlink/?linkid=850303 for more information.
2019-07-16 10:51:44.729 +12:00 [WRN] The Include operation for navigation '[s].Room' is unnecessary and was ignored because the navigation is not reachable in the final query results. See https://go.microsoft.com/fwlink/?linkid=850303 for more information.
2019-07-16 10:51:44.729 +12:00 [WRN] The Include operation for navigation '[s].Org' is unnecessary and was ignored because the navigation is not reachable in the final query results. See https://go.microsoft.com/fwlink/?linkid=850303 for more information.
2019-07-16 10:51:44.729 +12:00 [WRN] The Include operation for navigation '[s].TrialCourse' is unnecessary and was ignored because the navigation is not reachable in the final query results. See https://go.microsoft.com/fwlink/?linkid=850303 for more information.
2019-07-16 10:51:44.729 +12:00 [WRN] The Include operation for navigation '[s].GroupCourseInstance.LearnerGroupCourse.Learner' is unnecessary and was ignored because the navigation is not reachable in the final query results. See https://go.microsoft.com/fwlink/?linkid=850303 for more information.
2019-07-16 10:51:44.729 +12:00 [WRN] The Include operation for navigation '[s].AwaitMakeUpLessonNewLesson' is unnecessary and was ignored because the navigation is not reachable in the final query results. See https://go.microsoft.com/fwlink/?linkid=850303 for more information.
2019-07-16 10:51:44.787 +12:00 [WRN] The LINQ expression 'where ((((Convert(Convert([s].OrgId, Int32), Nullable`1) == Convert(__orgId_0, Nullable`1)) AndAlso (Convert([s].BeginTime, DateTime).Year == __8__locals1_date_Year_1)) AndAlso (Convert([s].BeginTime, DateTime).Month == __8__locals1_date_Month_2)) AndAlso (Convert([s].BeginTime, DateTime).Day == __8__locals1_date_Day_3))' could not be translated and will be evaluated locally.
2019-07-16 10:51:45.059 +12:00 [INF] Executed DbCommand (87ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT `s.CourseInstance`.`course_instance_id`, `s.CourseInstance`.`begin_date`, `s.CourseInstance`.`course_id`, `s.CourseInstance`.`end_date`, `s.CourseInstance`.`invoice_date`, `s.CourseInstance`.`learner_id`, `s.CourseInstance`.`org_id`, `s.CourseInstance`.`room_id`, `s.CourseInstance`.`teacher_id`, `s.GroupCourseInstance`.`group_course_instance_id`, `s.GroupCourseInstance`.`begin_date`, `s.GroupCourseInstance`.`course_id`, `s.GroupCourseInstance`.`end_date`, `s.GroupCourseInstance`.`invoice_date`, `s.GroupCourseInstance`.`is_activate`, `s.GroupCourseInstance`.`is_started`, `s.GroupCourseInstance`.`org_id`, `s.GroupCourseInstance`.`room_id`, `s.GroupCourseInstance`.`teacher_id`, `s`.`org_id` AS `OrgId`, `s`.`begin_time` AS `start`, `s`.`lesson_id` AS `id`, `s`.`room_id` AS `resourceId`, `s`.`end_time` AS `end`, `s.Teacher`.`first_name` AS `TeacherName`, `s`.`is_canceled` AS `IsCanceled`, `s`.`is_confirm` AS `IsConfirm`, `s`.`is_changed` AS `IsChanged`, `s`.`new_lesson_id`, `s`.`reason`, CASE
    WHEN `s`.`is_paid` = 1
    THEN 0 ELSE 1
END, CASE
    WHEN (
        SELECT `q1`.`quantity`
        FROM `ablemusic`.`lesson_remain` AS `q1`
        WHERE ((`q1`.`learner_id` = `s`.`learner_id`) OR (`q1`.`learner_id` IS NULL AND `s`.`learner_id` IS NULL)) AND ((`q1`.`course_instance_id` = `s`.`course_instance_id`) OR (`q1`.`course_instance_id` IS NULL AND `s`.`course_instance_id` IS NULL))
        LIMIT 1
    ) <= 3
    THEN 1 ELSE 0
END, `s.Learner`.`first_name` AS `FirstName`, `s`.`learner_id` AS `LearnerId`, `s.Room`.`room_name` AS `RoomName`, `s.Org`.`org_name` AS `OrgName`, `s`.`teacher_id` AS `TeacherId`, `s.GroupCourseInstance.Course`.`course_name`, `s.TrialCourse`.`course_name`, `s.CourseInstance.Course`.`course_name`, `s.GroupCourseInstance.Course`.`course_id`, `s`.`trial_course_id`, `s.CourseInstance.Course`.`course_id`, `s`.`learner_id` AS `LearnerId0`
FROM `ablemusic`.`lesson` AS `s`
LEFT JOIN `ablemusic`.`course` AS `s.TrialCourse` ON `s`.`trial_course_id` = `s.TrialCourse`.`course_id`
INNER JOIN `ablemusic`.`org` AS `s.Org` ON `s`.`org_id` = `s.Org`.`org_id`
LEFT JOIN `ablemusic`.`room` AS `s.Room` ON `s`.`room_id` = `s.Room`.`room_id`
LEFT JOIN `ablemusic`.`learner` AS `s.Learner` ON `s`.`learner_id` = `s.Learner`.`learner_id`
LEFT JOIN `ablemusic`.`teacher` AS `s.Teacher` ON `s`.`teacher_id` = `s.Teacher`.`teacher_id`
LEFT JOIN `ablemusic`.`one2one_course_instance` AS `s.CourseInstance` ON `s`.`course_instance_id` = `s.CourseInstance`.`course_instance_id`
LEFT JOIN `ablemusic`.`course` AS `s.CourseInstance.Course` ON `s.CourseInstance`.`course_id` = `s.CourseInstance.Course`.`course_id`
LEFT JOIN `ablemusic`.`group_course_instance` AS `s.GroupCourseInstance` ON `s`.`group_course_instance_id` = `s.GroupCourseInstance`.`group_course_instance_id`
LEFT JOIN `ablemusic`.`course` AS `s.GroupCourseInstance.Course` ON `s.GroupCourseInstance`.`course_id` = `s.GroupCourseInstance.Course`.`course_id`
2019-07-16 10:51:45.271 +12:00 [INF] Executed DbCommand (60ms) [Parameters=[@_outer_NewLessonId='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT `r`.`lesson_id`, `r`.`begin_time`, `r`.`course_instance_id`, `r`.`created_at`, `r`.`end_time`, `r`.`group_course_instance_id`, `r`.`invoice_id`, `r`.`is_canceled`, `r`.`is_changed`, `r`.`is_confirm`, `r`.`is_paid`, `r`.`is_trial`, `r`.`learner_id`, `r`.`new_lesson_id`, `r`.`org_id`, `r`.`reason`, `r`.`room_id`, `r`.`teacher_id`, `r`.`trial_course_id`
FROM `ablemusic`.`lesson` AS `r`
WHERE `r`.`lesson_id` = @_outer_NewLessonId
LIMIT 1
2019-07-16 10:51:45.715 +12:00 [INF] Executed DbCommand (291ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT `r`.`lesson_id`, `r`.`begin_time`, `r`.`course_instance_id`, `r`.`created_at`, `r`.`end_time`, `r`.`group_course_instance_id`, `r`.`invoice_id`, `r`.`is_canceled`, `r`.`is_changed`, `r`.`is_confirm`, `r`.`is_paid`, `r`.`is_trial`, `r`.`learner_id`, `r`.`new_lesson_id`, `r`.`org_id`, `r`.`reason`, `r`.`room_id`, `r`.`teacher_id`, `r`.`trial_course_id`
FROM `ablemusic`.`lesson` AS `r`
WHERE `r`.`lesson_id` IS NULL
LIMIT 1
2019-07-16 10:51:45.899 +12:00 [INF] Executed DbCommand (54ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT `r`.`lesson_id`, `r`.`begin_time`, `r`.`course_instance_id`, `r`.`created_at`, `r`.`end_time`, `r`.`group_course_instance_id`, `r`.`invoice_id`, `r`.`is_canceled`, `r`.`is_changed`, `r`.`is_confirm`, `r`.`is_paid`, `r`.`is_trial`, `r`.`learner_id`, `r`.`new_lesson_id`, `r`.`org_id`, `r`.`reason`, `r`.`room_id`, `r`.`teacher_id`, `r`.`trial_course_id`
FROM `ablemusic`.`lesson` AS `r`
WHERE `r`.`lesson_id` IS NULL
LIMIT 1
2019-07-16 10:51:45.906 +12:00 [INF] Executed action method Pegasus_backend.Controllers.LessonController.GetLessonsForReceptionist (Pegasus_backend), returned result Microsoft.AspNetCore.Mvc.OkObjectResult in 3262.1721000000002ms.
2019-07-16 10:51:45.913 +12:00 [INF] Executing ObjectResult, writing value of type 'Pegasus_backend.Models.Result`1[[System.Object, System.Private.CoreLib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2019-07-16 10:51:45.999 +12:00 [INF] Executed action Pegasus_backend.Controllers.LessonController.GetLessonsForReceptionist (Pegasus_backend) in 3485.2192ms
2019-07-16 10:51:46.002 +12:00 [INF] Request finished in 3658.3039ms 200 application/json; charset=utf-8
2019-07-16 10:51:47.329 +12:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/api/lesson/GetLessonsForReceptionist/3/2019-07-16  
2019-07-16 10:51:47.330 +12:00 [INF] Route matched with {action = "GetLessonsForReceptionist", controller = "Lesson"}. Executing action Pegasus_backend.Controllers.LessonController.GetLessonsForReceptionist (Pegasus_backend)
2019-07-16 10:51:47.331 +12:00 [INF] Executing action method Pegasus_backend.Controllers.LessonController.GetLessonsForReceptionist (Pegasus_backend) with arguments (["3","07/16/2019 00:00:00"]) - Validation state: "Valid"
2019-07-16 10:51:47.332 +12:00 [INF] Entity Framework Core 2.1.8-servicing-32085 initialized 'ablemusicContext' using provider 'MySql.Data.EntityFrameworkCore' with options: None
2019-07-16 10:51:47.525 +12:00 [INF] Executed DbCommand (60ms) [Parameters=[@__8__locals1_userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT `s`.`staff_id`, `s`.`dob`, `s`.`email`, `s`.`expiry_date`, `s`.`first_name`, `s`.`gender`, `s`.`home_phone`, `s`.`id_number`, `s`.`id_photo`, `s`.`id_type`, `s`.`ird_number`, `s`.`is_activate`, `s`.`last_name`, `s`.`mobile_phone`, `s`.`photo`, `s`.`user_id`, `s`.`visa`
FROM `ablemusic`.`staff` AS `s`
WHERE `s`.`user_id` = @__8__locals1_userId_0
LIMIT 1
2019-07-16 10:51:47.694 +12:00 [INF] Executed DbCommand (54ms) [Parameters=[@__staff_StaffId_0='?' (DbType = Int16)], CommandType='"Text"', CommandTimeout='30']
SELECT `s`.`staff_org_id`, `s`.`is_activate`, `s`.`org_id`, `s`.`staff_id`
FROM `ablemusic`.`staff_org` AS `s`
WHERE `s`.`staff_id` = @__staff_StaffId_0
LIMIT 1
2019-07-16 10:51:47.710 +12:00 [WRN] The Include operation for navigation '[s].CourseInstance' is unnecessary and was ignored because the navigation is not reachable in the final query results. See https://go.microsoft.com/fwlink/?linkid=850303 for more information.
2019-07-16 10:51:47.711 +12:00 [WRN] The Include operation for navigation '[s].Learner' is unnecessary and was ignored because the navigation is not reachable in the final query results. See https://go.microsoft.com/fwlink/?linkid=850303 for more information.
2019-07-16 10:51:47.711 +12:00 [WRN] The Include operation for navigation '[s].Teacher' is unnecessary and was ignored because the navigation is not reachable in the final query results. See https://go.microsoft.com/fwlink/?linkid=850303 for more information.
2019-07-16 10:51:47.711 +12:00 [WRN] The Include operation for navigation '[s].Room' is unnecessary and was ignored because the navigation is not reachable in the final query results. See https://go.microsoft.com/fwlink/?linkid=850303 for more information.
2019-07-16 10:51:47.711 +12:00 [WRN] The Include operation for navigation '[s].Org' is unnecessary and was ignored because the navigation is not reachable in the final query results. See https://go.microsoft.com/fwlink/?linkid=850303 for more information.
2019-07-16 10:51:47.711 +12:00 [WRN] The Include operation for navigation '[s].TrialCourse' is unnecessary and was ignored because the navigation is not reachable in the final query results. See https://go.microsoft.com/fwlink/?linkid=850303 for more information.
2019-07-16 10:51:47.711 +12:00 [WRN] The Include operation for navigation '[s].GroupCourseInstance.LearnerGroupCourse.Learner' is unnecessary and was ignored because the navigation is not reachable in the final query results. See https://go.microsoft.com/fwlink/?linkid=850303 for more information.
2019-07-16 10:51:47.711 +12:00 [WRN] The Include operation for navigation '[s].AwaitMakeUpLessonNewLesson' is unnecessary and was ignored because the navigation is not reachable in the final query results. See https://go.microsoft.com/fwlink/?linkid=850303 for more information.
2019-07-16 10:51:47.730 +12:00 [WRN] The LINQ expression 'where ((((Convert(Convert([s].OrgId, Int32), Nullable`1) == Convert(__orgId_0, Nullable`1)) AndAlso (Convert([s].BeginTime, DateTime).Year == __8__locals1_date_Year_1)) AndAlso (Convert([s].BeginTime, DateTime).Month == __8__locals1_date_Month_2)) AndAlso (Convert([s].BeginTime, DateTime).Day == __8__locals1_date_Day_3))' could not be translated and will be evaluated locally.
2019-07-16 10:51:47.962 +12:00 [INF] Executed DbCommand (87ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT `s.CourseInstance`.`course_instance_id`, `s.CourseInstance`.`begin_date`, `s.CourseInstance`.`course_id`, `s.CourseInstance`.`end_date`, `s.CourseInstance`.`invoice_date`, `s.CourseInstance`.`learner_id`, `s.CourseInstance`.`org_id`, `s.CourseInstance`.`room_id`, `s.CourseInstance`.`teacher_id`, `s.GroupCourseInstance`.`group_course_instance_id`, `s.GroupCourseInstance`.`begin_date`, `s.GroupCourseInstance`.`course_id`, `s.GroupCourseInstance`.`end_date`, `s.GroupCourseInstance`.`invoice_date`, `s.GroupCourseInstance`.`is_activate`, `s.GroupCourseInstance`.`is_started`, `s.GroupCourseInstance`.`org_id`, `s.GroupCourseInstance`.`room_id`, `s.GroupCourseInstance`.`teacher_id`, `s`.`org_id` AS `OrgId`, `s`.`begin_time` AS `start`, `s`.`lesson_id` AS `id`, `s`.`room_id` AS `resourceId`, `s`.`end_time` AS `end`, `s.Teacher`.`first_name` AS `TeacherName`, `s`.`is_canceled` AS `IsCanceled`, `s`.`is_confirm` AS `IsConfirm`, `s`.`is_changed` AS `IsChanged`, `s`.`new_lesson_id`, `s`.`reason`, CASE
    WHEN `s`.`is_paid` = 1
    THEN 0 ELSE 1
END, CASE
    WHEN (
        SELECT `q1`.`quantity`
        FROM `ablemusic`.`lesson_remain` AS `q1`
        WHERE ((`q1`.`learner_id` = `s`.`learner_id`) OR (`q1`.`learner_id` IS NULL AND `s`.`learner_id` IS NULL)) AND ((`q1`.`course_instance_id` = `s`.`course_instance_id`) OR (`q1`.`course_instance_id` IS NULL AND `s`.`course_instance_id` IS NULL))
        LIMIT 1
    ) <= 3
    THEN 1 ELSE 0
END, `s.Learner`.`first_name` AS `FirstName`, `s`.`learner_id` AS `LearnerId`, `s.Room`.`room_name` AS `RoomName`, `s.Org`.`org_name` AS `OrgName`, `s`.`teacher_id` AS `TeacherId`, `s.GroupCourseInstance.Course`.`course_name`, `s.TrialCourse`.`course_name`, `s.CourseInstance.Course`.`course_name`, `s.GroupCourseInstance.Course`.`course_id`, `s`.`trial_course_id`, `s.CourseInstance.Course`.`course_id`, `s`.`learner_id` AS `LearnerId0`
FROM `ablemusic`.`lesson` AS `s`
LEFT JOIN `ablemusic`.`course` AS `s.TrialCourse` ON `s`.`trial_course_id` = `s.TrialCourse`.`course_id`
INNER JOIN `ablemusic`.`org` AS `s.Org` ON `s`.`org_id` = `s.Org`.`org_id`
LEFT JOIN `ablemusic`.`room` AS `s.Room` ON `s`.`room_id` = `s.Room`.`room_id`
LEFT JOIN `ablemusic`.`learner` AS `s.Learner` ON `s`.`learner_id` = `s.Learner`.`learner_id`
LEFT JOIN `ablemusic`.`teacher` AS `s.Teacher` ON `s`.`teacher_id` = `s.Teacher`.`teacher_id`
LEFT JOIN `ablemusic`.`one2one_course_instance` AS `s.CourseInstance` ON `s`.`course_instance_id` = `s.CourseInstance`.`course_instance_id`
LEFT JOIN `ablemusic`.`course` AS `s.CourseInstance.Course` ON `s.CourseInstance`.`course_id` = `s.CourseInstance.Course`.`course_id`
LEFT JOIN `ablemusic`.`group_course_instance` AS `s.GroupCourseInstance` ON `s`.`group_course_instance_id` = `s.GroupCourseInstance`.`group_course_instance_id`
LEFT JOIN `ablemusic`.`course` AS `s.GroupCourseInstance.Course` ON `s.GroupCourseInstance`.`course_id` = `s.GroupCourseInstance.Course`.`course_id`
2019-07-16 10:51:48.174 +12:00 [INF] Executed DbCommand (57ms) [Parameters=[@_outer_NewLessonId='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT `r`.`lesson_id`, `r`.`begin_time`, `r`.`course_instance_id`, `r`.`created_at`, `r`.`end_time`, `r`.`group_course_instance_id`, `r`.`invoice_id`, `r`.`is_canceled`, `r`.`is_changed`, `r`.`is_confirm`, `r`.`is_paid`, `r`.`is_trial`, `r`.`learner_id`, `r`.`new_lesson_id`, `r`.`org_id`, `r`.`reason`, `r`.`room_id`, `r`.`teacher_id`, `r`.`trial_course_id`
FROM `ablemusic`.`lesson` AS `r`
WHERE `r`.`lesson_id` = @_outer_NewLessonId
LIMIT 1
2019-07-16 10:51:48.375 +12:00 [INF] Executed DbCommand (58ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT `r`.`lesson_id`, `r`.`begin_time`, `r`.`course_instance_id`, `r`.`created_at`, `r`.`end_time`, `r`.`group_course_instance_id`, `r`.`invoice_id`, `r`.`is_canceled`, `r`.`is_changed`, `r`.`is_confirm`, `r`.`is_paid`, `r`.`is_trial`, `r`.`learner_id`, `r`.`new_lesson_id`, `r`.`org_id`, `r`.`reason`, `r`.`room_id`, `r`.`teacher_id`, `r`.`trial_course_id`
FROM `ablemusic`.`lesson` AS `r`
WHERE `r`.`lesson_id` IS NULL
LIMIT 1
2019-07-16 10:51:48.561 +12:00 [INF] Executed DbCommand (55ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT `r`.`lesson_id`, `r`.`begin_time`, `r`.`course_instance_id`, `r`.`created_at`, `r`.`end_time`, `r`.`group_course_instance_id`, `r`.`invoice_id`, `r`.`is_canceled`, `r`.`is_changed`, `r`.`is_confirm`, `r`.`is_paid`, `r`.`is_trial`, `r`.`learner_id`, `r`.`new_lesson_id`, `r`.`org_id`, `r`.`reason`, `r`.`room_id`, `r`.`teacher_id`, `r`.`trial_course_id`
FROM `ablemusic`.`lesson` AS `r`
WHERE `r`.`lesson_id` IS NULL
LIMIT 1
2019-07-16 10:51:48.562 +12:00 [INF] Executed action method Pegasus_backend.Controllers.LessonController.GetLessonsForReceptionist (Pegasus_backend), returned result Microsoft.AspNetCore.Mvc.OkObjectResult in 1231.3595ms.
2019-07-16 10:51:48.563 +12:00 [INF] Executing ObjectResult, writing value of type 'Pegasus_backend.Models.Result`1[[System.Object, System.Private.CoreLib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2019-07-16 10:51:48.564 +12:00 [INF] Executed action Pegasus_backend.Controllers.LessonController.GetLessonsForReceptionist (Pegasus_backend) in 1234.0839ms
2019-07-16 10:51:48.565 +12:00 [INF] Request finished in 1235.812ms 200 application/json; charset=utf-8
2019-07-16 10:51:49.346 +12:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/api/lesson/GetLessonsForReceptionist/3/2019-07-16  
2019-07-16 10:51:49.347 +12:00 [INF] Route matched with {action = "GetLessonsForReceptionist", controller = "Lesson"}. Executing action Pegasus_backend.Controllers.LessonController.GetLessonsForReceptionist (Pegasus_backend)
2019-07-16 10:51:49.347 +12:00 [INF] Executing action method Pegasus_backend.Controllers.LessonController.GetLessonsForReceptionist (Pegasus_backend) with arguments (["3","07/16/2019 00:00:00"]) - Validation state: "Valid"
2019-07-16 10:51:49.348 +12:00 [INF] Entity Framework Core 2.1.8-servicing-32085 initialized 'ablemusicContext' using provider 'MySql.Data.EntityFrameworkCore' with options: None
2019-07-16 10:51:49.545 +12:00 [INF] Executed DbCommand (56ms) [Parameters=[@__8__locals1_userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT `s`.`staff_id`, `s`.`dob`, `s`.`email`, `s`.`expiry_date`, `s`.`first_name`, `s`.`gender`, `s`.`home_phone`, `s`.`id_number`, `s`.`id_photo`, `s`.`id_type`, `s`.`ird_number`, `s`.`is_activate`, `s`.`last_name`, `s`.`mobile_phone`, `s`.`photo`, `s`.`user_id`, `s`.`visa`
FROM `ablemusic`.`staff` AS `s`
WHERE `s`.`user_id` = @__8__locals1_userId_0
LIMIT 1
2019-07-16 10:51:49.713 +12:00 [INF] Executed DbCommand (52ms) [Parameters=[@__staff_StaffId_0='?' (DbType = Int16)], CommandType='"Text"', CommandTimeout='30']
SELECT `s`.`staff_org_id`, `s`.`is_activate`, `s`.`org_id`, `s`.`staff_id`
FROM `ablemusic`.`staff_org` AS `s`
WHERE `s`.`staff_id` = @__staff_StaffId_0
LIMIT 1
2019-07-16 10:51:49.729 +12:00 [WRN] The Include operation for navigation '[s].CourseInstance' is unnecessary and was ignored because the navigation is not reachable in the final query results. See https://go.microsoft.com/fwlink/?linkid=850303 for more information.
2019-07-16 10:51:49.729 +12:00 [WRN] The Include operation for navigation '[s].Learner' is unnecessary and was ignored because the navigation is not reachable in the final query results. See https://go.microsoft.com/fwlink/?linkid=850303 for more information.
2019-07-16 10:51:49.729 +12:00 [WRN] The Include operation for navigation '[s].Teacher' is unnecessary and was ignored because the navigation is not reachable in the final query results. See https://go.microsoft.com/fwlink/?linkid=850303 for more information.
2019-07-16 10:51:49.730 +12:00 [WRN] The Include operation for navigation '[s].Room' is unnecessary and was ignored because the navigation is not reachable in the final query results. See https://go.microsoft.com/fwlink/?linkid=850303 for more information.
2019-07-16 10:51:49.730 +12:00 [WRN] The Include operation for navigation '[s].Org' is unnecessary and was ignored because the navigation is not reachable in the final query results. See https://go.microsoft.com/fwlink/?linkid=850303 for more information.
2019-07-16 10:51:49.730 +12:00 [WRN] The Include operation for navigation '[s].TrialCourse' is unnecessary and was ignored because the navigation is not reachable in the final query results. See https://go.microsoft.com/fwlink/?linkid=850303 for more information.
2019-07-16 10:51:49.730 +12:00 [WRN] The Include operation for navigation '[s].GroupCourseInstance.LearnerGroupCourse.Learner' is unnecessary and was ignored because the navigation is not reachable in the final query results. See https://go.microsoft.com/fwlink/?linkid=850303 for more information.
2019-07-16 10:51:49.730 +12:00 [WRN] The Include operation for navigation '[s].AwaitMakeUpLessonNewLesson' is unnecessary and was ignored because the navigation is not reachable in the final query results. See https://go.microsoft.com/fwlink/?linkid=850303 for more information.
2019-07-16 10:51:49.748 +12:00 [WRN] The LINQ expression 'where ((((Convert(Convert([s].OrgId, Int32), Nullable`1) == Convert(__orgId_0, Nullable`1)) AndAlso (Convert([s].BeginTime, DateTime).Year == __8__locals1_date_Year_1)) AndAlso (Convert([s].BeginTime, DateTime).Month == __8__locals1_date_Month_2)) AndAlso (Convert([s].BeginTime, DateTime).Day == __8__locals1_date_Day_3))' could not be translated and will be evaluated locally.
2019-07-16 10:51:49.979 +12:00 [INF] Executed DbCommand (86ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT `s.CourseInstance`.`course_instance_id`, `s.CourseInstance`.`begin_date`, `s.CourseInstance`.`course_id`, `s.CourseInstance`.`end_date`, `s.CourseInstance`.`invoice_date`, `s.CourseInstance`.`learner_id`, `s.CourseInstance`.`org_id`, `s.CourseInstance`.`room_id`, `s.CourseInstance`.`teacher_id`, `s.GroupCourseInstance`.`group_course_instance_id`, `s.GroupCourseInstance`.`begin_date`, `s.GroupCourseInstance`.`course_id`, `s.GroupCourseInstance`.`end_date`, `s.GroupCourseInstance`.`invoice_date`, `s.GroupCourseInstance`.`is_activate`, `s.GroupCourseInstance`.`is_started`, `s.GroupCourseInstance`.`org_id`, `s.GroupCourseInstance`.`room_id`, `s.GroupCourseInstance`.`teacher_id`, `s`.`org_id` AS `OrgId`, `s`.`begin_time` AS `start`, `s`.`lesson_id` AS `id`, `s`.`room_id` AS `resourceId`, `s`.`end_time` AS `end`, `s.Teacher`.`first_name` AS `TeacherName`, `s`.`is_canceled` AS `IsCanceled`, `s`.`is_confirm` AS `IsConfirm`, `s`.`is_changed` AS `IsChanged`, `s`.`new_lesson_id`, `s`.`reason`, CASE
    WHEN `s`.`is_paid` = 1
    THEN 0 ELSE 1
END, CASE
    WHEN (
        SELECT `q1`.`quantity`
        FROM `ablemusic`.`lesson_remain` AS `q1`
        WHERE ((`q1`.`learner_id` = `s`.`learner_id`) OR (`q1`.`learner_id` IS NULL AND `s`.`learner_id` IS NULL)) AND ((`q1`.`course_instance_id` = `s`.`course_instance_id`) OR (`q1`.`course_instance_id` IS NULL AND `s`.`course_instance_id` IS NULL))
        LIMIT 1
    ) <= 3
    THEN 1 ELSE 0
END, `s.Learner`.`first_name` AS `FirstName`, `s`.`learner_id` AS `LearnerId`, `s.Room`.`room_name` AS `RoomName`, `s.Org`.`org_name` AS `OrgName`, `s`.`teacher_id` AS `TeacherId`, `s.GroupCourseInstance.Course`.`course_name`, `s.TrialCourse`.`course_name`, `s.CourseInstance.Course`.`course_name`, `s.GroupCourseInstance.Course`.`course_id`, `s`.`trial_course_id`, `s.CourseInstance.Course`.`course_id`, `s`.`learner_id` AS `LearnerId0`
FROM `ablemusic`.`lesson` AS `s`
LEFT JOIN `ablemusic`.`course` AS `s.TrialCourse` ON `s`.`trial_course_id` = `s.TrialCourse`.`course_id`
INNER JOIN `ablemusic`.`org` AS `s.Org` ON `s`.`org_id` = `s.Org`.`org_id`
LEFT JOIN `ablemusic`.`room` AS `s.Room` ON `s`.`room_id` = `s.Room`.`room_id`
LEFT JOIN `ablemusic`.`learner` AS `s.Learner` ON `s`.`learner_id` = `s.Learner`.`learner_id`
LEFT JOIN `ablemusic`.`teacher` AS `s.Teacher` ON `s`.`teacher_id` = `s.Teacher`.`teacher_id`
LEFT JOIN `ablemusic`.`one2one_course_instance` AS `s.CourseInstance` ON `s`.`course_instance_id` = `s.CourseInstance`.`course_instance_id`
LEFT JOIN `ablemusic`.`course` AS `s.CourseInstance.Course` ON `s.CourseInstance`.`course_id` = `s.CourseInstance.Course`.`course_id`
LEFT JOIN `ablemusic`.`group_course_instance` AS `s.GroupCourseInstance` ON `s`.`group_course_instance_id` = `s.GroupCourseInstance`.`group_course_instance_id`
LEFT JOIN `ablemusic`.`course` AS `s.GroupCourseInstance.Course` ON `s.GroupCourseInstance`.`course_id` = `s.GroupCourseInstance.Course`.`course_id`
2019-07-16 10:51:50.188 +12:00 [INF] Executed DbCommand (57ms) [Parameters=[@_outer_NewLessonId='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT `r`.`lesson_id`, `r`.`begin_time`, `r`.`course_instance_id`, `r`.`created_at`, `r`.`end_time`, `r`.`group_course_instance_id`, `r`.`invoice_id`, `r`.`is_canceled`, `r`.`is_changed`, `r`.`is_confirm`, `r`.`is_paid`, `r`.`is_trial`, `r`.`learner_id`, `r`.`new_lesson_id`, `r`.`org_id`, `r`.`reason`, `r`.`room_id`, `r`.`teacher_id`, `r`.`trial_course_id`
FROM `ablemusic`.`lesson` AS `r`
WHERE `r`.`lesson_id` = @_outer_NewLessonId
LIMIT 1
2019-07-16 10:51:50.372 +12:00 [INF] Executed DbCommand (55ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT `r`.`lesson_id`, `r`.`begin_time`, `r`.`course_instance_id`, `r`.`created_at`, `r`.`end_time`, `r`.`group_course_instance_id`, `r`.`invoice_id`, `r`.`is_canceled`, `r`.`is_changed`, `r`.`is_confirm`, `r`.`is_paid`, `r`.`is_trial`, `r`.`learner_id`, `r`.`new_lesson_id`, `r`.`org_id`, `r`.`reason`, `r`.`room_id`, `r`.`teacher_id`, `r`.`trial_course_id`
FROM `ablemusic`.`lesson` AS `r`
WHERE `r`.`lesson_id` IS NULL
LIMIT 1
2019-07-16 10:51:50.556 +12:00 [INF] Executed DbCommand (56ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT `r`.`lesson_id`, `r`.`begin_time`, `r`.`course_instance_id`, `r`.`created_at`, `r`.`end_time`, `r`.`group_course_instance_id`, `r`.`invoice_id`, `r`.`is_canceled`, `r`.`is_changed`, `r`.`is_confirm`, `r`.`is_paid`, `r`.`is_trial`, `r`.`learner_id`, `r`.`new_lesson_id`, `r`.`org_id`, `r`.`reason`, `r`.`room_id`, `r`.`teacher_id`, `r`.`trial_course_id`
FROM `ablemusic`.`lesson` AS `r`
WHERE `r`.`lesson_id` IS NULL
LIMIT 1
2019-07-16 10:51:50.557 +12:00 [INF] Executed action method Pegasus_backend.Controllers.LessonController.GetLessonsForReceptionist (Pegasus_backend), returned result Microsoft.AspNetCore.Mvc.OkObjectResult in 1209.2925ms.
2019-07-16 10:51:50.557 +12:00 [INF] Executing ObjectResult, writing value of type 'Pegasus_backend.Models.Result`1[[System.Object, System.Private.CoreLib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2019-07-16 10:51:50.558 +12:00 [INF] Executed action Pegasus_backend.Controllers.LessonController.GetLessonsForReceptionist (Pegasus_backend) in 1210.7569ms
2019-07-16 10:51:50.558 +12:00 [INF] Request finished in 1211.537ms 200 application/json; charset=utf-8
2019-07-16 10:51:52.132 +12:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/api/lesson/GetLessonsForReceptionist/3/2019-07-16  
2019-07-16 10:51:52.132 +12:00 [INF] Route matched with {action = "GetLessonsForReceptionist", controller = "Lesson"}. Executing action Pegasus_backend.Controllers.LessonController.GetLessonsForReceptionist (Pegasus_backend)
2019-07-16 10:51:52.132 +12:00 [INF] Executing action method Pegasus_backend.Controllers.LessonController.GetLessonsForReceptionist (Pegasus_backend) with arguments (["3","07/16/2019 00:00:00"]) - Validation state: "Valid"
2019-07-16 10:51:52.133 +12:00 [INF] Entity Framework Core 2.1.8-servicing-32085 initialized 'ablemusicContext' using provider 'MySql.Data.EntityFrameworkCore' with options: None
2019-07-16 10:51:52.318 +12:00 [INF] Executed DbCommand (53ms) [Parameters=[@__8__locals1_userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT `s`.`staff_id`, `s`.`dob`, `s`.`email`, `s`.`expiry_date`, `s`.`first_name`, `s`.`gender`, `s`.`home_phone`, `s`.`id_number`, `s`.`id_photo`, `s`.`id_type`, `s`.`ird_number`, `s`.`is_activate`, `s`.`last_name`, `s`.`mobile_phone`, `s`.`photo`, `s`.`user_id`, `s`.`visa`
FROM `ablemusic`.`staff` AS `s`
WHERE `s`.`user_id` = @__8__locals1_userId_0
LIMIT 1
2019-07-16 10:51:52.497 +12:00 [INF] Executed DbCommand (52ms) [Parameters=[@__staff_StaffId_0='?' (DbType = Int16)], CommandType='"Text"', CommandTimeout='30']
SELECT `s`.`staff_org_id`, `s`.`is_activate`, `s`.`org_id`, `s`.`staff_id`
FROM `ablemusic`.`staff_org` AS `s`
WHERE `s`.`staff_id` = @__staff_StaffId_0
LIMIT 1
2019-07-16 10:51:52.512 +12:00 [WRN] The Include operation for navigation '[s].CourseInstance' is unnecessary and was ignored because the navigation is not reachable in the final query results. See https://go.microsoft.com/fwlink/?linkid=850303 for more information.
2019-07-16 10:51:52.512 +12:00 [WRN] The Include operation for navigation '[s].Learner' is unnecessary and was ignored because the navigation is not reachable in the final query results. See https://go.microsoft.com/fwlink/?linkid=850303 for more information.
2019-07-16 10:51:52.512 +12:00 [WRN] The Include operation for navigation '[s].Teacher' is unnecessary and was ignored because the navigation is not reachable in the final query results. See https://go.microsoft.com/fwlink/?linkid=850303 for more information.
2019-07-16 10:51:52.512 +12:00 [WRN] The Include operation for navigation '[s].Room' is unnecessary and was ignored because the navigation is not reachable in the final query results. See https://go.microsoft.com/fwlink/?linkid=850303 for more information.
2019-07-16 10:51:52.512 +12:00 [WRN] The Include operation for navigation '[s].Org' is unnecessary and was ignored because the navigation is not reachable in the final query results. See https://go.microsoft.com/fwlink/?linkid=850303 for more information.
2019-07-16 10:51:52.512 +12:00 [WRN] The Include operation for navigation '[s].TrialCourse' is unnecessary and was ignored because the navigation is not reachable in the final query results. See https://go.microsoft.com/fwlink/?linkid=850303 for more information.
2019-07-16 10:51:52.512 +12:00 [WRN] The Include operation for navigation '[s].GroupCourseInstance.LearnerGroupCourse.Learner' is unnecessary and was ignored because the navigation is not reachable in the final query results. See https://go.microsoft.com/fwlink/?linkid=850303 for more information.
2019-07-16 10:51:52.512 +12:00 [WRN] The Include operation for navigation '[s].AwaitMakeUpLessonNewLesson' is unnecessary and was ignored because the navigation is not reachable in the final query results. See https://go.microsoft.com/fwlink/?linkid=850303 for more information.
2019-07-16 10:51:52.531 +12:00 [WRN] The LINQ expression 'where ((((Convert(Convert([s].OrgId, Int32), Nullable`1) == Convert(__orgId_0, Nullable`1)) AndAlso (Convert([s].BeginTime, DateTime).Year == __8__locals1_date_Year_1)) AndAlso (Convert([s].BeginTime, DateTime).Month == __8__locals1_date_Month_2)) AndAlso (Convert([s].BeginTime, DateTime).Day == __8__locals1_date_Day_3))' could not be translated and will be evaluated locally.
2019-07-16 10:51:52.761 +12:00 [INF] Executed DbCommand (87ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT `s.CourseInstance`.`course_instance_id`, `s.CourseInstance`.`begin_date`, `s.CourseInstance`.`course_id`, `s.CourseInstance`.`end_date`, `s.CourseInstance`.`invoice_date`, `s.CourseInstance`.`learner_id`, `s.CourseInstance`.`org_id`, `s.CourseInstance`.`room_id`, `s.CourseInstance`.`teacher_id`, `s.GroupCourseInstance`.`group_course_instance_id`, `s.GroupCourseInstance`.`begin_date`, `s.GroupCourseInstance`.`course_id`, `s.GroupCourseInstance`.`end_date`, `s.GroupCourseInstance`.`invoice_date`, `s.GroupCourseInstance`.`is_activate`, `s.GroupCourseInstance`.`is_started`, `s.GroupCourseInstance`.`org_id`, `s.GroupCourseInstance`.`room_id`, `s.GroupCourseInstance`.`teacher_id`, `s`.`org_id` AS `OrgId`, `s`.`begin_time` AS `start`, `s`.`lesson_id` AS `id`, `s`.`room_id` AS `resourceId`, `s`.`end_time` AS `end`, `s.Teacher`.`first_name` AS `TeacherName`, `s`.`is_canceled` AS `IsCanceled`, `s`.`is_confirm` AS `IsConfirm`, `s`.`is_changed` AS `IsChanged`, `s`.`new_lesson_id`, `s`.`reason`, CASE
    WHEN `s`.`is_paid` = 1
    THEN 0 ELSE 1
END, CASE
    WHEN (
        SELECT `q1`.`quantity`
        FROM `ablemusic`.`lesson_remain` AS `q1`
        WHERE ((`q1`.`learner_id` = `s`.`learner_id`) OR (`q1`.`learner_id` IS NULL AND `s`.`learner_id` IS NULL)) AND ((`q1`.`course_instance_id` = `s`.`course_instance_id`) OR (`q1`.`course_instance_id` IS NULL AND `s`.`course_instance_id` IS NULL))
        LIMIT 1
    ) <= 3
    THEN 1 ELSE 0
END, `s.Learner`.`first_name` AS `FirstName`, `s`.`learner_id` AS `LearnerId`, `s.Room`.`room_name` AS `RoomName`, `s.Org`.`org_name` AS `OrgName`, `s`.`teacher_id` AS `TeacherId`, `s.GroupCourseInstance.Course`.`course_name`, `s.TrialCourse`.`course_name`, `s.CourseInstance.Course`.`course_name`, `s.GroupCourseInstance.Course`.`course_id`, `s`.`trial_course_id`, `s.CourseInstance.Course`.`course_id`, `s`.`learner_id` AS `LearnerId0`
FROM `ablemusic`.`lesson` AS `s`
LEFT JOIN `ablemusic`.`course` AS `s.TrialCourse` ON `s`.`trial_course_id` = `s.TrialCourse`.`course_id`
INNER JOIN `ablemusic`.`org` AS `s.Org` ON `s`.`org_id` = `s.Org`.`org_id`
LEFT JOIN `ablemusic`.`room` AS `s.Room` ON `s`.`room_id` = `s.Room`.`room_id`
LEFT JOIN `ablemusic`.`learner` AS `s.Learner` ON `s`.`learner_id` = `s.Learner`.`learner_id`
LEFT JOIN `ablemusic`.`teacher` AS `s.Teacher` ON `s`.`teacher_id` = `s.Teacher`.`teacher_id`
LEFT JOIN `ablemusic`.`one2one_course_instance` AS `s.CourseInstance` ON `s`.`course_instance_id` = `s.CourseInstance`.`course_instance_id`
LEFT JOIN `ablemusic`.`course` AS `s.CourseInstance.Course` ON `s.CourseInstance`.`course_id` = `s.CourseInstance.Course`.`course_id`
LEFT JOIN `ablemusic`.`group_course_instance` AS `s.GroupCourseInstance` ON `s`.`group_course_instance_id` = `s.GroupCourseInstance`.`group_course_instance_id`
LEFT JOIN `ablemusic`.`course` AS `s.GroupCourseInstance.Course` ON `s.GroupCourseInstance`.`course_id` = `s.GroupCourseInstance.Course`.`course_id`
2019-07-16 10:51:53.093 +12:00 [INF] Executed DbCommand (58ms) [Parameters=[@_outer_NewLessonId='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT `r`.`lesson_id`, `r`.`begin_time`, `r`.`course_instance_id`, `r`.`created_at`, `r`.`end_time`, `r`.`group_course_instance_id`, `r`.`invoice_id`, `r`.`is_canceled`, `r`.`is_changed`, `r`.`is_confirm`, `r`.`is_paid`, `r`.`is_trial`, `r`.`learner_id`, `r`.`new_lesson_id`, `r`.`org_id`, `r`.`reason`, `r`.`room_id`, `r`.`teacher_id`, `r`.`trial_course_id`
FROM `ablemusic`.`lesson` AS `r`
WHERE `r`.`lesson_id` = @_outer_NewLessonId
LIMIT 1
2019-07-16 10:51:53.280 +12:00 [INF] Executed DbCommand (55ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT `r`.`lesson_id`, `r`.`begin_time`, `r`.`course_instance_id`, `r`.`created_at`, `r`.`end_time`, `r`.`group_course_instance_id`, `r`.`invoice_id`, `r`.`is_canceled`, `r`.`is_changed`, `r`.`is_confirm`, `r`.`is_paid`, `r`.`is_trial`, `r`.`learner_id`, `r`.`new_lesson_id`, `r`.`org_id`, `r`.`reason`, `r`.`room_id`, `r`.`teacher_id`, `r`.`trial_course_id`
FROM `ablemusic`.`lesson` AS `r`
WHERE `r`.`lesson_id` IS NULL
LIMIT 1
2019-07-16 10:51:53.461 +12:00 [INF] Executed DbCommand (60ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT `r`.`lesson_id`, `r`.`begin_time`, `r`.`course_instance_id`, `r`.`created_at`, `r`.`end_time`, `r`.`group_course_instance_id`, `r`.`invoice_id`, `r`.`is_canceled`, `r`.`is_changed`, `r`.`is_confirm`, `r`.`is_paid`, `r`.`is_trial`, `r`.`learner_id`, `r`.`new_lesson_id`, `r`.`org_id`, `r`.`reason`, `r`.`room_id`, `r`.`teacher_id`, `r`.`trial_course_id`
FROM `ablemusic`.`lesson` AS `r`
WHERE `r`.`lesson_id` IS NULL
LIMIT 1
2019-07-16 10:51:53.462 +12:00 [INF] Executed action method Pegasus_backend.Controllers.LessonController.GetLessonsForReceptionist (Pegasus_backend), returned result Microsoft.AspNetCore.Mvc.OkObjectResult in 1329.255ms.
2019-07-16 10:51:53.462 +12:00 [INF] Executing ObjectResult, writing value of type 'Pegasus_backend.Models.Result`1[[System.Object, System.Private.CoreLib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2019-07-16 10:51:53.463 +12:00 [INF] Executed action Pegasus_backend.Controllers.LessonController.GetLessonsForReceptionist (Pegasus_backend) in 1330.4326ms
2019-07-16 10:51:53.463 +12:00 [INF] Request finished in 1331.1561ms 200 application/json; charset=utf-8
2019-07-16 10:51:54.142 +12:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/api/lesson/GetLessonsForReceptionist/3/2019-07-16  
2019-07-16 10:51:54.142 +12:00 [INF] Route matched with {action = "GetLessonsForReceptionist", controller = "Lesson"}. Executing action Pegasus_backend.Controllers.LessonController.GetLessonsForReceptionist (Pegasus_backend)
2019-07-16 10:51:54.143 +12:00 [INF] Executing action method Pegasus_backend.Controllers.LessonController.GetLessonsForReceptionist (Pegasus_backend) with arguments (["3","07/16/2019 00:00:00"]) - Validation state: "Valid"
2019-07-16 10:51:54.143 +12:00 [INF] Entity Framework Core 2.1.8-servicing-32085 initialized 'ablemusicContext' using provider 'MySql.Data.EntityFrameworkCore' with options: None
2019-07-16 10:51:54.463 +12:00 [INF] Executed DbCommand (61ms) [Parameters=[@__8__locals1_userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT `s`.`staff_id`, `s`.`dob`, `s`.`email`, `s`.`expiry_date`, `s`.`first_name`, `s`.`gender`, `s`.`home_phone`, `s`.`id_number`, `s`.`id_photo`, `s`.`id_type`, `s`.`ird_number`, `s`.`is_activate`, `s`.`last_name`, `s`.`mobile_phone`, `s`.`photo`, `s`.`user_id`, `s`.`visa`
FROM `ablemusic`.`staff` AS `s`
WHERE `s`.`user_id` = @__8__locals1_userId_0
LIMIT 1
2019-07-16 10:51:55.236 +12:00 [INF] Executed DbCommand (516ms) [Parameters=[@__staff_StaffId_0='?' (DbType = Int16)], CommandType='"Text"', CommandTimeout='30']
SELECT `s`.`staff_org_id`, `s`.`is_activate`, `s`.`org_id`, `s`.`staff_id`
FROM `ablemusic`.`staff_org` AS `s`
WHERE `s`.`staff_id` = @__staff_StaffId_0
LIMIT 1
2019-07-16 10:51:55.253 +12:00 [WRN] The Include operation for navigation '[s].CourseInstance' is unnecessary and was ignored because the navigation is not reachable in the final query results. See https://go.microsoft.com/fwlink/?linkid=850303 for more information.
2019-07-16 10:51:55.253 +12:00 [WRN] The Include operation for navigation '[s].Learner' is unnecessary and was ignored because the navigation is not reachable in the final query results. See https://go.microsoft.com/fwlink/?linkid=850303 for more information.
2019-07-16 10:51:55.253 +12:00 [WRN] The Include operation for navigation '[s].Teacher' is unnecessary and was ignored because the navigation is not reachable in the final query results. See https://go.microsoft.com/fwlink/?linkid=850303 for more information.
2019-07-16 10:51:55.253 +12:00 [WRN] The Include operation for navigation '[s].Room' is unnecessary and was ignored because the navigation is not reachable in the final query results. See https://go.microsoft.com/fwlink/?linkid=850303 for more information.
2019-07-16 10:51:55.253 +12:00 [WRN] The Include operation for navigation '[s].Org' is unnecessary and was ignored because the navigation is not reachable in the final query results. See https://go.microsoft.com/fwlink/?linkid=850303 for more information.
2019-07-16 10:51:55.254 +12:00 [WRN] The Include operation for navigation '[s].TrialCourse' is unnecessary and was ignored because the navigation is not reachable in the final query results. See https://go.microsoft.com/fwlink/?linkid=850303 for more information.
2019-07-16 10:51:55.254 +12:00 [WRN] The Include operation for navigation '[s].GroupCourseInstance.LearnerGroupCourse.Learner' is unnecessary and was ignored because the navigation is not reachable in the final query results. See https://go.microsoft.com/fwlink/?linkid=850303 for more information.
2019-07-16 10:51:55.254 +12:00 [WRN] The Include operation for navigation '[s].AwaitMakeUpLessonNewLesson' is unnecessary and was ignored because the navigation is not reachable in the final query results. See https://go.microsoft.com/fwlink/?linkid=850303 for more information.
2019-07-16 10:51:55.273 +12:00 [WRN] The LINQ expression 'where ((((Convert(Convert([s].OrgId, Int32), Nullable`1) == Convert(__orgId_0, Nullable`1)) AndAlso (Convert([s].BeginTime, DateTime).Year == __8__locals1_date_Year_1)) AndAlso (Convert([s].BeginTime, DateTime).Month == __8__locals1_date_Month_2)) AndAlso (Convert([s].BeginTime, DateTime).Day == __8__locals1_date_Day_3))' could not be translated and will be evaluated locally.
2019-07-16 10:51:56.628 +12:00 [INF] Executed DbCommand (693ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT `s.CourseInstance`.`course_instance_id`, `s.CourseInstance`.`begin_date`, `s.CourseInstance`.`course_id`, `s.CourseInstance`.`end_date`, `s.CourseInstance`.`invoice_date`, `s.CourseInstance`.`learner_id`, `s.CourseInstance`.`org_id`, `s.CourseInstance`.`room_id`, `s.CourseInstance`.`teacher_id`, `s.GroupCourseInstance`.`group_course_instance_id`, `s.GroupCourseInstance`.`begin_date`, `s.GroupCourseInstance`.`course_id`, `s.GroupCourseInstance`.`end_date`, `s.GroupCourseInstance`.`invoice_date`, `s.GroupCourseInstance`.`is_activate`, `s.GroupCourseInstance`.`is_started`, `s.GroupCourseInstance`.`org_id`, `s.GroupCourseInstance`.`room_id`, `s.GroupCourseInstance`.`teacher_id`, `s`.`org_id` AS `OrgId`, `s`.`begin_time` AS `start`, `s`.`lesson_id` AS `id`, `s`.`room_id` AS `resourceId`, `s`.`end_time` AS `end`, `s.Teacher`.`first_name` AS `TeacherName`, `s`.`is_canceled` AS `IsCanceled`, `s`.`is_confirm` AS `IsConfirm`, `s`.`is_changed` AS `IsChanged`, `s`.`new_lesson_id`, `s`.`reason`, CASE
    WHEN `s`.`is_paid` = 1
    THEN 0 ELSE 1
END, CASE
    WHEN (
        SELECT `q1`.`quantity`
        FROM `ablemusic`.`lesson_remain` AS `q1`
        WHERE ((`q1`.`learner_id` = `s`.`learner_id`) OR (`q1`.`learner_id` IS NULL AND `s`.`learner_id` IS NULL)) AND ((`q1`.`course_instance_id` = `s`.`course_instance_id`) OR (`q1`.`course_instance_id` IS NULL AND `s`.`course_instance_id` IS NULL))
        LIMIT 1
    ) <= 3
    THEN 1 ELSE 0
END, `s.Learner`.`first_name` AS `FirstName`, `s`.`learner_id` AS `LearnerId`, `s.Room`.`room_name` AS `RoomName`, `s.Org`.`org_name` AS `OrgName`, `s`.`teacher_id` AS `TeacherId`, `s.GroupCourseInstance.Course`.`course_name`, `s.TrialCourse`.`course_name`, `s.CourseInstance.Course`.`course_name`, `s.GroupCourseInstance.Course`.`course_id`, `s`.`trial_course_id`, `s.CourseInstance.Course`.`course_id`, `s`.`learner_id` AS `LearnerId0`
FROM `ablemusic`.`lesson` AS `s`
LEFT JOIN `ablemusic`.`course` AS `s.TrialCourse` ON `s`.`trial_course_id` = `s.TrialCourse`.`course_id`
INNER JOIN `ablemusic`.`org` AS `s.Org` ON `s`.`org_id` = `s.Org`.`org_id`
LEFT JOIN `ablemusic`.`room` AS `s.Room` ON `s`.`room_id` = `s.Room`.`room_id`
LEFT JOIN `ablemusic`.`learner` AS `s.Learner` ON `s`.`learner_id` = `s.Learner`.`learner_id`
LEFT JOIN `ablemusic`.`teacher` AS `s.Teacher` ON `s`.`teacher_id` = `s.Teacher`.`teacher_id`
LEFT JOIN `ablemusic`.`one2one_course_instance` AS `s.CourseInstance` ON `s`.`course_instance_id` = `s.CourseInstance`.`course_instance_id`
LEFT JOIN `ablemusic`.`course` AS `s.CourseInstance.Course` ON `s.CourseInstance`.`course_id` = `s.CourseInstance.Course`.`course_id`
LEFT JOIN `ablemusic`.`group_course_instance` AS `s.GroupCourseInstance` ON `s`.`group_course_instance_id` = `s.GroupCourseInstance`.`group_course_instance_id`
LEFT JOIN `ablemusic`.`course` AS `s.GroupCourseInstance.Course` ON `s.GroupCourseInstance`.`course_id` = `s.GroupCourseInstance.Course`.`course_id`
2019-07-16 10:51:56.959 +12:00 [INF] Executed DbCommand (56ms) [Parameters=[@_outer_NewLessonId='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT `r`.`lesson_id`, `r`.`begin_time`, `r`.`course_instance_id`, `r`.`created_at`, `r`.`end_time`, `r`.`group_course_instance_id`, `r`.`invoice_id`, `r`.`is_canceled`, `r`.`is_changed`, `r`.`is_confirm`, `r`.`is_paid`, `r`.`is_trial`, `r`.`learner_id`, `r`.`new_lesson_id`, `r`.`org_id`, `r`.`reason`, `r`.`room_id`, `r`.`teacher_id`, `r`.`trial_course_id`
FROM `ablemusic`.`lesson` AS `r`
WHERE `r`.`lesson_id` = @_outer_NewLessonId
LIMIT 1
2019-07-16 10:51:57.145 +12:00 [INF] Executed DbCommand (56ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT `r`.`lesson_id`, `r`.`begin_time`, `r`.`course_instance_id`, `r`.`created_at`, `r`.`end_time`, `r`.`group_course_instance_id`, `r`.`invoice_id`, `r`.`is_canceled`, `r`.`is_changed`, `r`.`is_confirm`, `r`.`is_paid`, `r`.`is_trial`, `r`.`learner_id`, `r`.`new_lesson_id`, `r`.`org_id`, `r`.`reason`, `r`.`room_id`, `r`.`teacher_id`, `r`.`trial_course_id`
FROM `ablemusic`.`lesson` AS `r`
WHERE `r`.`lesson_id` IS NULL
LIMIT 1
2019-07-16 10:51:57.330 +12:00 [INF] Executed DbCommand (57ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT `r`.`lesson_id`, `r`.`begin_time`, `r`.`course_instance_id`, `r`.`created_at`, `r`.`end_time`, `r`.`group_course_instance_id`, `r`.`invoice_id`, `r`.`is_canceled`, `r`.`is_changed`, `r`.`is_confirm`, `r`.`is_paid`, `r`.`is_trial`, `r`.`learner_id`, `r`.`new_lesson_id`, `r`.`org_id`, `r`.`reason`, `r`.`room_id`, `r`.`teacher_id`, `r`.`trial_course_id`
FROM `ablemusic`.`lesson` AS `r`
WHERE `r`.`lesson_id` IS NULL
LIMIT 1
2019-07-16 10:51:57.331 +12:00 [INF] Executed action method Pegasus_backend.Controllers.LessonController.GetLessonsForReceptionist (Pegasus_backend), returned result Microsoft.AspNetCore.Mvc.OkObjectResult in 3187.8037ms.
2019-07-16 10:51:57.331 +12:00 [INF] Executing ObjectResult, writing value of type 'Pegasus_backend.Models.Result`1[[System.Object, System.Private.CoreLib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2019-07-16 10:51:57.332 +12:00 [INF] Executed action Pegasus_backend.Controllers.LessonController.GetLessonsForReceptionist (Pegasus_backend) in 3189.056ms
2019-07-16 10:51:57.332 +12:00 [INF] Request finished in 3189.9335ms 200 application/json; charset=utf-8
2019-07-16 10:51:59.215 +12:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/api/lesson/GetLessonsForReceptionist/3/2019-07-16  
2019-07-16 10:51:59.216 +12:00 [INF] Route matched with {action = "GetLessonsForReceptionist", controller = "Lesson"}. Executing action Pegasus_backend.Controllers.LessonController.GetLessonsForReceptionist (Pegasus_backend)
2019-07-16 10:51:59.216 +12:00 [INF] Executing action method Pegasus_backend.Controllers.LessonController.GetLessonsForReceptionist (Pegasus_backend) with arguments (["3","07/16/2019 00:00:00"]) - Validation state: "Valid"
2019-07-16 10:51:59.216 +12:00 [INF] Entity Framework Core 2.1.8-servicing-32085 initialized 'ablemusicContext' using provider 'MySql.Data.EntityFrameworkCore' with options: None
2019-07-16 10:51:59.399 +12:00 [INF] Executed DbCommand (55ms) [Parameters=[@__8__locals1_userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT `s`.`staff_id`, `s`.`dob`, `s`.`email`, `s`.`expiry_date`, `s`.`first_name`, `s`.`gender`, `s`.`home_phone`, `s`.`id_number`, `s`.`id_photo`, `s`.`id_type`, `s`.`ird_number`, `s`.`is_activate`, `s`.`last_name`, `s`.`mobile_phone`, `s`.`photo`, `s`.`user_id`, `s`.`visa`
FROM `ablemusic`.`staff` AS `s`
WHERE `s`.`user_id` = @__8__locals1_userId_0
LIMIT 1
2019-07-16 10:51:59.575 +12:00 [INF] Executed DbCommand (51ms) [Parameters=[@__staff_StaffId_0='?' (DbType = Int16)], CommandType='"Text"', CommandTimeout='30']
SELECT `s`.`staff_org_id`, `s`.`is_activate`, `s`.`org_id`, `s`.`staff_id`
FROM `ablemusic`.`staff_org` AS `s`
WHERE `s`.`staff_id` = @__staff_StaffId_0
LIMIT 1
2019-07-16 10:51:59.588 +12:00 [WRN] The Include operation for navigation '[s].CourseInstance' is unnecessary and was ignored because the navigation is not reachable in the final query results. See https://go.microsoft.com/fwlink/?linkid=850303 for more information.
2019-07-16 10:51:59.589 +12:00 [WRN] The Include operation for navigation '[s].Learner' is unnecessary and was ignored because the navigation is not reachable in the final query results. See https://go.microsoft.com/fwlink/?linkid=850303 for more information.
2019-07-16 10:51:59.589 +12:00 [WRN] The Include operation for navigation '[s].Teacher' is unnecessary and was ignored because the navigation is not reachable in the final query results. See https://go.microsoft.com/fwlink/?linkid=850303 for more information.
2019-07-16 10:51:59.589 +12:00 [WRN] The Include operation for navigation '[s].Room' is unnecessary and was ignored because the navigation is not reachable in the final query results. See https://go.microsoft.com/fwlink/?linkid=850303 for more information.
2019-07-16 10:51:59.589 +12:00 [WRN] The Include operation for navigation '[s].Org' is unnecessary and was ignored because the navigation is not reachable in the final query results. See https://go.microsoft.com/fwlink/?linkid=850303 for more information.
2019-07-16 10:51:59.589 +12:00 [WRN] The Include operation for navigation '[s].TrialCourse' is unnecessary and was ignored because the navigation is not reachable in the final query results. See https://go.microsoft.com/fwlink/?linkid=850303 for more information.
2019-07-16 10:51:59.589 +12:00 [WRN] The Include operation for navigation '[s].GroupCourseInstance.LearnerGroupCourse.Learner' is unnecessary and was ignored because the navigation is not reachable in the final query results. See https://go.microsoft.com/fwlink/?linkid=850303 for more information.
2019-07-16 10:51:59.589 +12:00 [WRN] The Include operation for navigation '[s].AwaitMakeUpLessonNewLesson' is unnecessary and was ignored because the navigation is not reachable in the final query results. See https://go.microsoft.com/fwlink/?linkid=850303 for more information.
2019-07-16 10:51:59.607 +12:00 [WRN] The LINQ expression 'where ((((Convert(Convert([s].OrgId, Int32), Nullable`1) == Convert(__orgId_0, Nullable`1)) AndAlso (Convert([s].BeginTime, DateTime).Year == __8__locals1_date_Year_1)) AndAlso (Convert([s].BeginTime, DateTime).Month == __8__locals1_date_Month_2)) AndAlso (Convert([s].BeginTime, DateTime).Day == __8__locals1_date_Day_3))' could not be translated and will be evaluated locally.
2019-07-16 10:51:59.838 +12:00 [INF] Executed DbCommand (89ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT `s.CourseInstance`.`course_instance_id`, `s.CourseInstance`.`begin_date`, `s.CourseInstance`.`course_id`, `s.CourseInstance`.`end_date`, `s.CourseInstance`.`invoice_date`, `s.CourseInstance`.`learner_id`, `s.CourseInstance`.`org_id`, `s.CourseInstance`.`room_id`, `s.CourseInstance`.`teacher_id`, `s.GroupCourseInstance`.`group_course_instance_id`, `s.GroupCourseInstance`.`begin_date`, `s.GroupCourseInstance`.`course_id`, `s.GroupCourseInstance`.`end_date`, `s.GroupCourseInstance`.`invoice_date`, `s.GroupCourseInstance`.`is_activate`, `s.GroupCourseInstance`.`is_started`, `s.GroupCourseInstance`.`org_id`, `s.GroupCourseInstance`.`room_id`, `s.GroupCourseInstance`.`teacher_id`, `s`.`org_id` AS `OrgId`, `s`.`begin_time` AS `start`, `s`.`lesson_id` AS `id`, `s`.`room_id` AS `resourceId`, `s`.`end_time` AS `end`, `s.Teacher`.`first_name` AS `TeacherName`, `s`.`is_canceled` AS `IsCanceled`, `s`.`is_confirm` AS `IsConfirm`, `s`.`is_changed` AS `IsChanged`, `s`.`new_lesson_id`, `s`.`reason`, CASE
    WHEN `s`.`is_paid` = 1
    THEN 0 ELSE 1
END, CASE
    WHEN (
        SELECT `q1`.`quantity`
        FROM `ablemusic`.`lesson_remain` AS `q1`
        WHERE ((`q1`.`learner_id` = `s`.`learner_id`) OR (`q1`.`learner_id` IS NULL AND `s`.`learner_id` IS NULL)) AND ((`q1`.`course_instance_id` = `s`.`course_instance_id`) OR (`q1`.`course_instance_id` IS NULL AND `s`.`course_instance_id` IS NULL))
        LIMIT 1
    ) <= 3
    THEN 1 ELSE 0
END, `s.Learner`.`first_name` AS `FirstName`, `s`.`learner_id` AS `LearnerId`, `s.Room`.`room_name` AS `RoomName`, `s.Org`.`org_name` AS `OrgName`, `s`.`teacher_id` AS `TeacherId`, `s.GroupCourseInstance.Course`.`course_name`, `s.TrialCourse`.`course_name`, `s.CourseInstance.Course`.`course_name`, `s.GroupCourseInstance.Course`.`course_id`, `s`.`trial_course_id`, `s.CourseInstance.Course`.`course_id`, `s`.`learner_id` AS `LearnerId0`
FROM `ablemusic`.`lesson` AS `s`
LEFT JOIN `ablemusic`.`course` AS `s.TrialCourse` ON `s`.`trial_course_id` = `s.TrialCourse`.`course_id`
INNER JOIN `ablemusic`.`org` AS `s.Org` ON `s`.`org_id` = `s.Org`.`org_id`
LEFT JOIN `ablemusic`.`room` AS `s.Room` ON `s`.`room_id` = `s.Room`.`room_id`
LEFT JOIN `ablemusic`.`learner` AS `s.Learner` ON `s`.`learner_id` = `s.Learner`.`learner_id`
LEFT JOIN `ablemusic`.`teacher` AS `s.Teacher` ON `s`.`teacher_id` = `s.Teacher`.`teacher_id`
LEFT JOIN `ablemusic`.`one2one_course_instance` AS `s.CourseInstance` ON `s`.`course_instance_id` = `s.CourseInstance`.`course_instance_id`
LEFT JOIN `ablemusic`.`course` AS `s.CourseInstance.Course` ON `s.CourseInstance`.`course_id` = `s.CourseInstance.Course`.`course_id`
LEFT JOIN `ablemusic`.`group_course_instance` AS `s.GroupCourseInstance` ON `s`.`group_course_instance_id` = `s.GroupCourseInstance`.`group_course_instance_id`
LEFT JOIN `ablemusic`.`course` AS `s.GroupCourseInstance.Course` ON `s.GroupCourseInstance`.`course_id` = `s.GroupCourseInstance.Course`.`course_id`
2019-07-16 10:52:00.262 +12:00 [INF] Executed DbCommand (57ms) [Parameters=[@_outer_NewLessonId='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT `r`.`lesson_id`, `r`.`begin_time`, `r`.`course_instance_id`, `r`.`created_at`, `r`.`end_time`, `r`.`group_course_instance_id`, `r`.`invoice_id`, `r`.`is_canceled`, `r`.`is_changed`, `r`.`is_confirm`, `r`.`is_paid`, `r`.`is_trial`, `r`.`learner_id`, `r`.`new_lesson_id`, `r`.`org_id`, `r`.`reason`, `r`.`room_id`, `r`.`teacher_id`, `r`.`trial_course_id`
FROM `ablemusic`.`lesson` AS `r`
WHERE `r`.`lesson_id` = @_outer_NewLessonId
LIMIT 1
2019-07-16 10:52:00.460 +12:00 [INF] Executed DbCommand (59ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT `r`.`lesson_id`, `r`.`begin_time`, `r`.`course_instance_id`, `r`.`created_at`, `r`.`end_time`, `r`.`group_course_instance_id`, `r`.`invoice_id`, `r`.`is_canceled`, `r`.`is_changed`, `r`.`is_confirm`, `r`.`is_paid`, `r`.`is_trial`, `r`.`learner_id`, `r`.`new_lesson_id`, `r`.`org_id`, `r`.`reason`, `r`.`room_id`, `r`.`teacher_id`, `r`.`trial_course_id`
FROM `ablemusic`.`lesson` AS `r`
WHERE `r`.`lesson_id` IS NULL
LIMIT 1
2019-07-16 10:52:00.660 +12:00 [INF] Executed DbCommand (58ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT `r`.`lesson_id`, `r`.`begin_time`, `r`.`course_instance_id`, `r`.`created_at`, `r`.`end_time`, `r`.`group_course_instance_id`, `r`.`invoice_id`, `r`.`is_canceled`, `r`.`is_changed`, `r`.`is_confirm`, `r`.`is_paid`, `r`.`is_trial`, `r`.`learner_id`, `r`.`new_lesson_id`, `r`.`org_id`, `r`.`reason`, `r`.`room_id`, `r`.`teacher_id`, `r`.`trial_course_id`
FROM `ablemusic`.`lesson` AS `r`
WHERE `r`.`lesson_id` IS NULL
LIMIT 1
2019-07-16 10:52:00.661 +12:00 [INF] Executed action method Pegasus_backend.Controllers.LessonController.GetLessonsForReceptionist (Pegasus_backend), returned result Microsoft.AspNetCore.Mvc.OkObjectResult in 1444.9269000000002ms.
2019-07-16 10:52:00.661 +12:00 [INF] Executing ObjectResult, writing value of type 'Pegasus_backend.Models.Result`1[[System.Object, System.Private.CoreLib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2019-07-16 10:52:00.662 +12:00 [INF] Executed action Pegasus_backend.Controllers.LessonController.GetLessonsForReceptionist (Pegasus_backend) in 1446.2664ms
2019-07-16 10:52:00.662 +12:00 [INF] Request finished in 1447.0289ms 200 application/json; charset=utf-8
2019-07-16 10:52:02.495 +12:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/api/lesson/GetLessonsForReceptionist/3/2019-07-16  
2019-07-16 10:52:02.495 +12:00 [INF] Route matched with {action = "GetLessonsForReceptionist", controller = "Lesson"}. Executing action Pegasus_backend.Controllers.LessonController.GetLessonsForReceptionist (Pegasus_backend)
2019-07-16 10:52:02.495 +12:00 [INF] Executing action method Pegasus_backend.Controllers.LessonController.GetLessonsForReceptionist (Pegasus_backend) with arguments (["3","07/16/2019 00:00:00"]) - Validation state: "Valid"
2019-07-16 10:52:02.495 +12:00 [INF] Entity Framework Core 2.1.8-servicing-32085 initialized 'ablemusicContext' using provider 'MySql.Data.EntityFrameworkCore' with options: None
2019-07-16 10:52:02.695 +12:00 [INF] Executed DbCommand (63ms) [Parameters=[@__8__locals1_userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT `s`.`staff_id`, `s`.`dob`, `s`.`email`, `s`.`expiry_date`, `s`.`first_name`, `s`.`gender`, `s`.`home_phone`, `s`.`id_number`, `s`.`id_photo`, `s`.`id_type`, `s`.`ird_number`, `s`.`is_activate`, `s`.`last_name`, `s`.`mobile_phone`, `s`.`photo`, `s`.`user_id`, `s`.`visa`
FROM `ablemusic`.`staff` AS `s`
WHERE `s`.`user_id` = @__8__locals1_userId_0
LIMIT 1
2019-07-16 10:52:02.874 +12:00 [INF] Executed DbCommand (50ms) [Parameters=[@__staff_StaffId_0='?' (DbType = Int16)], CommandType='"Text"', CommandTimeout='30']
SELECT `s`.`staff_org_id`, `s`.`is_activate`, `s`.`org_id`, `s`.`staff_id`
FROM `ablemusic`.`staff_org` AS `s`
WHERE `s`.`staff_id` = @__staff_StaffId_0
LIMIT 1
2019-07-16 10:52:02.890 +12:00 [WRN] The Include operation for navigation '[s].CourseInstance' is unnecessary and was ignored because the navigation is not reachable in the final query results. See https://go.microsoft.com/fwlink/?linkid=850303 for more information.
2019-07-16 10:52:02.890 +12:00 [WRN] The Include operation for navigation '[s].Learner' is unnecessary and was ignored because the navigation is not reachable in the final query results. See https://go.microsoft.com/fwlink/?linkid=850303 for more information.
2019-07-16 10:52:02.890 +12:00 [WRN] The Include operation for navigation '[s].Teacher' is unnecessary and was ignored because the navigation is not reachable in the final query results. See https://go.microsoft.com/fwlink/?linkid=850303 for more information.
2019-07-16 10:52:02.890 +12:00 [WRN] The Include operation for navigation '[s].Room' is unnecessary and was ignored because the navigation is not reachable in the final query results. See https://go.microsoft.com/fwlink/?linkid=850303 for more information.
2019-07-16 10:52:02.891 +12:00 [WRN] The Include operation for navigation '[s].Org' is unnecessary and was ignored because the navigation is not reachable in the final query results. See https://go.microsoft.com/fwlink/?linkid=850303 for more information.
2019-07-16 10:52:02.891 +12:00 [WRN] The Include operation for navigation '[s].TrialCourse' is unnecessary and was ignored because the navigation is not reachable in the final query results. See https://go.microsoft.com/fwlink/?linkid=850303 for more information.
2019-07-16 10:52:02.891 +12:00 [WRN] The Include operation for navigation '[s].GroupCourseInstance.LearnerGroupCourse.Learner' is unnecessary and was ignored because the navigation is not reachable in the final query results. See https://go.microsoft.com/fwlink/?linkid=850303 for more information.
2019-07-16 10:52:02.891 +12:00 [WRN] The Include operation for navigation '[s].AwaitMakeUpLessonNewLesson' is unnecessary and was ignored because the navigation is not reachable in the final query results. See https://go.microsoft.com/fwlink/?linkid=850303 for more information.
2019-07-16 10:52:02.909 +12:00 [WRN] The LINQ expression 'where ((((Convert(Convert([s].OrgId, Int32), Nullable`1) == Convert(__orgId_0, Nullable`1)) AndAlso (Convert([s].BeginTime, DateTime).Year == __8__locals1_date_Year_1)) AndAlso (Convert([s].BeginTime, DateTime).Month == __8__locals1_date_Month_2)) AndAlso (Convert([s].BeginTime, DateTime).Day == __8__locals1_date_Day_3))' could not be translated and will be evaluated locally.
2019-07-16 10:52:03.156 +12:00 [INF] Executed DbCommand (87ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT `s.CourseInstance`.`course_instance_id`, `s.CourseInstance`.`begin_date`, `s.CourseInstance`.`course_id`, `s.CourseInstance`.`end_date`, `s.CourseInstance`.`invoice_date`, `s.CourseInstance`.`learner_id`, `s.CourseInstance`.`org_id`, `s.CourseInstance`.`room_id`, `s.CourseInstance`.`teacher_id`, `s.GroupCourseInstance`.`group_course_instance_id`, `s.GroupCourseInstance`.`begin_date`, `s.GroupCourseInstance`.`course_id`, `s.GroupCourseInstance`.`end_date`, `s.GroupCourseInstance`.`invoice_date`, `s.GroupCourseInstance`.`is_activate`, `s.GroupCourseInstance`.`is_started`, `s.GroupCourseInstance`.`org_id`, `s.GroupCourseInstance`.`room_id`, `s.GroupCourseInstance`.`teacher_id`, `s`.`org_id` AS `OrgId`, `s`.`begin_time` AS `start`, `s`.`lesson_id` AS `id`, `s`.`room_id` AS `resourceId`, `s`.`end_time` AS `end`, `s.Teacher`.`first_name` AS `TeacherName`, `s`.`is_canceled` AS `IsCanceled`, `s`.`is_confirm` AS `IsConfirm`, `s`.`is_changed` AS `IsChanged`, `s`.`new_lesson_id`, `s`.`reason`, CASE
    WHEN `s`.`is_paid` = 1
    THEN 0 ELSE 1
END, CASE
    WHEN (
        SELECT `q1`.`quantity`
        FROM `ablemusic`.`lesson_remain` AS `q1`
        WHERE ((`q1`.`learner_id` = `s`.`learner_id`) OR (`q1`.`learner_id` IS NULL AND `s`.`learner_id` IS NULL)) AND ((`q1`.`course_instance_id` = `s`.`course_instance_id`) OR (`q1`.`course_instance_id` IS NULL AND `s`.`course_instance_id` IS NULL))
        LIMIT 1
    ) <= 3
    THEN 1 ELSE 0
END, `s.Learner`.`first_name` AS `FirstName`, `s`.`learner_id` AS `LearnerId`, `s.Room`.`room_name` AS `RoomName`, `s.Org`.`org_name` AS `OrgName`, `s`.`teacher_id` AS `TeacherId`, `s.GroupCourseInstance.Course`.`course_name`, `s.TrialCourse`.`course_name`, `s.CourseInstance.Course`.`course_name`, `s.GroupCourseInstance.Course`.`course_id`, `s`.`trial_course_id`, `s.CourseInstance.Course`.`course_id`, `s`.`learner_id` AS `LearnerId0`
FROM `ablemusic`.`lesson` AS `s`
LEFT JOIN `ablemusic`.`course` AS `s.TrialCourse` ON `s`.`trial_course_id` = `s.TrialCourse`.`course_id`
INNER JOIN `ablemusic`.`org` AS `s.Org` ON `s`.`org_id` = `s.Org`.`org_id`
LEFT JOIN `ablemusic`.`room` AS `s.Room` ON `s`.`room_id` = `s.Room`.`room_id`
LEFT JOIN `ablemusic`.`learner` AS `s.Learner` ON `s`.`learner_id` = `s.Learner`.`learner_id`
LEFT JOIN `ablemusic`.`teacher` AS `s.Teacher` ON `s`.`teacher_id` = `s.Teacher`.`teacher_id`
LEFT JOIN `ablemusic`.`one2one_course_instance` AS `s.CourseInstance` ON `s`.`course_instance_id` = `s.CourseInstance`.`course_instance_id`
LEFT JOIN `ablemusic`.`course` AS `s.CourseInstance.Course` ON `s.CourseInstance`.`course_id` = `s.CourseInstance.Course`.`course_id`
LEFT JOIN `ablemusic`.`group_course_instance` AS `s.GroupCourseInstance` ON `s`.`group_course_instance_id` = `s.GroupCourseInstance`.`group_course_instance_id`
LEFT JOIN `ablemusic`.`course` AS `s.GroupCourseInstance.Course` ON `s.GroupCourseInstance`.`course_id` = `s.GroupCourseInstance.Course`.`course_id`
2019-07-16 10:52:03.520 +12:00 [INF] Executed DbCommand (56ms) [Parameters=[@_outer_NewLessonId='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT `r`.`lesson_id`, `r`.`begin_time`, `r`.`course_instance_id`, `r`.`created_at`, `r`.`end_time`, `r`.`group_course_instance_id`, `r`.`invoice_id`, `r`.`is_canceled`, `r`.`is_changed`, `r`.`is_confirm`, `r`.`is_paid`, `r`.`is_trial`, `r`.`learner_id`, `r`.`new_lesson_id`, `r`.`org_id`, `r`.`reason`, `r`.`room_id`, `r`.`teacher_id`, `r`.`trial_course_id`
FROM `ablemusic`.`lesson` AS `r`
WHERE `r`.`lesson_id` = @_outer_NewLessonId
LIMIT 1
2019-07-16 10:52:03.709 +12:00 [INF] Executed DbCommand (60ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT `r`.`lesson_id`, `r`.`begin_time`, `r`.`course_instance_id`, `r`.`created_at`, `r`.`end_time`, `r`.`group_course_instance_id`, `r`.`invoice_id`, `r`.`is_canceled`, `r`.`is_changed`, `r`.`is_confirm`, `r`.`is_paid`, `r`.`is_trial`, `r`.`learner_id`, `r`.`new_lesson_id`, `r`.`org_id`, `r`.`reason`, `r`.`room_id`, `r`.`teacher_id`, `r`.`trial_course_id`
FROM `ablemusic`.`lesson` AS `r`
WHERE `r`.`lesson_id` IS NULL
LIMIT 1
2019-07-16 10:52:03.893 +12:00 [INF] Executed DbCommand (56ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT `r`.`lesson_id`, `r`.`begin_time`, `r`.`course_instance_id`, `r`.`created_at`, `r`.`end_time`, `r`.`group_course_instance_id`, `r`.`invoice_id`, `r`.`is_canceled`, `r`.`is_changed`, `r`.`is_confirm`, `r`.`is_paid`, `r`.`is_trial`, `r`.`learner_id`, `r`.`new_lesson_id`, `r`.`org_id`, `r`.`reason`, `r`.`room_id`, `r`.`teacher_id`, `r`.`trial_course_id`
FROM `ablemusic`.`lesson` AS `r`
WHERE `r`.`lesson_id` IS NULL
LIMIT 1
2019-07-16 10:52:03.894 +12:00 [INF] Executed action method Pegasus_backend.Controllers.LessonController.GetLessonsForReceptionist (Pegasus_backend), returned result Microsoft.AspNetCore.Mvc.OkObjectResult in 1398.3016ms.
2019-07-16 10:52:03.894 +12:00 [INF] Executing ObjectResult, writing value of type 'Pegasus_backend.Models.Result`1[[System.Object, System.Private.CoreLib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2019-07-16 10:52:03.894 +12:00 [INF] Executed action Pegasus_backend.Controllers.LessonController.GetLessonsForReceptionist (Pegasus_backend) in 1399.5874000000001ms
2019-07-16 10:52:03.895 +12:00 [INF] Request finished in 1400.2888ms 200 application/json; charset=utf-8
2019-07-16 11:04:29.170 +12:00 [INF] User profile is available. Using '/Users/oliver/.aspnet/DataProtection-Keys' as key repository; keys will not be encrypted at rest.
2019-07-16 11:11:09.308 +12:00 [INF] User profile is available. Using '/Users/oliver/.aspnet/DataProtection-Keys' as key repository; keys will not be encrypted at rest.
2019-07-16 11:11:11.491 +12:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/api/lesson/GetLessonsForReceptionist/3/2019-07-16  
2019-07-16 11:11:11.519 +12:00 [WRN] Failed to determine the https port for redirect.
2019-07-16 11:11:11.653 +12:00 [INF] Route matched with {action = "GetLessonsForReceptionist", controller = "Lesson"}. Executing action Pegasus_backend.Controllers.LessonController.GetLessonsForReceptionist (Pegasus_backend)
2019-07-16 11:11:11.773 +12:00 [INF] Executing action method Pegasus_backend.Controllers.LessonController.GetLessonsForReceptionist (Pegasus_backend) with arguments (["3","07/16/2019 00:00:00"]) - Validation state: "Valid"
2019-07-16 11:11:12.643 +12:00 [INF] Entity Framework Core 2.1.8-servicing-32085 initialized 'ablemusicContext' using provider 'MySql.Data.EntityFrameworkCore' with options: None
2019-07-16 11:11:14.191 +12:00 [INF] Executed DbCommand (61ms) [Parameters=[@__8__locals1_userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT `s`.`staff_id`, `s`.`dob`, `s`.`email`, `s`.`expiry_date`, `s`.`first_name`, `s`.`gender`, `s`.`home_phone`, `s`.`id_number`, `s`.`id_photo`, `s`.`id_type`, `s`.`ird_number`, `s`.`is_activate`, `s`.`last_name`, `s`.`mobile_phone`, `s`.`photo`, `s`.`user_id`, `s`.`visa`
FROM `ablemusic`.`staff` AS `s`
WHERE `s`.`user_id` = @__8__locals1_userId_0
LIMIT 1
2019-07-16 11:11:14.449 +12:00 [INF] Executed DbCommand (51ms) [Parameters=[@__staff_StaffId_0='?' (DbType = Int16)], CommandType='"Text"', CommandTimeout='30']
SELECT `s`.`staff_org_id`, `s`.`is_activate`, `s`.`org_id`, `s`.`staff_id`
FROM `ablemusic`.`staff_org` AS `s`
WHERE `s`.`staff_id` = @__staff_StaffId_0
LIMIT 1
2019-07-16 11:11:14.500 +12:00 [WRN] The Include operation for navigation '[s].CourseInstance' is unnecessary and was ignored because the navigation is not reachable in the final query results. See https://go.microsoft.com/fwlink/?linkid=850303 for more information.
2019-07-16 11:11:14.502 +12:00 [WRN] The Include operation for navigation '[s].Learner' is unnecessary and was ignored because the navigation is not reachable in the final query results. See https://go.microsoft.com/fwlink/?linkid=850303 for more information.
2019-07-16 11:11:14.502 +12:00 [WRN] The Include operation for navigation '[s].Teacher' is unnecessary and was ignored because the navigation is not reachable in the final query results. See https://go.microsoft.com/fwlink/?linkid=850303 for more information.
2019-07-16 11:11:14.502 +12:00 [WRN] The Include operation for navigation '[s].Room' is unnecessary and was ignored because the navigation is not reachable in the final query results. See https://go.microsoft.com/fwlink/?linkid=850303 for more information.
2019-07-16 11:11:14.502 +12:00 [WRN] The Include operation for navigation '[s].Org' is unnecessary and was ignored because the navigation is not reachable in the final query results. See https://go.microsoft.com/fwlink/?linkid=850303 for more information.
2019-07-16 11:11:14.502 +12:00 [WRN] The Include operation for navigation '[s].TrialCourse' is unnecessary and was ignored because the navigation is not reachable in the final query results. See https://go.microsoft.com/fwlink/?linkid=850303 for more information.
2019-07-16 11:11:14.502 +12:00 [WRN] The Include operation for navigation '[s].GroupCourseInstance.LearnerGroupCourse.Learner' is unnecessary and was ignored because the navigation is not reachable in the final query results. See https://go.microsoft.com/fwlink/?linkid=850303 for more information.
2019-07-16 11:11:14.503 +12:00 [WRN] The Include operation for navigation '[s].AwaitMakeUpLessonNewLesson' is unnecessary and was ignored because the navigation is not reachable in the final query results. See https://go.microsoft.com/fwlink/?linkid=850303 for more information.
2019-07-16 11:11:14.557 +12:00 [WRN] The LINQ expression 'where ((((Convert(Convert([s].OrgId, Int32), Nullable`1) == Convert(__orgId_0, Nullable`1)) AndAlso (Convert([s].BeginTime, DateTime).Year == __8__locals1_date_Year_1)) AndAlso (Convert([s].BeginTime, DateTime).Month == __8__locals1_date_Month_2)) AndAlso (Convert([s].BeginTime, DateTime).Day == __8__locals1_date_Day_3))' could not be translated and will be evaluated locally.
2019-07-16 11:11:14.827 +12:00 [INF] Executed DbCommand (84ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT `s.CourseInstance`.`course_instance_id`, `s.CourseInstance`.`begin_date`, `s.CourseInstance`.`course_id`, `s.CourseInstance`.`end_date`, `s.CourseInstance`.`invoice_date`, `s.CourseInstance`.`learner_id`, `s.CourseInstance`.`org_id`, `s.CourseInstance`.`room_id`, `s.CourseInstance`.`teacher_id`, `s.GroupCourseInstance`.`group_course_instance_id`, `s.GroupCourseInstance`.`begin_date`, `s.GroupCourseInstance`.`course_id`, `s.GroupCourseInstance`.`end_date`, `s.GroupCourseInstance`.`invoice_date`, `s.GroupCourseInstance`.`is_activate`, `s.GroupCourseInstance`.`is_started`, `s.GroupCourseInstance`.`org_id`, `s.GroupCourseInstance`.`room_id`, `s.GroupCourseInstance`.`teacher_id`, `s`.`org_id` AS `OrgId`, `s`.`begin_time` AS `start`, `s`.`lesson_id` AS `id`, `s`.`room_id` AS `resourceId`, `s`.`end_time` AS `end`, `s.Teacher`.`first_name` AS `TeacherName`, `s`.`is_canceled` AS `IsCanceled`, `s`.`is_confirm` AS `IsConfirm`, `s`.`is_changed` AS `IsChanged`, `s`.`new_lesson_id`, `s`.`reason`, CASE
    WHEN `s`.`is_paid` = 1
    THEN 0 ELSE 1
END, CASE
    WHEN (
        SELECT `q1`.`quantity`
        FROM `ablemusic`.`lesson_remain` AS `q1`
        WHERE ((`q1`.`learner_id` = `s`.`learner_id`) OR (`q1`.`learner_id` IS NULL AND `s`.`learner_id` IS NULL)) AND ((`q1`.`course_instance_id` = `s`.`course_instance_id`) OR (`q1`.`course_instance_id` IS NULL AND `s`.`course_instance_id` IS NULL))
        LIMIT 1
    ) <= 3
    THEN 1 ELSE 0
END, `s.Learner`.`first_name` AS `FirstName`, `s`.`learner_id` AS `LearnerId`, `s.Room`.`room_name` AS `RoomName`, `s.Org`.`org_name` AS `OrgName`, `s`.`teacher_id` AS `TeacherId`, `s.GroupCourseInstance.Course`.`course_name`, `s.TrialCourse`.`course_name`, `s.CourseInstance.Course`.`course_name`, `s.GroupCourseInstance.Course`.`course_id`, `s`.`trial_course_id`, `s.CourseInstance.Course`.`course_id`, `s`.`learner_id` AS `LearnerId0`
FROM `ablemusic`.`lesson` AS `s`
LEFT JOIN `ablemusic`.`course` AS `s.TrialCourse` ON `s`.`trial_course_id` = `s.TrialCourse`.`course_id`
INNER JOIN `ablemusic`.`org` AS `s.Org` ON `s`.`org_id` = `s.Org`.`org_id`
LEFT JOIN `ablemusic`.`room` AS `s.Room` ON `s`.`room_id` = `s.Room`.`room_id`
LEFT JOIN `ablemusic`.`learner` AS `s.Learner` ON `s`.`learner_id` = `s.Learner`.`learner_id`
LEFT JOIN `ablemusic`.`teacher` AS `s.Teacher` ON `s`.`teacher_id` = `s.Teacher`.`teacher_id`
LEFT JOIN `ablemusic`.`one2one_course_instance` AS `s.CourseInstance` ON `s`.`course_instance_id` = `s.CourseInstance`.`course_instance_id`
LEFT JOIN `ablemusic`.`course` AS `s.CourseInstance.Course` ON `s.CourseInstance`.`course_id` = `s.CourseInstance.Course`.`course_id`
LEFT JOIN `ablemusic`.`group_course_instance` AS `s.GroupCourseInstance` ON `s`.`group_course_instance_id` = `s.GroupCourseInstance`.`group_course_instance_id`
LEFT JOIN `ablemusic`.`course` AS `s.GroupCourseInstance.Course` ON `s.GroupCourseInstance`.`course_id` = `s.GroupCourseInstance.Course`.`course_id`
2019-07-16 11:11:15.039 +12:00 [INF] Executed DbCommand (60ms) [Parameters=[@_outer_NewLessonId='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT `r`.`lesson_id`, `r`.`begin_time`, `r`.`course_instance_id`, `r`.`created_at`, `r`.`end_time`, `r`.`group_course_instance_id`, `r`.`invoice_id`, `r`.`is_canceled`, `r`.`is_changed`, `r`.`is_confirm`, `r`.`is_paid`, `r`.`is_trial`, `r`.`learner_id`, `r`.`new_lesson_id`, `r`.`org_id`, `r`.`reason`, `r`.`room_id`, `r`.`teacher_id`, `r`.`trial_course_id`
FROM `ablemusic`.`lesson` AS `r`
WHERE `r`.`lesson_id` = @_outer_NewLessonId
LIMIT 1
2019-07-16 11:11:15.246 +12:00 [INF] Executed DbCommand (54ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT `r`.`lesson_id`, `r`.`begin_time`, `r`.`course_instance_id`, `r`.`created_at`, `r`.`end_time`, `r`.`group_course_instance_id`, `r`.`invoice_id`, `r`.`is_canceled`, `r`.`is_changed`, `r`.`is_confirm`, `r`.`is_paid`, `r`.`is_trial`, `r`.`learner_id`, `r`.`new_lesson_id`, `r`.`org_id`, `r`.`reason`, `r`.`room_id`, `r`.`teacher_id`, `r`.`trial_course_id`
FROM `ablemusic`.`lesson` AS `r`
WHERE `r`.`lesson_id` IS NULL
LIMIT 1
2019-07-16 11:11:15.431 +12:00 [INF] Executed DbCommand (58ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT `r`.`lesson_id`, `r`.`begin_time`, `r`.`course_instance_id`, `r`.`created_at`, `r`.`end_time`, `r`.`group_course_instance_id`, `r`.`invoice_id`, `r`.`is_canceled`, `r`.`is_changed`, `r`.`is_confirm`, `r`.`is_paid`, `r`.`is_trial`, `r`.`learner_id`, `r`.`new_lesson_id`, `r`.`org_id`, `r`.`reason`, `r`.`room_id`, `r`.`teacher_id`, `r`.`trial_course_id`
FROM `ablemusic`.`lesson` AS `r`
WHERE `r`.`lesson_id` IS NULL
LIMIT 1
2019-07-16 11:11:15.438 +12:00 [INF] Executed action method Pegasus_backend.Controllers.LessonController.GetLessonsForReceptionist (Pegasus_backend), returned result Microsoft.AspNetCore.Mvc.OkObjectResult in 3653.2684000000004ms.
2019-07-16 11:11:15.446 +12:00 [INF] Executing ObjectResult, writing value of type 'Pegasus_backend.Models.Result`1[[System.Object, System.Private.CoreLib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2019-07-16 11:11:15.532 +12:00 [INF] Executed action Pegasus_backend.Controllers.LessonController.GetLessonsForReceptionist (Pegasus_backend) in 3875.585ms
2019-07-16 11:11:15.535 +12:00 [INF] Request finished in 4045.4832ms 200 application/json; charset=utf-8
2019-07-16 11:29:01.508 +12:00 [INF] User profile is available. Using '/Users/oliver/.aspnet/DataProtection-Keys' as key repository; keys will not be encrypted at rest.
2019-07-16 11:29:03.977 +12:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/api/lesson/GetLessonsForReceptionist/3/2019-07-16  
2019-07-16 11:29:04.005 +12:00 [WRN] Failed to determine the https port for redirect.
2019-07-16 11:29:04.140 +12:00 [INF] Route matched with {action = "GetLessonsForReceptionist", controller = "Lesson"}. Executing action Pegasus_backend.Controllers.LessonController.GetLessonsForReceptionist (Pegasus_backend)
2019-07-16 11:29:04.266 +12:00 [INF] Executing action method Pegasus_backend.Controllers.LessonController.GetLessonsForReceptionist (Pegasus_backend) with arguments (["3","07/16/2019 00:00:00"]) - Validation state: "Valid"
2019-07-16 11:29:05.187 +12:00 [INF] Entity Framework Core 2.1.8-servicing-32085 initialized 'ablemusicContext' using provider 'MySql.Data.EntityFrameworkCore' with options: None
2019-07-16 11:29:06.144 +12:00 [INF] Executed DbCommand (62ms) [Parameters=[@__8__locals1_userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT `s`.`staff_id`, `s`.`dob`, `s`.`email`, `s`.`expiry_date`, `s`.`first_name`, `s`.`gender`, `s`.`home_phone`, `s`.`id_number`, `s`.`id_photo`, `s`.`id_type`, `s`.`ird_number`, `s`.`is_activate`, `s`.`last_name`, `s`.`mobile_phone`, `s`.`photo`, `s`.`user_id`, `s`.`visa`
FROM `ablemusic`.`staff` AS `s`
WHERE `s`.`user_id` = @__8__locals1_userId_0
LIMIT 1
2019-07-16 11:29:06.398 +12:00 [INF] Executed DbCommand (53ms) [Parameters=[@__staff_StaffId_0='?' (DbType = Int16)], CommandType='"Text"', CommandTimeout='30']
SELECT `s`.`staff_org_id`, `s`.`is_activate`, `s`.`org_id`, `s`.`staff_id`
FROM `ablemusic`.`staff_org` AS `s`
WHERE `s`.`staff_id` = @__staff_StaffId_0
LIMIT 1
2019-07-16 11:29:06.454 +12:00 [WRN] The Include operation for navigation '[s].CourseInstance' is unnecessary and was ignored because the navigation is not reachable in the final query results. See https://go.microsoft.com/fwlink/?linkid=850303 for more information.
2019-07-16 11:29:06.455 +12:00 [WRN] The Include operation for navigation '[s].Learner' is unnecessary and was ignored because the navigation is not reachable in the final query results. See https://go.microsoft.com/fwlink/?linkid=850303 for more information.
2019-07-16 11:29:06.455 +12:00 [WRN] The Include operation for navigation '[s].Teacher' is unnecessary and was ignored because the navigation is not reachable in the final query results. See https://go.microsoft.com/fwlink/?linkid=850303 for more information.
2019-07-16 11:29:06.456 +12:00 [WRN] The Include operation for navigation '[s].Room' is unnecessary and was ignored because the navigation is not reachable in the final query results. See https://go.microsoft.com/fwlink/?linkid=850303 for more information.
2019-07-16 11:29:06.456 +12:00 [WRN] The Include operation for navigation '[s].Org' is unnecessary and was ignored because the navigation is not reachable in the final query results. See https://go.microsoft.com/fwlink/?linkid=850303 for more information.
2019-07-16 11:29:06.456 +12:00 [WRN] The Include operation for navigation '[s].TrialCourse' is unnecessary and was ignored because the navigation is not reachable in the final query results. See https://go.microsoft.com/fwlink/?linkid=850303 for more information.
2019-07-16 11:29:06.456 +12:00 [WRN] The Include operation for navigation '[s].GroupCourseInstance.LearnerGroupCourse.Learner' is unnecessary and was ignored because the navigation is not reachable in the final query results. See https://go.microsoft.com/fwlink/?linkid=850303 for more information.
2019-07-16 11:29:06.456 +12:00 [WRN] The Include operation for navigation '[s].AwaitMakeUpLessonNewLesson' is unnecessary and was ignored because the navigation is not reachable in the final query results. See https://go.microsoft.com/fwlink/?linkid=850303 for more information.
2019-07-16 11:29:06.512 +12:00 [WRN] The LINQ expression 'where ((((Convert(Convert([s].OrgId, Int32), Nullable`1) == Convert(__orgId_0, Nullable`1)) AndAlso (Convert([s].BeginTime, DateTime).Year == __8__locals1_date_Year_1)) AndAlso (Convert([s].BeginTime, DateTime).Month == __8__locals1_date_Month_2)) AndAlso (Convert([s].BeginTime, DateTime).Day == __8__locals1_date_Day_3))' could not be translated and will be evaluated locally.
2019-07-16 11:29:06.840 +12:00 [INF] Executed DbCommand (129ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT `s.CourseInstance`.`course_instance_id`, `s.CourseInstance`.`begin_date`, `s.CourseInstance`.`course_id`, `s.CourseInstance`.`end_date`, `s.CourseInstance`.`invoice_date`, `s.CourseInstance`.`learner_id`, `s.CourseInstance`.`org_id`, `s.CourseInstance`.`room_id`, `s.CourseInstance`.`teacher_id`, `s.GroupCourseInstance`.`group_course_instance_id`, `s.GroupCourseInstance`.`begin_date`, `s.GroupCourseInstance`.`course_id`, `s.GroupCourseInstance`.`end_date`, `s.GroupCourseInstance`.`invoice_date`, `s.GroupCourseInstance`.`is_activate`, `s.GroupCourseInstance`.`is_started`, `s.GroupCourseInstance`.`org_id`, `s.GroupCourseInstance`.`room_id`, `s.GroupCourseInstance`.`teacher_id`, `s`.`org_id` AS `OrgId`, `s`.`begin_time` AS `start`, `s`.`lesson_id` AS `id`, `s`.`room_id` AS `resourceId`, `s`.`end_time` AS `end`, `s.Teacher`.`first_name` AS `TeacherFirstName0`, `s`.`is_canceled` AS `IsCanceled`, `s`.`is_confirm` AS `IsConfirm`, `s`.`is_changed` AS `IsChanged`, (
    SELECT `z`.`first_name`
    FROM `ablemusic`.`teacher` AS `z`
    WHERE `z`.`teacher_id` = (
        SELECT `r`.`teacher_id`
        FROM `ablemusic`.`lesson` AS `r`
        WHERE `r`.`lesson_id` = `s`.`new_lesson_id`
        LIMIT 1
    )
    LIMIT 1
) AS `TeacherFirstName`, (
    SELECT `z0`.`last_name`
    FROM `ablemusic`.`teacher` AS `z0`
    WHERE `z0`.`teacher_id` = (
        SELECT `r0`.`teacher_id`
        FROM `ablemusic`.`lesson` AS `r0`
        WHERE `r0`.`lesson_id` = `s`.`new_lesson_id`
        LIMIT 1
    )
    LIMIT 1
) AS `TeacherLastName`, (
    SELECT `z1`.`room_name`
    FROM `ablemusic`.`room` AS `z1`
    WHERE `z1`.`room_id` = (
        SELECT `r1`.`room_id`
        FROM `ablemusic`.`lesson` AS `r1`
        WHERE `r1`.`lesson_id` = `s`.`new_lesson_id`
        LIMIT 1
    )
    LIMIT 1
) AS `RoomName`, (
    SELECT `z2`.`org_name`
    FROM `ablemusic`.`org` AS `z2`
    WHERE `z2`.`org_id` = (
        SELECT `r2`.`org_id`
        FROM `ablemusic`.`lesson` AS `r2`
        WHERE `r2`.`lesson_id` = `s`.`new_lesson_id`
        LIMIT 1
    )
    LIMIT 1
) AS `OrgName`, `s`.`reason`, CASE
    WHEN `s`.`is_paid` = 1
    THEN 0 ELSE 1
END, CASE
    WHEN (
        SELECT `q1`.`quantity`
        FROM `ablemusic`.`lesson_remain` AS `q1`
        WHERE ((`q1`.`learner_id` = `s`.`learner_id`) OR (`q1`.`learner_id` IS NULL AND `s`.`learner_id` IS NULL)) AND ((`q1`.`course_instance_id` = `s`.`course_instance_id`) OR (`q1`.`course_instance_id` IS NULL AND `s`.`course_instance_id` IS NULL))
        LIMIT 1
    ) <= 3
    THEN 1 ELSE 0
END, `s.Learner`.`first_name` AS `FirstName`, `s`.`learner_id` AS `LearnerId`, `s.Room`.`room_name` AS `RoomName0`, `s.Org`.`org_name` AS `OrgName0`, `s`.`teacher_id` AS `TeacherId`, `s.GroupCourseInstance.Course`.`course_name`, `s.TrialCourse`.`course_name`, `s.CourseInstance.Course`.`course_name`, `s.GroupCourseInstance.Course`.`course_id`, `s`.`trial_course_id`, `s.CourseInstance.Course`.`course_id`, `s`.`learner_id` AS `LearnerId0`
FROM `ablemusic`.`lesson` AS `s`
LEFT JOIN `ablemusic`.`course` AS `s.TrialCourse` ON `s`.`trial_course_id` = `s.TrialCourse`.`course_id`
INNER JOIN `ablemusic`.`org` AS `s.Org` ON `s`.`org_id` = `s.Org`.`org_id`
LEFT JOIN `ablemusic`.`room` AS `s.Room` ON `s`.`room_id` = `s.Room`.`room_id`
LEFT JOIN `ablemusic`.`learner` AS `s.Learner` ON `s`.`learner_id` = `s.Learner`.`learner_id`
LEFT JOIN `ablemusic`.`teacher` AS `s.Teacher` ON `s`.`teacher_id` = `s.Teacher`.`teacher_id`
LEFT JOIN `ablemusic`.`one2one_course_instance` AS `s.CourseInstance` ON `s`.`course_instance_id` = `s.CourseInstance`.`course_instance_id`
LEFT JOIN `ablemusic`.`course` AS `s.CourseInstance.Course` ON `s.CourseInstance`.`course_id` = `s.CourseInstance.Course`.`course_id`
LEFT JOIN `ablemusic`.`group_course_instance` AS `s.GroupCourseInstance` ON `s`.`group_course_instance_id` = `s.GroupCourseInstance`.`group_course_instance_id`
LEFT JOIN `ablemusic`.`course` AS `s.GroupCourseInstance.Course` ON `s.GroupCourseInstance`.`course_id` = `s.GroupCourseInstance.Course`.`course_id`
2019-07-16 11:29:06.986 +12:00 [INF] Executed action method Pegasus_backend.Controllers.LessonController.GetLessonsForReceptionist (Pegasus_backend), returned result Microsoft.AspNetCore.Mvc.OkObjectResult in 2707.9152ms.
2019-07-16 11:29:06.993 +12:00 [INF] Executing ObjectResult, writing value of type 'Pegasus_backend.Models.Result`1[[System.Object, System.Private.CoreLib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2019-07-16 11:29:07.052 +12:00 [INF] Executed action Pegasus_backend.Controllers.LessonController.GetLessonsForReceptionist (Pegasus_backend) in 2909.3605000000002ms
2019-07-16 11:29:07.055 +12:00 [INF] Request finished in 3079.3367ms 200 application/json; charset=utf-8
