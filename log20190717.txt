2019-07-17 10:39:01.290 +12:00 [INF] User profile is available. Using 'C:\Users\Learnspace\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2019-07-17 10:39:03.201 +12:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/  
2019-07-17 10:39:03.241 +12:00 [WRN] Failed to determine the https port for redirect.
2019-07-17 10:39:03.509 +12:00 [INF] Request finished in 310.9643ms 404 
2019-07-17 11:43:06.815 +12:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5000/api/navitems  
2019-07-17 11:43:06.815 +12:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5000/api/lookups  
2019-07-17 11:43:06.828 +12:00 [INF] Policy execution successful.
2019-07-17 11:43:06.828 +12:00 [INF] Policy execution successful.
2019-07-17 11:43:06.829 +12:00 [INF] Request finished in 14.7123ms 204 
2019-07-17 11:43:06.829 +12:00 [INF] Request finished in 14.7123ms 204 
2019-07-17 11:43:06.861 +12:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5000/api/room/forCalendar  
2019-07-17 11:43:06.861 +12:00 [INF] Policy execution successful.
2019-07-17 11:43:06.861 +12:00 [INF] Request finished in 0.5294ms 204 
2019-07-17 11:43:06.932 +12:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/api/lookups  
2019-07-17 11:43:06.932 +12:00 [INF] Policy execution successful.
2019-07-17 11:43:06.939 +12:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/api/navitems  
2019-07-17 11:43:06.940 +12:00 [INF] Policy execution successful.
2019-07-17 11:43:06.945 +12:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/api/room/forCalendar  
2019-07-17 11:43:06.948 +12:00 [INF] Policy execution successful.
2019-07-17 11:43:07.062 +12:00 [INF] Successfully validated the token.
2019-07-17 11:43:07.062 +12:00 [INF] Successfully validated the token.
2019-07-17 11:43:07.062 +12:00 [INF] Successfully validated the token.
2019-07-17 11:43:07.093 +12:00 [INF] Route matched with {action = "GetRoom", controller = "Room"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetRoom() on controller Pegasus_backend.Controllers.RoomController (Pegasus_backend).
2019-07-17 11:43:07.093 +12:00 [INF] Route matched with {action = "GetNavItems", controller = "NavItems"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult GetNavItems() on controller Pegasus_backend.Controllers.NavItemsController (Pegasus_backend).
2019-07-17 11:43:07.093 +12:00 [INF] Route matched with {action = "GetLookups", controller = "Lookups"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetLookups() on controller Pegasus_backend.Controllers.LookupsController (Pegasus_backend).
2019-07-17 11:43:07.110 +12:00 [INF] Authorization was successful.
2019-07-17 11:43:07.110 +12:00 [INF] Authorization was successful.
2019-07-17 11:43:07.400 +12:00 [INF] Executing action method Pegasus_backend.Controllers.NavItemsController.GetNavItems (Pegasus_backend) - Validation state: "Valid"
2019-07-17 11:43:07.400 +12:00 [INF] Executing action method Pegasus_backend.Controllers.RoomController.GetRoom (Pegasus_backend) - Validation state: "Valid"
2019-07-17 11:43:07.400 +12:00 [INF] Executing action method Pegasus_backend.Controllers.LookupsController.GetLookups (Pegasus_backend) - Validation state: "Valid"
2019-07-17 11:43:08.871 +12:00 [INF] Entity Framework Core 2.1.11-servicing-32099 initialized 'ablemusicContext' using provider 'MySql.Data.EntityFrameworkCore' with options: None
2019-07-17 11:43:08.871 +12:00 [INF] Entity Framework Core 2.1.11-servicing-32099 initialized 'ablemusicContext' using provider 'MySql.Data.EntityFrameworkCore' with options: None
2019-07-17 11:43:08.871 +12:00 [INF] Entity Framework Core 2.1.11-servicing-32099 initialized 'ablemusicContext' using provider 'MySql.Data.EntityFrameworkCore' with options: None
2019-07-17 11:43:10.256 +12:00 [INF] Executed DbCommand (62ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT `l`.`lookup_id`, `l`.`description`, `l`.`lookup_type`, `l`.`prop_name`, `l`.`prop_value`
FROM `ablemusic`.`lookup` AS `l`
2019-07-17 11:43:10.256 +12:00 [INF] Executed DbCommand (58ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT `s`.`staff_id`, `s`.`dob`, `s`.`email`, `s`.`expiry_date`, `s`.`first_name`, `s`.`gender`, `s`.`home_phone`, `s`.`id_number`, `s`.`id_photo`, `s`.`id_type`, `s`.`ird_number`, `s`.`is_activate`, `s`.`last_name`, `s`.`mobile_phone`, `s`.`photo`, `s`.`user_id`, `s`.`visa`
FROM `ablemusic`.`staff` AS `s`
WHERE `s`.`user_id` = @__userId_0
LIMIT 1
2019-07-17 11:43:10.256 +12:00 [INF] Executed DbCommand (63ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT `s`.`user_id`, `s`.`created_at`, `s`.`is_activate`, `s`.`is_online`, `s`.`password`, `s`.`role_id`, `s`.`signature`, `s`.`unread_message_id`, `s`.`user_name`
FROM `ablemusic`.`user` AS `s`
WHERE `s`.`user_id` = @__userId_0
LIMIT 1
2019-07-17 11:43:10.338 +12:00 [INF] Executed action method Pegasus_backend.Controllers.LookupsController.GetLookups (Pegasus_backend), returned result Microsoft.AspNetCore.Mvc.OkObjectResult in 2926.5085000000004ms.
2019-07-17 11:43:10.348 +12:00 [INF] Executing ObjectResult, writing value of type 'Pegasus_backend.Models.Result`1[[System.Collections.Generic.List`1[[Pegasus_backend.pegasusContext.Lookup, Pegasus_backend, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2019-07-17 11:43:10.378 +12:00 [INF] Executed action Pegasus_backend.Controllers.LookupsController.GetLookups (Pegasus_backend) in 3280.5266ms
2019-07-17 11:43:10.380 +12:00 [INF] Request finished in 3448.7501ms 200 application/json; charset=utf-8
2019-07-17 11:43:10.550 +12:00 [INF] Executed DbCommand (54ms) [Parameters=[@__staff_StaffId_0='?' (DbType = Int16)], CommandType='"Text"', CommandTimeout='30']
SELECT `s`.`staff_org_id`, `s`.`is_activate`, `s`.`org_id`, `s`.`staff_id`
FROM `ablemusic`.`staff_org` AS `s`
WHERE `s`.`staff_id` = @__staff_StaffId_0
LIMIT 1
2019-07-17 11:43:10.572 +12:00 [INF] Executed DbCommand (62ms) [Parameters=[@__roleId_0='?' (DbType = Int16)], CommandType='"Text"', CommandTimeout='30']
SELECT `s`.`page_id`
FROM `ablemusic`.`role_access` AS `s`
WHERE `s`.`role_id` = @__roleId_0
2019-07-17 11:43:10.771 +12:00 [INF] Executed DbCommand (51ms) [Parameters=[@__orgId_0='?' (DbType = Int16)], CommandType='"Text"', CommandTimeout='30']
SELECT `s`.`room_id` AS `id`, `s`.`room_name` AS `title`
FROM `ablemusic`.`room` AS `s`
WHERE `s`.`org_id` = @__orgId_0
2019-07-17 11:43:10.776 +12:00 [INF] Executed action method Pegasus_backend.Controllers.RoomController.GetRoom (Pegasus_backend), returned result Microsoft.AspNetCore.Mvc.OkObjectResult in 3368.077ms.
2019-07-17 11:43:10.777 +12:00 [INF] Executing ObjectResult, writing value of type 'Pegasus_backend.Models.Result`1[[System.Collections.Generic.IEnumerable`1[[System.Object, System.Private.CoreLib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2019-07-17 11:43:10.806 +12:00 [INF] Executed action Pegasus_backend.Controllers.RoomController.GetRoom (Pegasus_backend) in 3712.5824000000002ms
2019-07-17 11:43:10.807 +12:00 [INF] Request finished in 3861.3755ms 200 application/json; charset=utf-8
2019-07-17 11:43:10.819 +12:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5000/api/lesson/GetLessonsForReceptionist/3/2019-07-17  
2019-07-17 11:43:10.819 +12:00 [INF] Policy execution successful.
2019-07-17 11:43:10.820 +12:00 [INF] Request finished in 0.889ms 204 
2019-07-17 11:43:10.832 +12:00 [INF] Executed DbCommand (58ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT `s`.`page_group_id`, `s`.`display_order`, `s`.`icon`, `s`.`page_group_name`
FROM `ablemusic`.`page_group` AS `s`
ORDER BY `s`.`page_group_id`
2019-07-17 11:43:10.907 +12:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/api/lesson/GetLessonsForReceptionist/3/2019-07-17  
2019-07-17 11:43:10.907 +12:00 [INF] Policy execution successful.
2019-07-17 11:43:10.907 +12:00 [INF] Successfully validated the token.
2019-07-17 11:43:10.911 +12:00 [INF] Executed DbCommand (60ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT `s.Page`.`page_id`, `s.Page`.`display_order`, `s.Page`.`icon`, `s.Page`.`is_activate`, `s.Page`.`page_group_id`, `s.Page`.`page_name`, `s.Page`.`para`, `s.Page`.`para_flag`, `s.Page`.`url`
FROM `ablemusic`.`page` AS `s.Page`
INNER JOIN (
    SELECT `s0`.`page_group_id`
    FROM `ablemusic`.`page_group` AS `s0`
) AS `t` ON `s.Page`.`page_group_id` = `t`.`page_group_id`
ORDER BY `t`.`page_group_id`
2019-07-17 11:43:10.936 +12:00 [INF] Route matched with {action = "GetLessonsForReceptionist", controller = "Lesson"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetLessonsForReceptionist(Int32, System.DateTime) on controller Pegasus_backend.Controllers.LessonController (Pegasus_backend).
2019-07-17 11:43:10.960 +12:00 [INF] Executed action method Pegasus_backend.Controllers.NavItemsController.GetNavItems (Pegasus_backend), returned result Microsoft.AspNetCore.Mvc.OkObjectResult in 3551.5718ms.
2019-07-17 11:43:10.960 +12:00 [INF] Executing ObjectResult, writing value of type 'Pegasus_backend.Models.Result`1[[System.Object, System.Private.CoreLib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2019-07-17 11:43:10.963 +12:00 [INF] Executing action method Pegasus_backend.Controllers.LessonController.GetLessonsForReceptionist (Pegasus_backend) - Validation state: "Valid"
2019-07-17 11:43:10.980 +12:00 [INF] Executed action Pegasus_backend.Controllers.NavItemsController.GetNavItems (Pegasus_backend) in 3886.3831ms
2019-07-17 11:43:10.980 +12:00 [INF] Request finished in 4040.8527ms 200 application/json; charset=utf-8
2019-07-17 11:43:10.991 +12:00 [INF] Entity Framework Core 2.1.11-servicing-32099 initialized 'ablemusicContext' using provider 'MySql.Data.EntityFrameworkCore' with options: None
2019-07-17 11:43:11.181 +12:00 [INF] Executed DbCommand (55ms) [Parameters=[@__8__locals1_userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT `s`.`staff_id`, `s`.`dob`, `s`.`email`, `s`.`expiry_date`, `s`.`first_name`, `s`.`gender`, `s`.`home_phone`, `s`.`id_number`, `s`.`id_photo`, `s`.`id_type`, `s`.`ird_number`, `s`.`is_activate`, `s`.`last_name`, `s`.`mobile_phone`, `s`.`photo`, `s`.`user_id`, `s`.`visa`
FROM `ablemusic`.`staff` AS `s`
WHERE `s`.`user_id` = @__8__locals1_userId_0
LIMIT 1
2019-07-17 11:43:11.364 +12:00 [INF] Executed DbCommand (50ms) [Parameters=[@__staff_StaffId_0='?' (DbType = Int16)], CommandType='"Text"', CommandTimeout='30']
SELECT `s`.`staff_org_id`, `s`.`is_activate`, `s`.`org_id`, `s`.`staff_id`
FROM `ablemusic`.`staff_org` AS `s`
WHERE `s`.`staff_id` = @__staff_StaffId_0
LIMIT 1
2019-07-17 11:43:11.410 +12:00 [WRN] The Include operation for navigation '[s].CourseInstance' is unnecessary and was ignored because the navigation is not reachable in the final query results. See https://go.microsoft.com/fwlink/?linkid=850303 for more information.
2019-07-17 11:43:11.411 +12:00 [WRN] The Include operation for navigation '[s].Learner' is unnecessary and was ignored because the navigation is not reachable in the final query results. See https://go.microsoft.com/fwlink/?linkid=850303 for more information.
2019-07-17 11:43:11.411 +12:00 [WRN] The Include operation for navigation '[s].Teacher' is unnecessary and was ignored because the navigation is not reachable in the final query results. See https://go.microsoft.com/fwlink/?linkid=850303 for more information.
2019-07-17 11:43:11.411 +12:00 [WRN] The Include operation for navigation '[s].Room' is unnecessary and was ignored because the navigation is not reachable in the final query results. See https://go.microsoft.com/fwlink/?linkid=850303 for more information.
2019-07-17 11:43:11.411 +12:00 [WRN] The Include operation for navigation '[s].Org' is unnecessary and was ignored because the navigation is not reachable in the final query results. See https://go.microsoft.com/fwlink/?linkid=850303 for more information.
2019-07-17 11:43:11.411 +12:00 [WRN] The Include operation for navigation '[s].TrialCourse' is unnecessary and was ignored because the navigation is not reachable in the final query results. See https://go.microsoft.com/fwlink/?linkid=850303 for more information.
2019-07-17 11:43:11.411 +12:00 [WRN] The Include operation for navigation '[s].GroupCourseInstance.LearnerGroupCourse.Learner' is unnecessary and was ignored because the navigation is not reachable in the final query results. See https://go.microsoft.com/fwlink/?linkid=850303 for more information.
2019-07-17 11:43:11.411 +12:00 [WRN] The Include operation for navigation '[s].AwaitMakeUpLessonNewLesson' is unnecessary and was ignored because the navigation is not reachable in the final query results. See https://go.microsoft.com/fwlink/?linkid=850303 for more information.
2019-07-17 11:43:11.482 +12:00 [WRN] The LINQ expression 'where ((((Convert(Convert([s].OrgId, Int32), Nullable`1) == Convert(__orgId_0, Nullable`1)) AndAlso (Convert([s].BeginTime, DateTime).Year == __8__locals1_date_Year_1)) AndAlso (Convert([s].BeginTime, DateTime).Month == __8__locals1_date_Month_2)) AndAlso (Convert([s].BeginTime, DateTime).Day == __8__locals1_date_Day_3))' could not be translated and will be evaluated locally.
2019-07-17 11:43:11.846 +12:00 [INF] Executed DbCommand (122ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT `s.CourseInstance`.`course_instance_id`, `s.CourseInstance`.`begin_date`, `s.CourseInstance`.`course_id`, `s.CourseInstance`.`end_date`, `s.CourseInstance`.`invoice_date`, `s.CourseInstance`.`learner_id`, `s.CourseInstance`.`org_id`, `s.CourseInstance`.`room_id`, `s.CourseInstance`.`teacher_id`, `s.GroupCourseInstance`.`group_course_instance_id`, `s.GroupCourseInstance`.`begin_date`, `s.GroupCourseInstance`.`course_id`, `s.GroupCourseInstance`.`end_date`, `s.GroupCourseInstance`.`invoice_date`, `s.GroupCourseInstance`.`is_activate`, `s.GroupCourseInstance`.`is_started`, `s.GroupCourseInstance`.`org_id`, `s.GroupCourseInstance`.`room_id`, `s.GroupCourseInstance`.`teacher_id`, `s`.`org_id` AS `OrgId`, `s`.`begin_time` AS `start`, `s`.`lesson_id` AS `id`, `s`.`room_id` AS `resourceId`, `s`.`end_time` AS `end`, `s.Teacher`.`first_name` AS `TeacherFirstName0`, `s`.`is_canceled` AS `IsCanceled`, `s`.`is_confirm` AS `IsConfirm`, `s`.`is_changed` AS `IsChanged`, (
    SELECT `z`.`first_name`
    FROM `ablemusic`.`teacher` AS `z`
    WHERE `z`.`teacher_id` = (
        SELECT `r`.`teacher_id`
        FROM `ablemusic`.`lesson` AS `r`
        WHERE `r`.`lesson_id` = `s`.`new_lesson_id`
        LIMIT 1
    )
    LIMIT 1
) AS `TeacherFirstName`, (
    SELECT `z0`.`last_name`
    FROM `ablemusic`.`teacher` AS `z0`
    WHERE `z0`.`teacher_id` = (
        SELECT `r0`.`teacher_id`
        FROM `ablemusic`.`lesson` AS `r0`
        WHERE `r0`.`lesson_id` = `s`.`new_lesson_id`
        LIMIT 1
    )
    LIMIT 1
) AS `TeacherLastName`, (
    SELECT `z1`.`room_name`
    FROM `ablemusic`.`room` AS `z1`
    WHERE `z1`.`room_id` = (
        SELECT `r1`.`room_id`
        FROM `ablemusic`.`lesson` AS `r1`
        WHERE `r1`.`lesson_id` = `s`.`new_lesson_id`
        LIMIT 1
    )
    LIMIT 1
) AS `RoomName`, (
    SELECT `z2`.`org_name`
    FROM `ablemusic`.`org` AS `z2`
    WHERE `z2`.`org_id` = (
        SELECT `r2`.`org_id`
        FROM `ablemusic`.`lesson` AS `r2`
        WHERE `r2`.`lesson_id` = `s`.`new_lesson_id`
        LIMIT 1
    )
    LIMIT 1
) AS `OrgName`, (
    SELECT `r3`.`begin_time`
    FROM `ablemusic`.`lesson` AS `r3`
    WHERE `r3`.`lesson_id` = `s`.`new_lesson_id`
    LIMIT 1
) AS `BeginTime`, `s`.`reason`, CASE
    WHEN `s`.`is_paid` = 1
    THEN 0 ELSE 1
END, CASE
    WHEN (
        SELECT `q1`.`quantity`
        FROM `ablemusic`.`lesson_remain` AS `q1`
        WHERE ((`q1`.`learner_id` = `s`.`learner_id`) OR (`q1`.`learner_id` IS NULL AND `s`.`learner_id` IS NULL)) AND ((`q1`.`course_instance_id` = `s`.`course_instance_id`) OR (`q1`.`course_instance_id` IS NULL AND `s`.`course_instance_id` IS NULL))
        LIMIT 1
    ) <= 3
    THEN 1 ELSE 0
END, `s.Learner`.`first_name` AS `FirstName`, `s`.`learner_id` AS `LearnerId`, `s.Room`.`room_name` AS `RoomName0`, `s.Org`.`org_name` AS `OrgName0`, `s`.`teacher_id` AS `TeacherId`, `s.GroupCourseInstance.Course`.`course_name`, `s.TrialCourse`.`course_name`, `s.CourseInstance.Course`.`course_name`, `s.GroupCourseInstance.Course`.`course_id`, `s`.`trial_course_id`, `s.CourseInstance.Course`.`course_id`, `s`.`learner_id` AS `LearnerId0`
FROM `ablemusic`.`lesson` AS `s`
LEFT JOIN `ablemusic`.`course` AS `s.TrialCourse` ON `s`.`trial_course_id` = `s.TrialCourse`.`course_id`
INNER JOIN `ablemusic`.`org` AS `s.Org` ON `s`.`org_id` = `s.Org`.`org_id`
LEFT JOIN `ablemusic`.`room` AS `s.Room` ON `s`.`room_id` = `s.Room`.`room_id`
LEFT JOIN `ablemusic`.`learner` AS `s.Learner` ON `s`.`learner_id` = `s.Learner`.`learner_id`
LEFT JOIN `ablemusic`.`teacher` AS `s.Teacher` ON `s`.`teacher_id` = `s.Teacher`.`teacher_id`
LEFT JOIN `ablemusic`.`one2one_course_instance` AS `s.CourseInstance` ON `s`.`course_instance_id` = `s.CourseInstance`.`course_instance_id`
LEFT JOIN `ablemusic`.`course` AS `s.CourseInstance.Course` ON `s.CourseInstance`.`course_id` = `s.CourseInstance.Course`.`course_id`
LEFT JOIN `ablemusic`.`group_course_instance` AS `s.GroupCourseInstance` ON `s`.`group_course_instance_id` = `s.GroupCourseInstance`.`group_course_instance_id`
LEFT JOIN `ablemusic`.`course` AS `s.GroupCourseInstance.Course` ON `s.GroupCourseInstance`.`course_id` = `s.GroupCourseInstance.Course`.`course_id`
2019-07-17 11:43:12.041 +12:00 [INF] Executed action method Pegasus_backend.Controllers.LessonController.GetLessonsForReceptionist (Pegasus_backend), returned result Microsoft.AspNetCore.Mvc.OkObjectResult in 1077.8482000000001ms.
2019-07-17 11:43:12.041 +12:00 [INF] Executing ObjectResult, writing value of type 'Pegasus_backend.Models.Result`1[[System.Object, System.Private.CoreLib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2019-07-17 11:43:12.076 +12:00 [INF] Executed action Pegasus_backend.Controllers.LessonController.GetLessonsForReceptionist (Pegasus_backend) in 1139.9381ms
2019-07-17 11:43:12.076 +12:00 [INF] Request finished in 1169.5432ms 200 application/json; charset=utf-8
2019-07-17 11:43:14.720 +12:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5000/api/lesson/GetLessonsForReceptionist/3/2019-07-18  
2019-07-17 11:43:14.720 +12:00 [INF] Policy execution successful.
2019-07-17 11:43:14.720 +12:00 [INF] Request finished in 0.4331ms 204 
2019-07-17 11:43:14.734 +12:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/api/lesson/GetLessonsForReceptionist/3/2019-07-18  
2019-07-17 11:43:14.735 +12:00 [INF] Policy execution successful.
2019-07-17 11:43:14.735 +12:00 [INF] Successfully validated the token.
2019-07-17 11:43:14.735 +12:00 [INF] Route matched with {action = "GetLessonsForReceptionist", controller = "Lesson"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetLessonsForReceptionist(Int32, System.DateTime) on controller Pegasus_backend.Controllers.LessonController (Pegasus_backend).
2019-07-17 11:43:14.736 +12:00 [INF] Executing action method Pegasus_backend.Controllers.LessonController.GetLessonsForReceptionist (Pegasus_backend) - Validation state: "Valid"
2019-07-17 11:43:14.737 +12:00 [INF] Entity Framework Core 2.1.11-servicing-32099 initialized 'ablemusicContext' using provider 'MySql.Data.EntityFrameworkCore' with options: None
2019-07-17 11:43:14.908 +12:00 [INF] Executed DbCommand (54ms) [Parameters=[@__8__locals1_userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT `s`.`staff_id`, `s`.`dob`, `s`.`email`, `s`.`expiry_date`, `s`.`first_name`, `s`.`gender`, `s`.`home_phone`, `s`.`id_number`, `s`.`id_photo`, `s`.`id_type`, `s`.`ird_number`, `s`.`is_activate`, `s`.`last_name`, `s`.`mobile_phone`, `s`.`photo`, `s`.`user_id`, `s`.`visa`
FROM `ablemusic`.`staff` AS `s`
WHERE `s`.`user_id` = @__8__locals1_userId_0
LIMIT 1
2019-07-17 11:43:15.077 +12:00 [INF] Executed DbCommand (52ms) [Parameters=[@__staff_StaffId_0='?' (DbType = Int16)], CommandType='"Text"', CommandTimeout='30']
SELECT `s`.`staff_org_id`, `s`.`is_activate`, `s`.`org_id`, `s`.`staff_id`
FROM `ablemusic`.`staff_org` AS `s`
WHERE `s`.`staff_id` = @__staff_StaffId_0
LIMIT 1
2019-07-17 11:43:15.102 +12:00 [WRN] The Include operation for navigation '[s].CourseInstance' is unnecessary and was ignored because the navigation is not reachable in the final query results. See https://go.microsoft.com/fwlink/?linkid=850303 for more information.
2019-07-17 11:43:15.102 +12:00 [WRN] The Include operation for navigation '[s].Learner' is unnecessary and was ignored because the navigation is not reachable in the final query results. See https://go.microsoft.com/fwlink/?linkid=850303 for more information.
2019-07-17 11:43:15.102 +12:00 [WRN] The Include operation for navigation '[s].Teacher' is unnecessary and was ignored because the navigation is not reachable in the final query results. See https://go.microsoft.com/fwlink/?linkid=850303 for more information.
2019-07-17 11:43:15.103 +12:00 [WRN] The Include operation for navigation '[s].Room' is unnecessary and was ignored because the navigation is not reachable in the final query results. See https://go.microsoft.com/fwlink/?linkid=850303 for more information.
2019-07-17 11:43:15.103 +12:00 [WRN] The Include operation for navigation '[s].Org' is unnecessary and was ignored because the navigation is not reachable in the final query results. See https://go.microsoft.com/fwlink/?linkid=850303 for more information.
2019-07-17 11:43:15.103 +12:00 [WRN] The Include operation for navigation '[s].TrialCourse' is unnecessary and was ignored because the navigation is not reachable in the final query results. See https://go.microsoft.com/fwlink/?linkid=850303 for more information.
2019-07-17 11:43:15.103 +12:00 [WRN] The Include operation for navigation '[s].GroupCourseInstance.LearnerGroupCourse.Learner' is unnecessary and was ignored because the navigation is not reachable in the final query results. See https://go.microsoft.com/fwlink/?linkid=850303 for more information.
2019-07-17 11:43:15.103 +12:00 [WRN] The Include operation for navigation '[s].AwaitMakeUpLessonNewLesson' is unnecessary and was ignored because the navigation is not reachable in the final query results. See https://go.microsoft.com/fwlink/?linkid=850303 for more information.
2019-07-17 11:43:15.138 +12:00 [WRN] The LINQ expression 'where ((((Convert(Convert([s].OrgId, Int32), Nullable`1) == Convert(__orgId_0, Nullable`1)) AndAlso (Convert([s].BeginTime, DateTime).Year == __8__locals1_date_Year_1)) AndAlso (Convert([s].BeginTime, DateTime).Month == __8__locals1_date_Month_2)) AndAlso (Convert([s].BeginTime, DateTime).Day == __8__locals1_date_Day_3))' could not be translated and will be evaluated locally.
2019-07-17 11:43:15.418 +12:00 [INF] Executed DbCommand (111ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT `s.CourseInstance`.`course_instance_id`, `s.CourseInstance`.`begin_date`, `s.CourseInstance`.`course_id`, `s.CourseInstance`.`end_date`, `s.CourseInstance`.`invoice_date`, `s.CourseInstance`.`learner_id`, `s.CourseInstance`.`org_id`, `s.CourseInstance`.`room_id`, `s.CourseInstance`.`teacher_id`, `s.GroupCourseInstance`.`group_course_instance_id`, `s.GroupCourseInstance`.`begin_date`, `s.GroupCourseInstance`.`course_id`, `s.GroupCourseInstance`.`end_date`, `s.GroupCourseInstance`.`invoice_date`, `s.GroupCourseInstance`.`is_activate`, `s.GroupCourseInstance`.`is_started`, `s.GroupCourseInstance`.`org_id`, `s.GroupCourseInstance`.`room_id`, `s.GroupCourseInstance`.`teacher_id`, `s`.`org_id` AS `OrgId`, `s`.`begin_time` AS `start`, `s`.`lesson_id` AS `id`, `s`.`room_id` AS `resourceId`, `s`.`end_time` AS `end`, `s.Teacher`.`first_name` AS `TeacherFirstName0`, `s`.`is_canceled` AS `IsCanceled`, `s`.`is_confirm` AS `IsConfirm`, `s`.`is_changed` AS `IsChanged`, (
    SELECT `z`.`first_name`
    FROM `ablemusic`.`teacher` AS `z`
    WHERE `z`.`teacher_id` = (
        SELECT `r`.`teacher_id`
        FROM `ablemusic`.`lesson` AS `r`
        WHERE `r`.`lesson_id` = `s`.`new_lesson_id`
        LIMIT 1
    )
    LIMIT 1
) AS `TeacherFirstName`, (
    SELECT `z0`.`last_name`
    FROM `ablemusic`.`teacher` AS `z0`
    WHERE `z0`.`teacher_id` = (
        SELECT `r0`.`teacher_id`
        FROM `ablemusic`.`lesson` AS `r0`
        WHERE `r0`.`lesson_id` = `s`.`new_lesson_id`
        LIMIT 1
    )
    LIMIT 1
) AS `TeacherLastName`, (
    SELECT `z1`.`room_name`
    FROM `ablemusic`.`room` AS `z1`
    WHERE `z1`.`room_id` = (
        SELECT `r1`.`room_id`
        FROM `ablemusic`.`lesson` AS `r1`
        WHERE `r1`.`lesson_id` = `s`.`new_lesson_id`
        LIMIT 1
    )
    LIMIT 1
) AS `RoomName`, (
    SELECT `z2`.`org_name`
    FROM `ablemusic`.`org` AS `z2`
    WHERE `z2`.`org_id` = (
        SELECT `r2`.`org_id`
        FROM `ablemusic`.`lesson` AS `r2`
        WHERE `r2`.`lesson_id` = `s`.`new_lesson_id`
        LIMIT 1
    )
    LIMIT 1
) AS `OrgName`, (
    SELECT `r3`.`begin_time`
    FROM `ablemusic`.`lesson` AS `r3`
    WHERE `r3`.`lesson_id` = `s`.`new_lesson_id`
    LIMIT 1
) AS `BeginTime`, `s`.`reason`, CASE
    WHEN `s`.`is_paid` = 1
    THEN 0 ELSE 1
END, CASE
    WHEN (
        SELECT `q1`.`quantity`
        FROM `ablemusic`.`lesson_remain` AS `q1`
        WHERE ((`q1`.`learner_id` = `s`.`learner_id`) OR (`q1`.`learner_id` IS NULL AND `s`.`learner_id` IS NULL)) AND ((`q1`.`course_instance_id` = `s`.`course_instance_id`) OR (`q1`.`course_instance_id` IS NULL AND `s`.`course_instance_id` IS NULL))
        LIMIT 1
    ) <= 3
    THEN 1 ELSE 0
END, `s.Learner`.`first_name` AS `FirstName`, `s`.`learner_id` AS `LearnerId`, `s.Room`.`room_name` AS `RoomName0`, `s.Org`.`org_name` AS `OrgName0`, `s`.`teacher_id` AS `TeacherId`, `s.GroupCourseInstance.Course`.`course_name`, `s.TrialCourse`.`course_name`, `s.CourseInstance.Course`.`course_name`, `s.GroupCourseInstance.Course`.`course_id`, `s`.`trial_course_id`, `s.CourseInstance.Course`.`course_id`, `s`.`learner_id` AS `LearnerId0`
FROM `ablemusic`.`lesson` AS `s`
LEFT JOIN `ablemusic`.`course` AS `s.TrialCourse` ON `s`.`trial_course_id` = `s.TrialCourse`.`course_id`
INNER JOIN `ablemusic`.`org` AS `s.Org` ON `s`.`org_id` = `s.Org`.`org_id`
LEFT JOIN `ablemusic`.`room` AS `s.Room` ON `s`.`room_id` = `s.Room`.`room_id`
LEFT JOIN `ablemusic`.`learner` AS `s.Learner` ON `s`.`learner_id` = `s.Learner`.`learner_id`
LEFT JOIN `ablemusic`.`teacher` AS `s.Teacher` ON `s`.`teacher_id` = `s.Teacher`.`teacher_id`
LEFT JOIN `ablemusic`.`one2one_course_instance` AS `s.CourseInstance` ON `s`.`course_instance_id` = `s.CourseInstance`.`course_instance_id`
LEFT JOIN `ablemusic`.`course` AS `s.CourseInstance.Course` ON `s.CourseInstance`.`course_id` = `s.CourseInstance.Course`.`course_id`
LEFT JOIN `ablemusic`.`group_course_instance` AS `s.GroupCourseInstance` ON `s`.`group_course_instance_id` = `s.GroupCourseInstance`.`group_course_instance_id`
LEFT JOIN `ablemusic`.`course` AS `s.GroupCourseInstance.Course` ON `s.GroupCourseInstance`.`course_id` = `s.GroupCourseInstance.Course`.`course_id`
2019-07-17 11:43:15.581 +12:00 [INF] Executed action method Pegasus_backend.Controllers.LessonController.GetLessonsForReceptionist (Pegasus_backend), returned result Microsoft.AspNetCore.Mvc.OkObjectResult in 845.03730000000007ms.
2019-07-17 11:43:15.581 +12:00 [INF] Executing ObjectResult, writing value of type 'Pegasus_backend.Models.Result`1[[System.Object, System.Private.CoreLib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2019-07-17 11:43:15.582 +12:00 [INF] Executed action Pegasus_backend.Controllers.LessonController.GetLessonsForReceptionist (Pegasus_backend) in 846.378ms
2019-07-17 11:43:15.582 +12:00 [INF] Request finished in 847.465ms 200 application/json; charset=utf-8
2019-07-17 11:43:16.541 +12:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5000/api/lesson/GetLessonsForReceptionist/3/2019-07-19  
2019-07-17 11:43:16.541 +12:00 [INF] Policy execution successful.
2019-07-17 11:43:16.541 +12:00 [INF] Request finished in 0.3664ms 204 
2019-07-17 11:43:16.550 +12:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/api/lesson/GetLessonsForReceptionist/3/2019-07-19  
2019-07-17 11:43:16.550 +12:00 [INF] Policy execution successful.
2019-07-17 11:43:16.551 +12:00 [INF] Successfully validated the token.
2019-07-17 11:43:16.551 +12:00 [INF] Route matched with {action = "GetLessonsForReceptionist", controller = "Lesson"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetLessonsForReceptionist(Int32, System.DateTime) on controller Pegasus_backend.Controllers.LessonController (Pegasus_backend).
2019-07-17 11:43:16.551 +12:00 [INF] Executing action method Pegasus_backend.Controllers.LessonController.GetLessonsForReceptionist (Pegasus_backend) - Validation state: "Valid"
2019-07-17 11:43:16.552 +12:00 [INF] Entity Framework Core 2.1.11-servicing-32099 initialized 'ablemusicContext' using provider 'MySql.Data.EntityFrameworkCore' with options: None
2019-07-17 11:43:16.726 +12:00 [INF] Executed DbCommand (53ms) [Parameters=[@__8__locals1_userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT `s`.`staff_id`, `s`.`dob`, `s`.`email`, `s`.`expiry_date`, `s`.`first_name`, `s`.`gender`, `s`.`home_phone`, `s`.`id_number`, `s`.`id_photo`, `s`.`id_type`, `s`.`ird_number`, `s`.`is_activate`, `s`.`last_name`, `s`.`mobile_phone`, `s`.`photo`, `s`.`user_id`, `s`.`visa`
FROM `ablemusic`.`staff` AS `s`
WHERE `s`.`user_id` = @__8__locals1_userId_0
LIMIT 1
2019-07-17 11:43:16.892 +12:00 [INF] Executed DbCommand (50ms) [Parameters=[@__staff_StaffId_0='?' (DbType = Int16)], CommandType='"Text"', CommandTimeout='30']
SELECT `s`.`staff_org_id`, `s`.`is_activate`, `s`.`org_id`, `s`.`staff_id`
FROM `ablemusic`.`staff_org` AS `s`
WHERE `s`.`staff_id` = @__staff_StaffId_0
LIMIT 1
2019-07-17 11:43:16.930 +12:00 [WRN] The Include operation for navigation '[s].CourseInstance' is unnecessary and was ignored because the navigation is not reachable in the final query results. See https://go.microsoft.com/fwlink/?linkid=850303 for more information.
2019-07-17 11:43:16.930 +12:00 [WRN] The Include operation for navigation '[s].Learner' is unnecessary and was ignored because the navigation is not reachable in the final query results. See https://go.microsoft.com/fwlink/?linkid=850303 for more information.
2019-07-17 11:43:16.930 +12:00 [WRN] The Include operation for navigation '[s].Teacher' is unnecessary and was ignored because the navigation is not reachable in the final query results. See https://go.microsoft.com/fwlink/?linkid=850303 for more information.
2019-07-17 11:43:16.930 +12:00 [WRN] The Include operation for navigation '[s].Room' is unnecessary and was ignored because the navigation is not reachable in the final query results. See https://go.microsoft.com/fwlink/?linkid=850303 for more information.
2019-07-17 11:43:16.930 +12:00 [WRN] The Include operation for navigation '[s].Org' is unnecessary and was ignored because the navigation is not reachable in the final query results. See https://go.microsoft.com/fwlink/?linkid=850303 for more information.
2019-07-17 11:43:16.930 +12:00 [WRN] The Include operation for navigation '[s].TrialCourse' is unnecessary and was ignored because the navigation is not reachable in the final query results. See https://go.microsoft.com/fwlink/?linkid=850303 for more information.
2019-07-17 11:43:16.930 +12:00 [WRN] The Include operation for navigation '[s].GroupCourseInstance.LearnerGroupCourse.Learner' is unnecessary and was ignored because the navigation is not reachable in the final query results. See https://go.microsoft.com/fwlink/?linkid=850303 for more information.
2019-07-17 11:43:16.930 +12:00 [WRN] The Include operation for navigation '[s].AwaitMakeUpLessonNewLesson' is unnecessary and was ignored because the navigation is not reachable in the final query results. See https://go.microsoft.com/fwlink/?linkid=850303 for more information.
2019-07-17 11:43:16.959 +12:00 [WRN] The LINQ expression 'where ((((Convert(Convert([s].OrgId, Int32), Nullable`1) == Convert(__orgId_0, Nullable`1)) AndAlso (Convert([s].BeginTime, DateTime).Year == __8__locals1_date_Year_1)) AndAlso (Convert([s].BeginTime, DateTime).Month == __8__locals1_date_Month_2)) AndAlso (Convert([s].BeginTime, DateTime).Day == __8__locals1_date_Day_3))' could not be translated and will be evaluated locally.
2019-07-17 11:43:17.223 +12:00 [INF] Executed DbCommand (97ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT `s.CourseInstance`.`course_instance_id`, `s.CourseInstance`.`begin_date`, `s.CourseInstance`.`course_id`, `s.CourseInstance`.`end_date`, `s.CourseInstance`.`invoice_date`, `s.CourseInstance`.`learner_id`, `s.CourseInstance`.`org_id`, `s.CourseInstance`.`room_id`, `s.CourseInstance`.`teacher_id`, `s.GroupCourseInstance`.`group_course_instance_id`, `s.GroupCourseInstance`.`begin_date`, `s.GroupCourseInstance`.`course_id`, `s.GroupCourseInstance`.`end_date`, `s.GroupCourseInstance`.`invoice_date`, `s.GroupCourseInstance`.`is_activate`, `s.GroupCourseInstance`.`is_started`, `s.GroupCourseInstance`.`org_id`, `s.GroupCourseInstance`.`room_id`, `s.GroupCourseInstance`.`teacher_id`, `s`.`org_id` AS `OrgId`, `s`.`begin_time` AS `start`, `s`.`lesson_id` AS `id`, `s`.`room_id` AS `resourceId`, `s`.`end_time` AS `end`, `s.Teacher`.`first_name` AS `TeacherFirstName0`, `s`.`is_canceled` AS `IsCanceled`, `s`.`is_confirm` AS `IsConfirm`, `s`.`is_changed` AS `IsChanged`, (
    SELECT `z`.`first_name`
    FROM `ablemusic`.`teacher` AS `z`
    WHERE `z`.`teacher_id` = (
        SELECT `r`.`teacher_id`
        FROM `ablemusic`.`lesson` AS `r`
        WHERE `r`.`lesson_id` = `s`.`new_lesson_id`
        LIMIT 1
    )
    LIMIT 1
) AS `TeacherFirstName`, (
    SELECT `z0`.`last_name`
    FROM `ablemusic`.`teacher` AS `z0`
    WHERE `z0`.`teacher_id` = (
        SELECT `r0`.`teacher_id`
        FROM `ablemusic`.`lesson` AS `r0`
        WHERE `r0`.`lesson_id` = `s`.`new_lesson_id`
        LIMIT 1
    )
    LIMIT 1
) AS `TeacherLastName`, (
    SELECT `z1`.`room_name`
    FROM `ablemusic`.`room` AS `z1`
    WHERE `z1`.`room_id` = (
        SELECT `r1`.`room_id`
        FROM `ablemusic`.`lesson` AS `r1`
        WHERE `r1`.`lesson_id` = `s`.`new_lesson_id`
        LIMIT 1
    )
    LIMIT 1
) AS `RoomName`, (
    SELECT `z2`.`org_name`
    FROM `ablemusic`.`org` AS `z2`
    WHERE `z2`.`org_id` = (
        SELECT `r2`.`org_id`
        FROM `ablemusic`.`lesson` AS `r2`
        WHERE `r2`.`lesson_id` = `s`.`new_lesson_id`
        LIMIT 1
    )
    LIMIT 1
) AS `OrgName`, (
    SELECT `r3`.`begin_time`
    FROM `ablemusic`.`lesson` AS `r3`
    WHERE `r3`.`lesson_id` = `s`.`new_lesson_id`
    LIMIT 1
) AS `BeginTime`, `s`.`reason`, CASE
    WHEN `s`.`is_paid` = 1
    THEN 0 ELSE 1
END, CASE
    WHEN (
        SELECT `q1`.`quantity`
        FROM `ablemusic`.`lesson_remain` AS `q1`
        WHERE ((`q1`.`learner_id` = `s`.`learner_id`) OR (`q1`.`learner_id` IS NULL AND `s`.`learner_id` IS NULL)) AND ((`q1`.`course_instance_id` = `s`.`course_instance_id`) OR (`q1`.`course_instance_id` IS NULL AND `s`.`course_instance_id` IS NULL))
        LIMIT 1
    ) <= 3
    THEN 1 ELSE 0
END, `s.Learner`.`first_name` AS `FirstName`, `s`.`learner_id` AS `LearnerId`, `s.Room`.`room_name` AS `RoomName0`, `s.Org`.`org_name` AS `OrgName0`, `s`.`teacher_id` AS `TeacherId`, `s.GroupCourseInstance.Course`.`course_name`, `s.TrialCourse`.`course_name`, `s.CourseInstance.Course`.`course_name`, `s.GroupCourseInstance.Course`.`course_id`, `s`.`trial_course_id`, `s.CourseInstance.Course`.`course_id`, `s`.`learner_id` AS `LearnerId0`
FROM `ablemusic`.`lesson` AS `s`
LEFT JOIN `ablemusic`.`course` AS `s.TrialCourse` ON `s`.`trial_course_id` = `s.TrialCourse`.`course_id`
INNER JOIN `ablemusic`.`org` AS `s.Org` ON `s`.`org_id` = `s.Org`.`org_id`
LEFT JOIN `ablemusic`.`room` AS `s.Room` ON `s`.`room_id` = `s.Room`.`room_id`
LEFT JOIN `ablemusic`.`learner` AS `s.Learner` ON `s`.`learner_id` = `s.Learner`.`learner_id`
LEFT JOIN `ablemusic`.`teacher` AS `s.Teacher` ON `s`.`teacher_id` = `s.Teacher`.`teacher_id`
LEFT JOIN `ablemusic`.`one2one_course_instance` AS `s.CourseInstance` ON `s`.`course_instance_id` = `s.CourseInstance`.`course_instance_id`
LEFT JOIN `ablemusic`.`course` AS `s.CourseInstance.Course` ON `s.CourseInstance`.`course_id` = `s.CourseInstance.Course`.`course_id`
LEFT JOIN `ablemusic`.`group_course_instance` AS `s.GroupCourseInstance` ON `s`.`group_course_instance_id` = `s.GroupCourseInstance`.`group_course_instance_id`
LEFT JOIN `ablemusic`.`course` AS `s.GroupCourseInstance.Course` ON `s.GroupCourseInstance`.`course_id` = `s.GroupCourseInstance.Course`.`course_id`
2019-07-17 11:43:17.374 +12:00 [INF] Executed action method Pegasus_backend.Controllers.LessonController.GetLessonsForReceptionist (Pegasus_backend), returned result Microsoft.AspNetCore.Mvc.OkObjectResult in 822.6173ms.
2019-07-17 11:43:17.374 +12:00 [INF] Executing ObjectResult, writing value of type 'Pegasus_backend.Models.Result`1[[System.Object, System.Private.CoreLib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2019-07-17 11:43:17.375 +12:00 [INF] Executed action Pegasus_backend.Controllers.LessonController.GetLessonsForReceptionist (Pegasus_backend) in 823.4773ms
2019-07-17 11:43:17.375 +12:00 [INF] Request finished in 824.6593ms 200 application/json; charset=utf-8
2019-07-17 11:43:21.239 +12:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5000/api/lesson/GetLessonsForReceptionist/3/2019-07-20  
2019-07-17 11:43:21.239 +12:00 [INF] Policy execution successful.
2019-07-17 11:43:21.240 +12:00 [INF] Request finished in 0.3972ms 204 
2019-07-17 11:43:21.249 +12:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/api/lesson/GetLessonsForReceptionist/3/2019-07-20  
2019-07-17 11:43:21.249 +12:00 [INF] Policy execution successful.
2019-07-17 11:43:21.249 +12:00 [INF] Successfully validated the token.
2019-07-17 11:43:21.249 +12:00 [INF] Route matched with {action = "GetLessonsForReceptionist", controller = "Lesson"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetLessonsForReceptionist(Int32, System.DateTime) on controller Pegasus_backend.Controllers.LessonController (Pegasus_backend).
2019-07-17 11:43:21.250 +12:00 [INF] Executing action method Pegasus_backend.Controllers.LessonController.GetLessonsForReceptionist (Pegasus_backend) - Validation state: "Valid"
2019-07-17 11:43:21.250 +12:00 [INF] Entity Framework Core 2.1.11-servicing-32099 initialized 'ablemusicContext' using provider 'MySql.Data.EntityFrameworkCore' with options: None
2019-07-17 11:43:21.434 +12:00 [INF] Executed DbCommand (57ms) [Parameters=[@__8__locals1_userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT `s`.`staff_id`, `s`.`dob`, `s`.`email`, `s`.`expiry_date`, `s`.`first_name`, `s`.`gender`, `s`.`home_phone`, `s`.`id_number`, `s`.`id_photo`, `s`.`id_type`, `s`.`ird_number`, `s`.`is_activate`, `s`.`last_name`, `s`.`mobile_phone`, `s`.`photo`, `s`.`user_id`, `s`.`visa`
FROM `ablemusic`.`staff` AS `s`
WHERE `s`.`user_id` = @__8__locals1_userId_0
LIMIT 1
2019-07-17 11:43:21.621 +12:00 [INF] Executed DbCommand (51ms) [Parameters=[@__staff_StaffId_0='?' (DbType = Int16)], CommandType='"Text"', CommandTimeout='30']
SELECT `s`.`staff_org_id`, `s`.`is_activate`, `s`.`org_id`, `s`.`staff_id`
FROM `ablemusic`.`staff_org` AS `s`
WHERE `s`.`staff_id` = @__staff_StaffId_0
LIMIT 1
2019-07-17 11:43:21.666 +12:00 [WRN] The Include operation for navigation '[s].CourseInstance' is unnecessary and was ignored because the navigation is not reachable in the final query results. See https://go.microsoft.com/fwlink/?linkid=850303 for more information.
2019-07-17 11:43:21.666 +12:00 [WRN] The Include operation for navigation '[s].Learner' is unnecessary and was ignored because the navigation is not reachable in the final query results. See https://go.microsoft.com/fwlink/?linkid=850303 for more information.
2019-07-17 11:43:21.666 +12:00 [WRN] The Include operation for navigation '[s].Teacher' is unnecessary and was ignored because the navigation is not reachable in the final query results. See https://go.microsoft.com/fwlink/?linkid=850303 for more information.
2019-07-17 11:43:21.666 +12:00 [WRN] The Include operation for navigation '[s].Room' is unnecessary and was ignored because the navigation is not reachable in the final query results. See https://go.microsoft.com/fwlink/?linkid=850303 for more information.
2019-07-17 11:43:21.666 +12:00 [WRN] The Include operation for navigation '[s].Org' is unnecessary and was ignored because the navigation is not reachable in the final query results. See https://go.microsoft.com/fwlink/?linkid=850303 for more information.
2019-07-17 11:43:21.666 +12:00 [WRN] The Include operation for navigation '[s].TrialCourse' is unnecessary and was ignored because the navigation is not reachable in the final query results. See https://go.microsoft.com/fwlink/?linkid=850303 for more information.
2019-07-17 11:43:21.666 +12:00 [WRN] The Include operation for navigation '[s].GroupCourseInstance.LearnerGroupCourse.Learner' is unnecessary and was ignored because the navigation is not reachable in the final query results. See https://go.microsoft.com/fwlink/?linkid=850303 for more information.
2019-07-17 11:43:21.666 +12:00 [WRN] The Include operation for navigation '[s].AwaitMakeUpLessonNewLesson' is unnecessary and was ignored because the navigation is not reachable in the final query results. See https://go.microsoft.com/fwlink/?linkid=850303 for more information.
2019-07-17 11:43:21.695 +12:00 [WRN] The LINQ expression 'where ((((Convert(Convert([s].OrgId, Int32), Nullable`1) == Convert(__orgId_0, Nullable`1)) AndAlso (Convert([s].BeginTime, DateTime).Year == __8__locals1_date_Year_1)) AndAlso (Convert([s].BeginTime, DateTime).Month == __8__locals1_date_Month_2)) AndAlso (Convert([s].BeginTime, DateTime).Day == __8__locals1_date_Day_3))' could not be translated and will be evaluated locally.
2019-07-17 11:43:21.996 +12:00 [INF] Executed DbCommand (120ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT `s.CourseInstance`.`course_instance_id`, `s.CourseInstance`.`begin_date`, `s.CourseInstance`.`course_id`, `s.CourseInstance`.`end_date`, `s.CourseInstance`.`invoice_date`, `s.CourseInstance`.`learner_id`, `s.CourseInstance`.`org_id`, `s.CourseInstance`.`room_id`, `s.CourseInstance`.`teacher_id`, `s.GroupCourseInstance`.`group_course_instance_id`, `s.GroupCourseInstance`.`begin_date`, `s.GroupCourseInstance`.`course_id`, `s.GroupCourseInstance`.`end_date`, `s.GroupCourseInstance`.`invoice_date`, `s.GroupCourseInstance`.`is_activate`, `s.GroupCourseInstance`.`is_started`, `s.GroupCourseInstance`.`org_id`, `s.GroupCourseInstance`.`room_id`, `s.GroupCourseInstance`.`teacher_id`, `s`.`org_id` AS `OrgId`, `s`.`begin_time` AS `start`, `s`.`lesson_id` AS `id`, `s`.`room_id` AS `resourceId`, `s`.`end_time` AS `end`, `s.Teacher`.`first_name` AS `TeacherFirstName0`, `s`.`is_canceled` AS `IsCanceled`, `s`.`is_confirm` AS `IsConfirm`, `s`.`is_changed` AS `IsChanged`, (
    SELECT `z`.`first_name`
    FROM `ablemusic`.`teacher` AS `z`
    WHERE `z`.`teacher_id` = (
        SELECT `r`.`teacher_id`
        FROM `ablemusic`.`lesson` AS `r`
        WHERE `r`.`lesson_id` = `s`.`new_lesson_id`
        LIMIT 1
    )
    LIMIT 1
) AS `TeacherFirstName`, (
    SELECT `z0`.`last_name`
    FROM `ablemusic`.`teacher` AS `z0`
    WHERE `z0`.`teacher_id` = (
        SELECT `r0`.`teacher_id`
        FROM `ablemusic`.`lesson` AS `r0`
        WHERE `r0`.`lesson_id` = `s`.`new_lesson_id`
        LIMIT 1
    )
    LIMIT 1
) AS `TeacherLastName`, (
    SELECT `z1`.`room_name`
    FROM `ablemusic`.`room` AS `z1`
    WHERE `z1`.`room_id` = (
        SELECT `r1`.`room_id`
        FROM `ablemusic`.`lesson` AS `r1`
        WHERE `r1`.`lesson_id` = `s`.`new_lesson_id`
        LIMIT 1
    )
    LIMIT 1
) AS `RoomName`, (
    SELECT `z2`.`org_name`
    FROM `ablemusic`.`org` AS `z2`
    WHERE `z2`.`org_id` = (
        SELECT `r2`.`org_id`
        FROM `ablemusic`.`lesson` AS `r2`
        WHERE `r2`.`lesson_id` = `s`.`new_lesson_id`
        LIMIT 1
    )
    LIMIT 1
) AS `OrgName`, (
    SELECT `r3`.`begin_time`
    FROM `ablemusic`.`lesson` AS `r3`
    WHERE `r3`.`lesson_id` = `s`.`new_lesson_id`
    LIMIT 1
) AS `BeginTime`, `s`.`reason`, CASE
    WHEN `s`.`is_paid` = 1
    THEN 0 ELSE 1
END, CASE
    WHEN (
        SELECT `q1`.`quantity`
        FROM `ablemusic`.`lesson_remain` AS `q1`
        WHERE ((`q1`.`learner_id` = `s`.`learner_id`) OR (`q1`.`learner_id` IS NULL AND `s`.`learner_id` IS NULL)) AND ((`q1`.`course_instance_id` = `s`.`course_instance_id`) OR (`q1`.`course_instance_id` IS NULL AND `s`.`course_instance_id` IS NULL))
        LIMIT 1
    ) <= 3
    THEN 1 ELSE 0
END, `s.Learner`.`first_name` AS `FirstName`, `s`.`learner_id` AS `LearnerId`, `s.Room`.`room_name` AS `RoomName0`, `s.Org`.`org_name` AS `OrgName0`, `s`.`teacher_id` AS `TeacherId`, `s.GroupCourseInstance.Course`.`course_name`, `s.TrialCourse`.`course_name`, `s.CourseInstance.Course`.`course_name`, `s.GroupCourseInstance.Course`.`course_id`, `s`.`trial_course_id`, `s.CourseInstance.Course`.`course_id`, `s`.`learner_id` AS `LearnerId0`
FROM `ablemusic`.`lesson` AS `s`
LEFT JOIN `ablemusic`.`course` AS `s.TrialCourse` ON `s`.`trial_course_id` = `s.TrialCourse`.`course_id`
INNER JOIN `ablemusic`.`org` AS `s.Org` ON `s`.`org_id` = `s.Org`.`org_id`
LEFT JOIN `ablemusic`.`room` AS `s.Room` ON `s`.`room_id` = `s.Room`.`room_id`
LEFT JOIN `ablemusic`.`learner` AS `s.Learner` ON `s`.`learner_id` = `s.Learner`.`learner_id`
LEFT JOIN `ablemusic`.`teacher` AS `s.Teacher` ON `s`.`teacher_id` = `s.Teacher`.`teacher_id`
LEFT JOIN `ablemusic`.`one2one_course_instance` AS `s.CourseInstance` ON `s`.`course_instance_id` = `s.CourseInstance`.`course_instance_id`
LEFT JOIN `ablemusic`.`course` AS `s.CourseInstance.Course` ON `s.CourseInstance`.`course_id` = `s.CourseInstance.Course`.`course_id`
LEFT JOIN `ablemusic`.`group_course_instance` AS `s.GroupCourseInstance` ON `s`.`group_course_instance_id` = `s.GroupCourseInstance`.`group_course_instance_id`
LEFT JOIN `ablemusic`.`course` AS `s.GroupCourseInstance.Course` ON `s.GroupCourseInstance`.`course_id` = `s.GroupCourseInstance.Course`.`course_id`
2019-07-17 11:43:22.172 +12:00 [INF] Executed action method Pegasus_backend.Controllers.LessonController.GetLessonsForReceptionist (Pegasus_backend), returned result Microsoft.AspNetCore.Mvc.OkObjectResult in 922.4002ms.
2019-07-17 11:43:22.173 +12:00 [INF] Executing ObjectResult, writing value of type 'Pegasus_backend.Models.Result`1[[System.Object, System.Private.CoreLib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2019-07-17 11:43:22.173 +12:00 [INF] Executed action Pegasus_backend.Controllers.LessonController.GetLessonsForReceptionist (Pegasus_backend) in 923.3555ms
2019-07-17 11:43:22.173 +12:00 [INF] Request finished in 924.1971ms 200 application/json; charset=utf-8
2019-07-17 11:43:40.051 +12:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5000/api/LessonRearrange/3  
2019-07-17 11:43:40.052 +12:00 [INF] Policy execution successful.
2019-07-17 11:43:40.052 +12:00 [INF] Request finished in 0.3476ms 204 
2019-07-17 11:43:40.065 +12:00 [INF] Request starting HTTP/1.1 PUT http://localhost:5000/api/LessonRearrange/3 application/json 137
2019-07-17 11:43:40.066 +12:00 [INF] Policy execution successful.
2019-07-17 11:43:40.070 +12:00 [INF] Route matched with {action = "PutLesson", controller = "LessonRearrange"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] PutLesson(Int16, Pegasus_backend.Models.LessonViewModel) on controller Pegasus_backend.Controllers.LessonRearrangeController (Pegasus_backend).
2019-07-17 11:43:40.593 +12:00 [INF] Executing action method Pegasus_backend.Controllers.LessonRearrangeController.PutLesson (Pegasus_backend) - Validation state: "Valid"
2019-07-17 11:43:40.655 +12:00 [INF] Entity Framework Core 2.1.11-servicing-32099 initialized 'ablemusicContext' using provider 'MySql.Data.EntityFrameworkCore' with options: None
2019-07-17 11:43:40.855 +12:00 [INF] Executed DbCommand (57ms) [Parameters=[@__newLesson_LessonId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT `l`.`lesson_id`, `l`.`begin_time`, `l`.`course_instance_id`, `l`.`created_at`, `l`.`end_time`, `l`.`group_course_instance_id`, `l`.`invoice_id`, `l`.`is_canceled`, `l`.`is_changed`, `l`.`is_confirm`, `l`.`is_paid`, `l`.`is_trial`, `l`.`learner_id`, `l`.`new_lesson_id`, `l`.`org_id`, `l`.`reason`, `l`.`room_id`, `l`.`teacher_id`, `l`.`trial_course_id`
FROM `ablemusic`.`lesson` AS `l`
WHERE `l`.`lesson_id` = @__newLesson_LessonId_0
LIMIT 1
2019-07-17 11:43:43.526 +12:00 [INF] Executed DbCommand (57ms) [Parameters=[@__oldLesson_LearnerId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT `l`.`learner_id`, `l`.`address`, `l`.`comment`, `l`.`contact_num`, `l`.`created_at`, `l`.`dob`, `l`.`email`, `l`.`enroll_date`, `l`.`first_name`, `l`.`form_url`, `l`.`g5_certification`, `l`.`gender`, `l`.`is_abrsm_g5`, `l`.`is_active`, `l`.`is_under_18`, `l`.`last_name`, `l`.`learner_level`, `l`.`level_type`, `l`.`middle_name`, `l`.`note`, `l`.`org_id`, `l`.`otherfile_url`, `l`.`payment_period`, `l`.`photo`, `l`.`referrer`, `l`.`referrer_learner_id`, `l`.`user_id`
FROM `ablemusic`.`learner` AS `l`
WHERE `l`.`learner_id` = @__oldLesson_LearnerId_0
LIMIT 1
2019-07-17 11:43:43.801 +12:00 [INF] Executed DbCommand (55ms) [Parameters=[@__newLesson_LessonId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT `c`.`course_id` AS `CourseId`, `c`.`course_name` AS `CourseName`
FROM `ablemusic`.`course` AS `c`
INNER JOIN `ablemusic`.`one2one_course_instance` AS `oto` ON `c`.`course_id` = `oto`.`course_id`
INNER JOIN `ablemusic`.`lesson` AS `l` ON `oto`.`course_instance_id` = `l`.`course_instance_id`
WHERE `l`.`lesson_id` = @__newLesson_LessonId_0
LIMIT 1
2019-07-17 11:43:44.000 +12:00 [INF] Executed DbCommand (59ms) [Parameters=[@__newLesson_TeacherId_0='?' (DbType = Int16)], CommandType='"Text"', CommandTimeout='30']
SELECT `t`.`teacher_id`, `t`.`ability`, `t`.`comment`, `t`.`cv_url`, `t`.`dob`, `t`.`email`, `t`.`expiry_date`, `t`.`first_name`, `t`.`form_url`, `t`.`gender`, `t`.`home_phone`, `t`.`id_number`, `t`.`id_photo`, `t`.`id_type`, `t`.`invoice_template`, `t`.`ird_number`, `t`.`is_activate`, `t`.`is_contract`, `t`.`is_left`, `t`.`last_name`, `t`.`level`, `t`.`minimum_hours`, `t`.`mobile_phone`, `t`.`otherfile_url`, `t`.`photo`, `t`.`user_id`, `t`.`visa`
FROM `ablemusic`.`teacher` AS `t`
WHERE `t`.`teacher_id` = @__newLesson_TeacherId_0
LIMIT 1
2019-07-17 11:43:44.235 +12:00 [INF] Executed DbCommand (53ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT `h`.`holiday_id`, `h`.`holiday_date`, `h`.`holiday_name`
FROM `ablemusic`.`holiday` AS `h`
2019-07-17 11:43:44.430 +12:00 [INF] Executed DbCommand (52ms) [Parameters=[@__oldLesson_OrgId_0='?' (DbType = Int16)], CommandType='"Text"', CommandTimeout='30']
SELECT `o`.`org_id`, `o`.`abbr`, `o`.`address`, `o`.`email`, `o`.`is_activate`, `o`.`is_headoffice`, `o`.`localtion_x`, `o`.`localtion_y`, `o`.`org_name`, `o`.`phone`
FROM `ablemusic`.`org` AS `o`
WHERE `o`.`org_id` = @__oldLesson_OrgId_0
LIMIT 1
2019-07-17 11:43:44.681 +12:00 [INF] Executed DbCommand (51ms) [Parameters=[@__oldLesson_RoomId_0='?' (DbType = Int16)], CommandType='"Text"', CommandTimeout='30']
SELECT `r`.`room_id`, `r`.`created_at`, `r`.`is_activate`, `r`.`org_id`, `r`.`room_name`
FROM `ablemusic`.`room` AS `r`
WHERE `r`.`room_id` = @__oldLesson_RoomId_0
LIMIT 1
2019-07-17 11:43:45.242 +12:00 [INF] Executed DbCommand (56ms) [Parameters=[@p2='?' (DbType = Int32), @p0='?' (DbType = Int16), @p1='?' (Size = -1)], CommandType='"Text"', CommandTimeout='30']
UPDATE `ablemusic`.`lesson` SET `is_canceled` = @p0, `reason` = @p1
WHERE `lesson_id` = @p2;
SELECT ROW_COUNT();
2019-07-17 11:43:45.306 +12:00 [INF] Executed DbCommand (59ms) [Parameters=[@p3='?' (DbType = DateTime), @p4='?' (DbType = Int32), @p5='?' (DbType = DateTime), @p6='?' (DbType = DateTime), @p7='?' (DbType = AnsiString), @p8='?' (DbType = Int32), @p9='?' (DbType = Int16), @p10='?' (DbType = Int16), @p11='?' (DbType = AnsiString), @p12='?' (DbType = AnsiString), @p13='?' (DbType = Byte), @p14='?' (DbType = Int32), @p15='?' (DbType = AnsiString), @p16='?' (DbType = Int16), @p17='?' (Size = -1), @p18='?' (DbType = Int16), @p19='?' (DbType = Int16), @p20='?' (DbType = AnsiString)], CommandType='"Text"', CommandTimeout='30']
INSERT INTO `ablemusic`.`lesson` (`begin_time`, `course_instance_id`, `created_at`, `end_time`, `group_course_instance_id`, `invoice_id`, `is_canceled`, `is_changed`, `is_confirm`, `is_paid`, `is_trial`, `learner_id`, `new_lesson_id`, `org_id`, `reason`, `room_id`, `teacher_id`, `trial_course_id`)
VALUES (@p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11, @p12, @p13, @p14, @p15, @p16, @p17, @p18, @p19, @p20);
SELECT `lesson_id`
FROM `ablemusic`.`lesson`
WHERE ROW_COUNT() = 1
 AND `lesson_id`=LAST_INSERT_ID();
2019-07-17 11:43:46.603 +12:00 [INF] Executed action method Pegasus_backend.Controllers.LessonRearrangeController.PutLesson (Pegasus_backend), returned result Microsoft.AspNetCore.Mvc.OkObjectResult in 6009.7722ms.
2019-07-17 11:43:46.612 +12:00 [INF] Executing ObjectResult, writing value of type 'Pegasus_backend.Models.Result`1[[Pegasus_backend.pegasusContext.Lesson, Pegasus_backend, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2019-07-17 11:43:46.741 +12:00 [INF] Executed action Pegasus_backend.Controllers.LessonRearrangeController.PutLesson (Pegasus_backend) in 6670.54ms
2019-07-17 11:43:46.742 +12:00 [INF] Request finished in 6675.9949ms 200 application/json; charset=utf-8
2019-07-17 11:43:51.344 +12:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5000/api/lesson/GetLessonsForReceptionist/3/2019-07-20  
2019-07-17 11:43:51.344 +12:00 [INF] Policy execution successful.
2019-07-17 11:43:51.344 +12:00 [INF] Request finished in 0.3446ms 204 
2019-07-17 11:43:51.359 +12:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/api/lesson/GetLessonsForReceptionist/3/2019-07-20  
2019-07-17 11:43:51.359 +12:00 [INF] Policy execution successful.
2019-07-17 11:43:51.360 +12:00 [INF] Successfully validated the token.
2019-07-17 11:43:51.360 +12:00 [INF] Route matched with {action = "GetLessonsForReceptionist", controller = "Lesson"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetLessonsForReceptionist(Int32, System.DateTime) on controller Pegasus_backend.Controllers.LessonController (Pegasus_backend).
2019-07-17 11:43:51.360 +12:00 [INF] Executing action method Pegasus_backend.Controllers.LessonController.GetLessonsForReceptionist (Pegasus_backend) - Validation state: "Valid"
2019-07-17 11:43:51.361 +12:00 [INF] Entity Framework Core 2.1.11-servicing-32099 initialized 'ablemusicContext' using provider 'MySql.Data.EntityFrameworkCore' with options: None
2019-07-17 11:43:51.554 +12:00 [INF] Executed DbCommand (56ms) [Parameters=[@__8__locals1_userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT `s`.`staff_id`, `s`.`dob`, `s`.`email`, `s`.`expiry_date`, `s`.`first_name`, `s`.`gender`, `s`.`home_phone`, `s`.`id_number`, `s`.`id_photo`, `s`.`id_type`, `s`.`ird_number`, `s`.`is_activate`, `s`.`last_name`, `s`.`mobile_phone`, `s`.`photo`, `s`.`user_id`, `s`.`visa`
FROM `ablemusic`.`staff` AS `s`
WHERE `s`.`user_id` = @__8__locals1_userId_0
LIMIT 1
2019-07-17 11:43:51.733 +12:00 [INF] Executed DbCommand (51ms) [Parameters=[@__staff_StaffId_0='?' (DbType = Int16)], CommandType='"Text"', CommandTimeout='30']
SELECT `s`.`staff_org_id`, `s`.`is_activate`, `s`.`org_id`, `s`.`staff_id`
FROM `ablemusic`.`staff_org` AS `s`
WHERE `s`.`staff_id` = @__staff_StaffId_0
LIMIT 1
2019-07-17 11:43:51.752 +12:00 [WRN] The Include operation for navigation '[s].CourseInstance' is unnecessary and was ignored because the navigation is not reachable in the final query results. See https://go.microsoft.com/fwlink/?linkid=850303 for more information.
2019-07-17 11:43:51.753 +12:00 [WRN] The Include operation for navigation '[s].Learner' is unnecessary and was ignored because the navigation is not reachable in the final query results. See https://go.microsoft.com/fwlink/?linkid=850303 for more information.
2019-07-17 11:43:51.753 +12:00 [WRN] The Include operation for navigation '[s].Teacher' is unnecessary and was ignored because the navigation is not reachable in the final query results. See https://go.microsoft.com/fwlink/?linkid=850303 for more information.
2019-07-17 11:43:51.753 +12:00 [WRN] The Include operation for navigation '[s].Room' is unnecessary and was ignored because the navigation is not reachable in the final query results. See https://go.microsoft.com/fwlink/?linkid=850303 for more information.
2019-07-17 11:43:51.753 +12:00 [WRN] The Include operation for navigation '[s].Org' is unnecessary and was ignored because the navigation is not reachable in the final query results. See https://go.microsoft.com/fwlink/?linkid=850303 for more information.
2019-07-17 11:43:51.753 +12:00 [WRN] The Include operation for navigation '[s].TrialCourse' is unnecessary and was ignored because the navigation is not reachable in the final query results. See https://go.microsoft.com/fwlink/?linkid=850303 for more information.
2019-07-17 11:43:51.753 +12:00 [WRN] The Include operation for navigation '[s].GroupCourseInstance.LearnerGroupCourse.Learner' is unnecessary and was ignored because the navigation is not reachable in the final query results. See https://go.microsoft.com/fwlink/?linkid=850303 for more information.
2019-07-17 11:43:51.753 +12:00 [WRN] The Include operation for navigation '[s].AwaitMakeUpLessonNewLesson' is unnecessary and was ignored because the navigation is not reachable in the final query results. See https://go.microsoft.com/fwlink/?linkid=850303 for more information.
2019-07-17 11:43:51.784 +12:00 [WRN] The LINQ expression 'where ((((Convert(Convert([s].OrgId, Int32), Nullable`1) == Convert(__orgId_0, Nullable`1)) AndAlso (Convert([s].BeginTime, DateTime).Year == __8__locals1_date_Year_1)) AndAlso (Convert([s].BeginTime, DateTime).Month == __8__locals1_date_Month_2)) AndAlso (Convert([s].BeginTime, DateTime).Day == __8__locals1_date_Day_3))' could not be translated and will be evaluated locally.
2019-07-17 11:43:52.085 +12:00 [INF] Executed DbCommand (125ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT `s.CourseInstance`.`course_instance_id`, `s.CourseInstance`.`begin_date`, `s.CourseInstance`.`course_id`, `s.CourseInstance`.`end_date`, `s.CourseInstance`.`invoice_date`, `s.CourseInstance`.`learner_id`, `s.CourseInstance`.`org_id`, `s.CourseInstance`.`room_id`, `s.CourseInstance`.`teacher_id`, `s.GroupCourseInstance`.`group_course_instance_id`, `s.GroupCourseInstance`.`begin_date`, `s.GroupCourseInstance`.`course_id`, `s.GroupCourseInstance`.`end_date`, `s.GroupCourseInstance`.`invoice_date`, `s.GroupCourseInstance`.`is_activate`, `s.GroupCourseInstance`.`is_started`, `s.GroupCourseInstance`.`org_id`, `s.GroupCourseInstance`.`room_id`, `s.GroupCourseInstance`.`teacher_id`, `s`.`org_id` AS `OrgId`, `s`.`begin_time` AS `start`, `s`.`lesson_id` AS `id`, `s`.`room_id` AS `resourceId`, `s`.`end_time` AS `end`, `s.Teacher`.`first_name` AS `TeacherFirstName0`, `s`.`is_canceled` AS `IsCanceled`, `s`.`is_confirm` AS `IsConfirm`, `s`.`is_changed` AS `IsChanged`, (
    SELECT `z`.`first_name`
    FROM `ablemusic`.`teacher` AS `z`
    WHERE `z`.`teacher_id` = (
        SELECT `r`.`teacher_id`
        FROM `ablemusic`.`lesson` AS `r`
        WHERE `r`.`lesson_id` = `s`.`new_lesson_id`
        LIMIT 1
    )
    LIMIT 1
) AS `TeacherFirstName`, (
    SELECT `z0`.`last_name`
    FROM `ablemusic`.`teacher` AS `z0`
    WHERE `z0`.`teacher_id` = (
        SELECT `r0`.`teacher_id`
        FROM `ablemusic`.`lesson` AS `r0`
        WHERE `r0`.`lesson_id` = `s`.`new_lesson_id`
        LIMIT 1
    )
    LIMIT 1
) AS `TeacherLastName`, (
    SELECT `z1`.`room_name`
    FROM `ablemusic`.`room` AS `z1`
    WHERE `z1`.`room_id` = (
        SELECT `r1`.`room_id`
        FROM `ablemusic`.`lesson` AS `r1`
        WHERE `r1`.`lesson_id` = `s`.`new_lesson_id`
        LIMIT 1
    )
    LIMIT 1
) AS `RoomName`, (
    SELECT `z2`.`org_name`
    FROM `ablemusic`.`org` AS `z2`
    WHERE `z2`.`org_id` = (
        SELECT `r2`.`org_id`
        FROM `ablemusic`.`lesson` AS `r2`
        WHERE `r2`.`lesson_id` = `s`.`new_lesson_id`
        LIMIT 1
    )
    LIMIT 1
) AS `OrgName`, (
    SELECT `r3`.`begin_time`
    FROM `ablemusic`.`lesson` AS `r3`
    WHERE `r3`.`lesson_id` = `s`.`new_lesson_id`
    LIMIT 1
) AS `BeginTime`, `s`.`reason`, CASE
    WHEN `s`.`is_paid` = 1
    THEN 0 ELSE 1
END, CASE
    WHEN (
        SELECT `q1`.`quantity`
        FROM `ablemusic`.`lesson_remain` AS `q1`
        WHERE ((`q1`.`learner_id` = `s`.`learner_id`) OR (`q1`.`learner_id` IS NULL AND `s`.`learner_id` IS NULL)) AND ((`q1`.`course_instance_id` = `s`.`course_instance_id`) OR (`q1`.`course_instance_id` IS NULL AND `s`.`course_instance_id` IS NULL))
        LIMIT 1
    ) <= 3
    THEN 1 ELSE 0
END, `s.Learner`.`first_name` AS `FirstName`, `s`.`learner_id` AS `LearnerId`, `s.Room`.`room_name` AS `RoomName0`, `s.Org`.`org_name` AS `OrgName0`, `s`.`teacher_id` AS `TeacherId`, `s.GroupCourseInstance.Course`.`course_name`, `s.TrialCourse`.`course_name`, `s.CourseInstance.Course`.`course_name`, `s.GroupCourseInstance.Course`.`course_id`, `s`.`trial_course_id`, `s.CourseInstance.Course`.`course_id`, `s`.`learner_id` AS `LearnerId0`
FROM `ablemusic`.`lesson` AS `s`
LEFT JOIN `ablemusic`.`course` AS `s.TrialCourse` ON `s`.`trial_course_id` = `s.TrialCourse`.`course_id`
INNER JOIN `ablemusic`.`org` AS `s.Org` ON `s`.`org_id` = `s.Org`.`org_id`
LEFT JOIN `ablemusic`.`room` AS `s.Room` ON `s`.`room_id` = `s.Room`.`room_id`
LEFT JOIN `ablemusic`.`learner` AS `s.Learner` ON `s`.`learner_id` = `s.Learner`.`learner_id`
LEFT JOIN `ablemusic`.`teacher` AS `s.Teacher` ON `s`.`teacher_id` = `s.Teacher`.`teacher_id`
LEFT JOIN `ablemusic`.`one2one_course_instance` AS `s.CourseInstance` ON `s`.`course_instance_id` = `s.CourseInstance`.`course_instance_id`
LEFT JOIN `ablemusic`.`course` AS `s.CourseInstance.Course` ON `s.CourseInstance`.`course_id` = `s.CourseInstance.Course`.`course_id`
LEFT JOIN `ablemusic`.`group_course_instance` AS `s.GroupCourseInstance` ON `s`.`group_course_instance_id` = `s.GroupCourseInstance`.`group_course_instance_id`
LEFT JOIN `ablemusic`.`course` AS `s.GroupCourseInstance.Course` ON `s.GroupCourseInstance`.`course_id` = `s.GroupCourseInstance.Course`.`course_id`
2019-07-17 11:43:52.389 +12:00 [INF] Executed action method Pegasus_backend.Controllers.LessonController.GetLessonsForReceptionist (Pegasus_backend), returned result Microsoft.AspNetCore.Mvc.OkObjectResult in 1029.1723ms.
2019-07-17 11:43:52.390 +12:00 [INF] Executing ObjectResult, writing value of type 'Pegasus_backend.Models.Result`1[[System.Object, System.Private.CoreLib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2019-07-17 11:43:52.390 +12:00 [INF] Executed action Pegasus_backend.Controllers.LessonController.GetLessonsForReceptionist (Pegasus_backend) in 1030.6322ms
2019-07-17 11:43:52.391 +12:00 [INF] Request finished in 1031.8578ms 200 application/json; charset=utf-8
2019-07-17 11:48:44.858 +12:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/api/teacherfilter/sessionEditFilter/2  
2019-07-17 11:48:44.858 +12:00 [INF] Policy execution successful.
2019-07-17 11:48:44.865 +12:00 [INF] Route matched with {action = "sessionEditFilterGet", controller = "TeacherFilter"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] sessionEditFilterGet(Int32) on controller Pegasus_backend.Controllers.TeacherFilterController (Pegasus_backend).
2019-07-17 11:48:44.865 +12:00 [INF] Executing action method Pegasus_backend.Controllers.TeacherFilterController.sessionEditFilterGet (Pegasus_backend) - Validation state: "Valid"
2019-07-17 11:48:44.887 +12:00 [INF] Entity Framework Core 2.1.11-servicing-32099 initialized 'ablemusicContext' using provider 'MySql.Data.EntityFrameworkCore' with options: None
2019-07-17 11:48:45.112 +12:00 [INF] Executed DbCommand (54ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT `o`.`org_id` AS `OrgId`, `o`.`org_name` AS `OrgName`
FROM `ablemusic`.`org` AS `o`
2019-07-17 11:48:45.332 +12:00 [INF] Executed DbCommand (58ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT `r`.`room_id` AS `RoomId`, `r`.`room_name` AS `RoomName`, `r`.`org_id` AS `OrgId`
FROM `ablemusic`.`room` AS `r`
2019-07-17 11:48:45.364 +12:00 [WRN] Query: '(from <>f__AnonymousType113<short, string, string, Nullable<short>, Nullable<byte>> <generated>_1 in...' uses First/FirstOrDefault/Last/LastOrDefault operation without OrderBy and filter which may lead to unpredictable results.
2019-07-17 11:48:45.371 +12:00 [WRN] The LINQ expression 'GroupBy(new <>f__AnonymousType114`2(TeacherId = [t].TeacherId, TeacherAvailableOrgId = [ta].OrgId), new <>f__AnonymousType113`5(TeacherId = [t].TeacherId, TeacherFirstName = [t].FirstName, TeacherLastName = [t].LastName, TeacherAvailableOrgId = [ta].OrgId, TeacherLevelId = [t].Level))' could not be translated and will be evaluated locally.
2019-07-17 11:48:45.372 +12:00 [WRN] The LINQ expression 'FirstOrDefault()' could not be translated and will be evaluated locally.
2019-07-17 11:48:45.597 +12:00 [INF] Executed DbCommand (75ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT `t`.`teacher_id` AS `TeacherId`, `t`.`first_name` AS `TeacherFirstName`, `t`.`last_name` AS `TeacherLastName`, `ta`.`org_id` AS `TeacherAvailableOrgId`, `t`.`level` AS `TeacherLevelId`
FROM `ablemusic`.`teacher` AS `t`
INNER JOIN `ablemusic`.`available_days` AS `ta` ON `t`.`teacher_id` = `ta`.`teacher_id`
INNER JOIN `ablemusic`.`teacher_course` AS `tc` ON `t`.`teacher_id` = `tc`.`teacher_id`
WHERE `tc`.`course_id` = @__courseId_0
ORDER BY `t`.`teacher_id`, `ta`.`org_id`
2019-07-17 11:48:45.638 +12:00 [INF] Executed action method Pegasus_backend.Controllers.TeacherFilterController.sessionEditFilterGet (Pegasus_backend), returned result Microsoft.AspNetCore.Mvc.OkObjectResult in 772.33480000000009ms.
2019-07-17 11:48:45.638 +12:00 [INF] Executing ObjectResult, writing value of type 'Pegasus_backend.Models.Result`1[[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2019-07-17 11:48:45.645 +12:00 [INF] Executed action Pegasus_backend.Controllers.TeacherFilterController.sessionEditFilterGet (Pegasus_backend) in 780.63010000000008ms
2019-07-17 11:48:45.646 +12:00 [INF] Request finished in 787.8511ms 200 application/json; charset=utf-8
2019-07-17 12:21:56.848 +12:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5000/api/lookups  
2019-07-17 12:21:56.873 +12:00 [INF] Policy execution successful.
2019-07-17 12:21:56.873 +12:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5000/api/navitems  
2019-07-17 12:21:56.873 +12:00 [INF] Request finished in 28.6493ms 204 
2019-07-17 12:21:56.873 +12:00 [INF] Policy execution successful.
2019-07-17 12:21:56.873 +12:00 [INF] Request finished in 0.5229ms 204 
2019-07-17 12:21:56.910 +12:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5000/api/room/forCalendar  
2019-07-17 12:21:56.910 +12:00 [INF] Policy execution successful.
2019-07-17 12:21:56.910 +12:00 [INF] Request finished in 0.4798ms 204 
2019-07-17 12:21:56.959 +12:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/api/lookups  
2019-07-17 12:21:56.960 +12:00 [INF] Policy execution successful.
2019-07-17 12:21:56.960 +12:00 [INF] Successfully validated the token.
2019-07-17 12:21:56.969 +12:00 [INF] Route matched with {action = "GetLookups", controller = "Lookups"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetLookups() on controller Pegasus_backend.Controllers.LookupsController (Pegasus_backend).
2019-07-17 12:21:56.969 +12:00 [INF] Executing action method Pegasus_backend.Controllers.LookupsController.GetLookups (Pegasus_backend) - Validation state: "Valid"
2019-07-17 12:21:56.970 +12:00 [INF] Entity Framework Core 2.1.11-servicing-32099 initialized 'ablemusicContext' using provider 'MySql.Data.EntityFrameworkCore' with options: None
2019-07-17 12:21:57.003 +12:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/api/room/forCalendar  
2019-07-17 12:21:57.003 +12:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/api/navitems  
2019-07-17 12:21:57.003 +12:00 [INF] Policy execution successful.
2019-07-17 12:21:57.004 +12:00 [INF] Policy execution successful.
2019-07-17 12:21:57.004 +12:00 [INF] Successfully validated the token.
2019-07-17 12:21:57.004 +12:00 [INF] Successfully validated the token.
2019-07-17 12:21:57.004 +12:00 [INF] Route matched with {action = "GetRoom", controller = "Room"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetRoom() on controller Pegasus_backend.Controllers.RoomController (Pegasus_backend).
2019-07-17 12:21:57.005 +12:00 [INF] Authorization was successful.
2019-07-17 12:21:57.006 +12:00 [INF] Executing action method Pegasus_backend.Controllers.RoomController.GetRoom (Pegasus_backend) - Validation state: "Valid"
2019-07-17 12:21:57.006 +12:00 [INF] Route matched with {action = "GetNavItems", controller = "NavItems"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult GetNavItems() on controller Pegasus_backend.Controllers.NavItemsController (Pegasus_backend).
2019-07-17 12:21:57.006 +12:00 [INF] Entity Framework Core 2.1.11-servicing-32099 initialized 'ablemusicContext' using provider 'MySql.Data.EntityFrameworkCore' with options: None
2019-07-17 12:21:57.006 +12:00 [INF] Authorization was successful.
2019-07-17 12:21:57.007 +12:00 [INF] Executing action method Pegasus_backend.Controllers.NavItemsController.GetNavItems (Pegasus_backend) - Validation state: "Valid"
2019-07-17 12:21:57.008 +12:00 [INF] Entity Framework Core 2.1.11-servicing-32099 initialized 'ablemusicContext' using provider 'MySql.Data.EntityFrameworkCore' with options: None
2019-07-17 12:21:57.614 +12:00 [INF] Executed DbCommand (53ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT `s`.`staff_id`, `s`.`dob`, `s`.`email`, `s`.`expiry_date`, `s`.`first_name`, `s`.`gender`, `s`.`home_phone`, `s`.`id_number`, `s`.`id_photo`, `s`.`id_type`, `s`.`ird_number`, `s`.`is_activate`, `s`.`last_name`, `s`.`mobile_phone`, `s`.`photo`, `s`.`user_id`, `s`.`visa`
FROM `ablemusic`.`staff` AS `s`
WHERE `s`.`user_id` = @__userId_0
LIMIT 1
2019-07-17 12:21:57.616 +12:00 [INF] Executed DbCommand (55ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT `l`.`lookup_id`, `l`.`description`, `l`.`lookup_type`, `l`.`prop_name`, `l`.`prop_value`
FROM `ablemusic`.`lookup` AS `l`
2019-07-17 12:21:57.621 +12:00 [INF] Executed action method Pegasus_backend.Controllers.LookupsController.GetLookups (Pegasus_backend), returned result Microsoft.AspNetCore.Mvc.OkObjectResult in 651.914ms.
2019-07-17 12:21:57.622 +12:00 [INF] Executing ObjectResult, writing value of type 'Pegasus_backend.Models.Result`1[[System.Collections.Generic.List`1[[Pegasus_backend.pegasusContext.Lookup, Pegasus_backend, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2019-07-17 12:21:57.623 +12:00 [INF] Executed action Pegasus_backend.Controllers.LookupsController.GetLookups (Pegasus_backend) in 654.3609ms
2019-07-17 12:21:57.623 +12:00 [INF] Request finished in 664.0866ms 200 application/json; charset=utf-8
2019-07-17 12:21:57.649 +12:00 [INF] Executed DbCommand (52ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT `s`.`user_id`, `s`.`created_at`, `s`.`is_activate`, `s`.`is_online`, `s`.`password`, `s`.`role_id`, `s`.`signature`, `s`.`unread_message_id`, `s`.`user_name`
FROM `ablemusic`.`user` AS `s`
WHERE `s`.`user_id` = @__userId_0
LIMIT 1
2019-07-17 12:21:57.792 +12:00 [INF] Executed DbCommand (51ms) [Parameters=[@__staff_StaffId_0='?' (DbType = Int16)], CommandType='"Text"', CommandTimeout='30']
SELECT `s`.`staff_org_id`, `s`.`is_activate`, `s`.`org_id`, `s`.`staff_id`
FROM `ablemusic`.`staff_org` AS `s`
WHERE `s`.`staff_id` = @__staff_StaffId_0
LIMIT 1
2019-07-17 12:21:57.825 +12:00 [INF] Executed DbCommand (48ms) [Parameters=[@__roleId_0='?' (DbType = Int16)], CommandType='"Text"', CommandTimeout='30']
SELECT `s`.`page_id`
FROM `ablemusic`.`role_access` AS `s`
WHERE `s`.`role_id` = @__roleId_0
2019-07-17 12:21:57.970 +12:00 [INF] Executed DbCommand (49ms) [Parameters=[@__orgId_0='?' (DbType = Int16)], CommandType='"Text"', CommandTimeout='30']
SELECT `s`.`room_id` AS `id`, `s`.`room_name` AS `title`
FROM `ablemusic`.`room` AS `s`
WHERE `s`.`org_id` = @__orgId_0
2019-07-17 12:21:57.970 +12:00 [INF] Executed action method Pegasus_backend.Controllers.RoomController.GetRoom (Pegasus_backend), returned result Microsoft.AspNetCore.Mvc.OkObjectResult in 964.78000000000009ms.
2019-07-17 12:21:57.971 +12:00 [INF] Executing ObjectResult, writing value of type 'Pegasus_backend.Models.Result`1[[System.Collections.Generic.IEnumerable`1[[System.Object, System.Private.CoreLib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2019-07-17 12:21:57.971 +12:00 [INF] Executed action Pegasus_backend.Controllers.RoomController.GetRoom (Pegasus_backend) in 966.2541ms
2019-07-17 12:21:57.971 +12:00 [INF] Request finished in 968.0655ms 200 application/json; charset=utf-8
2019-07-17 12:21:57.977 +12:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5000/api/lesson/GetLessonsForReceptionist/3/2019-07-17  
2019-07-17 12:21:57.978 +12:00 [INF] Policy execution successful.
2019-07-17 12:21:57.978 +12:00 [INF] Request finished in 0.3126ms 204 
2019-07-17 12:21:58.006 +12:00 [INF] Executed DbCommand (49ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT `s`.`page_group_id`, `s`.`display_order`, `s`.`icon`, `s`.`page_group_name`
FROM `ablemusic`.`page_group` AS `s`
ORDER BY `s`.`page_group_id`
2019-07-17 12:21:58.068 +12:00 [INF] Executed DbCommand (60ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT `s.Page`.`page_id`, `s.Page`.`display_order`, `s.Page`.`icon`, `s.Page`.`is_activate`, `s.Page`.`page_group_id`, `s.Page`.`page_name`, `s.Page`.`para`, `s.Page`.`para_flag`, `s.Page`.`url`
FROM `ablemusic`.`page` AS `s.Page`
INNER JOIN (
    SELECT `s0`.`page_group_id`
    FROM `ablemusic`.`page_group` AS `s0`
) AS `t` ON `s.Page`.`page_group_id` = `t`.`page_group_id`
ORDER BY `t`.`page_group_id`
2019-07-17 12:21:58.069 +12:00 [INF] Executed action method Pegasus_backend.Controllers.NavItemsController.GetNavItems (Pegasus_backend), returned result Microsoft.AspNetCore.Mvc.OkObjectResult in 1062.3806ms.
2019-07-17 12:21:58.070 +12:00 [INF] Executing ObjectResult, writing value of type 'Pegasus_backend.Models.Result`1[[System.Object, System.Private.CoreLib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2019-07-17 12:21:58.070 +12:00 [INF] Executed action Pegasus_backend.Controllers.NavItemsController.GetNavItems (Pegasus_backend) in 1063.699ms
2019-07-17 12:21:58.070 +12:00 [INF] Request finished in 1067.6957ms 200 application/json; charset=utf-8
2019-07-17 12:21:58.092 +12:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/api/lesson/GetLessonsForReceptionist/3/2019-07-17  
2019-07-17 12:21:58.092 +12:00 [INF] Policy execution successful.
2019-07-17 12:21:58.092 +12:00 [INF] Successfully validated the token.
2019-07-17 12:21:58.093 +12:00 [INF] Route matched with {action = "GetLessonsForReceptionist", controller = "Lesson"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetLessonsForReceptionist(Int32, System.DateTime) on controller Pegasus_backend.Controllers.LessonController (Pegasus_backend).
2019-07-17 12:21:58.093 +12:00 [INF] Executing action method Pegasus_backend.Controllers.LessonController.GetLessonsForReceptionist (Pegasus_backend) - Validation state: "Valid"
2019-07-17 12:21:58.094 +12:00 [INF] Entity Framework Core 2.1.11-servicing-32099 initialized 'ablemusicContext' using provider 'MySql.Data.EntityFrameworkCore' with options: None
2019-07-17 12:21:58.274 +12:00 [INF] Executed DbCommand (53ms) [Parameters=[@__8__locals1_userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT `s`.`staff_id`, `s`.`dob`, `s`.`email`, `s`.`expiry_date`, `s`.`first_name`, `s`.`gender`, `s`.`home_phone`, `s`.`id_number`, `s`.`id_photo`, `s`.`id_type`, `s`.`ird_number`, `s`.`is_activate`, `s`.`last_name`, `s`.`mobile_phone`, `s`.`photo`, `s`.`user_id`, `s`.`visa`
FROM `ablemusic`.`staff` AS `s`
WHERE `s`.`user_id` = @__8__locals1_userId_0
LIMIT 1
2019-07-17 12:21:58.452 +12:00 [INF] Executed DbCommand (49ms) [Parameters=[@__staff_StaffId_0='?' (DbType = Int16)], CommandType='"Text"', CommandTimeout='30']
SELECT `s`.`staff_org_id`, `s`.`is_activate`, `s`.`org_id`, `s`.`staff_id`
FROM `ablemusic`.`staff_org` AS `s`
WHERE `s`.`staff_id` = @__staff_StaffId_0
LIMIT 1
2019-07-17 12:21:58.489 +12:00 [WRN] The Include operation for navigation '[s].CourseInstance' is unnecessary and was ignored because the navigation is not reachable in the final query results. See https://go.microsoft.com/fwlink/?linkid=850303 for more information.
2019-07-17 12:21:58.489 +12:00 [WRN] The Include operation for navigation '[s].Learner' is unnecessary and was ignored because the navigation is not reachable in the final query results. See https://go.microsoft.com/fwlink/?linkid=850303 for more information.
2019-07-17 12:21:58.490 +12:00 [WRN] The Include operation for navigation '[s].Teacher' is unnecessary and was ignored because the navigation is not reachable in the final query results. See https://go.microsoft.com/fwlink/?linkid=850303 for more information.
2019-07-17 12:21:58.490 +12:00 [WRN] The Include operation for navigation '[s].Room' is unnecessary and was ignored because the navigation is not reachable in the final query results. See https://go.microsoft.com/fwlink/?linkid=850303 for more information.
2019-07-17 12:21:58.490 +12:00 [WRN] The Include operation for navigation '[s].Org' is unnecessary and was ignored because the navigation is not reachable in the final query results. See https://go.microsoft.com/fwlink/?linkid=850303 for more information.
2019-07-17 12:21:58.490 +12:00 [WRN] The Include operation for navigation '[s].TrialCourse' is unnecessary and was ignored because the navigation is not reachable in the final query results. See https://go.microsoft.com/fwlink/?linkid=850303 for more information.
2019-07-17 12:21:58.490 +12:00 [WRN] The Include operation for navigation '[s].GroupCourseInstance.LearnerGroupCourse.Learner' is unnecessary and was ignored because the navigation is not reachable in the final query results. See https://go.microsoft.com/fwlink/?linkid=850303 for more information.
2019-07-17 12:21:58.490 +12:00 [WRN] The Include operation for navigation '[s].AwaitMakeUpLessonNewLesson' is unnecessary and was ignored because the navigation is not reachable in the final query results. See https://go.microsoft.com/fwlink/?linkid=850303 for more information.
2019-07-17 12:21:58.518 +12:00 [WRN] The LINQ expression 'where ((((Convert(Convert([s].OrgId, Int32), Nullable`1) == Convert(__orgId_0, Nullable`1)) AndAlso (Convert([s].BeginTime, DateTime).Year == __8__locals1_date_Year_1)) AndAlso (Convert([s].BeginTime, DateTime).Month == __8__locals1_date_Month_2)) AndAlso (Convert([s].BeginTime, DateTime).Day == __8__locals1_date_Day_3))' could not be translated and will be evaluated locally.
2019-07-17 12:21:58.786 +12:00 [INF] Executed DbCommand (99ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT `s.CourseInstance`.`course_instance_id`, `s.CourseInstance`.`begin_date`, `s.CourseInstance`.`course_id`, `s.CourseInstance`.`end_date`, `s.CourseInstance`.`invoice_date`, `s.CourseInstance`.`learner_id`, `s.CourseInstance`.`org_id`, `s.CourseInstance`.`room_id`, `s.CourseInstance`.`teacher_id`, `s.GroupCourseInstance`.`group_course_instance_id`, `s.GroupCourseInstance`.`begin_date`, `s.GroupCourseInstance`.`course_id`, `s.GroupCourseInstance`.`end_date`, `s.GroupCourseInstance`.`invoice_date`, `s.GroupCourseInstance`.`is_activate`, `s.GroupCourseInstance`.`is_started`, `s.GroupCourseInstance`.`org_id`, `s.GroupCourseInstance`.`room_id`, `s.GroupCourseInstance`.`teacher_id`, `s`.`org_id` AS `OrgId`, `s`.`begin_time` AS `start`, `s`.`lesson_id` AS `id`, `s`.`room_id` AS `resourceId`, `s`.`end_time` AS `end`, `s.Teacher`.`first_name` AS `TeacherFirstName0`, `s`.`is_canceled` AS `IsCanceled`, `s`.`is_confirm` AS `IsConfirm`, `s`.`is_changed` AS `IsChanged`, (
    SELECT `z`.`first_name`
    FROM `ablemusic`.`teacher` AS `z`
    WHERE `z`.`teacher_id` = (
        SELECT `r`.`teacher_id`
        FROM `ablemusic`.`lesson` AS `r`
        WHERE `r`.`lesson_id` = `s`.`new_lesson_id`
        LIMIT 1
    )
    LIMIT 1
) AS `TeacherFirstName`, (
    SELECT `z0`.`last_name`
    FROM `ablemusic`.`teacher` AS `z0`
    WHERE `z0`.`teacher_id` = (
        SELECT `r0`.`teacher_id`
        FROM `ablemusic`.`lesson` AS `r0`
        WHERE `r0`.`lesson_id` = `s`.`new_lesson_id`
        LIMIT 1
    )
    LIMIT 1
) AS `TeacherLastName`, (
    SELECT `z1`.`room_name`
    FROM `ablemusic`.`room` AS `z1`
    WHERE `z1`.`room_id` = (
        SELECT `r1`.`room_id`
        FROM `ablemusic`.`lesson` AS `r1`
        WHERE `r1`.`lesson_id` = `s`.`new_lesson_id`
        LIMIT 1
    )
    LIMIT 1
) AS `RoomName`, (
    SELECT `z2`.`org_name`
    FROM `ablemusic`.`org` AS `z2`
    WHERE `z2`.`org_id` = (
        SELECT `r2`.`org_id`
        FROM `ablemusic`.`lesson` AS `r2`
        WHERE `r2`.`lesson_id` = `s`.`new_lesson_id`
        LIMIT 1
    )
    LIMIT 1
) AS `OrgName`, (
    SELECT `r3`.`begin_time`
    FROM `ablemusic`.`lesson` AS `r3`
    WHERE `r3`.`lesson_id` = `s`.`new_lesson_id`
    LIMIT 1
) AS `BeginTime`, `s`.`reason`, CASE
    WHEN `s`.`is_paid` = 1
    THEN 0 ELSE 1
END, CASE
    WHEN (
        SELECT `q1`.`quantity`
        FROM `ablemusic`.`lesson_remain` AS `q1`
        WHERE ((`q1`.`learner_id` = `s`.`learner_id`) OR (`q1`.`learner_id` IS NULL AND `s`.`learner_id` IS NULL)) AND ((`q1`.`course_instance_id` = `s`.`course_instance_id`) OR (`q1`.`course_instance_id` IS NULL AND `s`.`course_instance_id` IS NULL))
        LIMIT 1
    ) <= 3
    THEN 1 ELSE 0
END, `s.Learner`.`first_name` AS `FirstName`, `s`.`learner_id` AS `LearnerId`, `s.Room`.`room_name` AS `RoomName0`, `s.Org`.`org_name` AS `OrgName0`, `s`.`teacher_id` AS `TeacherId`, `s.GroupCourseInstance.Course`.`course_name`, `s.TrialCourse`.`course_name`, `s.CourseInstance.Course`.`course_name`, `s.GroupCourseInstance.Course`.`course_id`, `s`.`trial_course_id`, `s.CourseInstance.Course`.`course_id`, `s`.`learner_id` AS `LearnerId0`
FROM `ablemusic`.`lesson` AS `s`
LEFT JOIN `ablemusic`.`course` AS `s.TrialCourse` ON `s`.`trial_course_id` = `s.TrialCourse`.`course_id`
INNER JOIN `ablemusic`.`org` AS `s.Org` ON `s`.`org_id` = `s.Org`.`org_id`
LEFT JOIN `ablemusic`.`room` AS `s.Room` ON `s`.`room_id` = `s.Room`.`room_id`
LEFT JOIN `ablemusic`.`learner` AS `s.Learner` ON `s`.`learner_id` = `s.Learner`.`learner_id`
LEFT JOIN `ablemusic`.`teacher` AS `s.Teacher` ON `s`.`teacher_id` = `s.Teacher`.`teacher_id`
LEFT JOIN `ablemusic`.`one2one_course_instance` AS `s.CourseInstance` ON `s`.`course_instance_id` = `s.CourseInstance`.`course_instance_id`
LEFT JOIN `ablemusic`.`course` AS `s.CourseInstance.Course` ON `s.CourseInstance`.`course_id` = `s.CourseInstance.Course`.`course_id`
LEFT JOIN `ablemusic`.`group_course_instance` AS `s.GroupCourseInstance` ON `s`.`group_course_instance_id` = `s.GroupCourseInstance`.`group_course_instance_id`
LEFT JOIN `ablemusic`.`course` AS `s.GroupCourseInstance.Course` ON `s.GroupCourseInstance`.`course_id` = `s.GroupCourseInstance.Course`.`course_id`
2019-07-17 12:21:59.124 +12:00 [INF] Executed action method Pegasus_backend.Controllers.LessonController.GetLessonsForReceptionist (Pegasus_backend), returned result Microsoft.AspNetCore.Mvc.OkObjectResult in 1030.8935000000001ms.
2019-07-17 12:21:59.125 +12:00 [INF] Executing ObjectResult, writing value of type 'Pegasus_backend.Models.Result`1[[System.Object, System.Private.CoreLib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2019-07-17 12:21:59.125 +12:00 [INF] Executed action Pegasus_backend.Controllers.LessonController.GetLessonsForReceptionist (Pegasus_backend) in 1032.3894ms
2019-07-17 12:21:59.125 +12:00 [INF] Request finished in 1033.5897ms 200 application/json; charset=utf-8
2019-07-17 12:22:01.560 +12:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5000/api/lesson/GetLessonsForReceptionist/3/2019-07-18  
2019-07-17 12:22:01.561 +12:00 [INF] Policy execution successful.
2019-07-17 12:22:01.561 +12:00 [INF] Request finished in 0.3463ms 204 
2019-07-17 12:22:01.573 +12:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/api/lesson/GetLessonsForReceptionist/3/2019-07-18  
2019-07-17 12:22:01.573 +12:00 [INF] Policy execution successful.
2019-07-17 12:22:01.574 +12:00 [INF] Successfully validated the token.
2019-07-17 12:22:01.574 +12:00 [INF] Route matched with {action = "GetLessonsForReceptionist", controller = "Lesson"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetLessonsForReceptionist(Int32, System.DateTime) on controller Pegasus_backend.Controllers.LessonController (Pegasus_backend).
2019-07-17 12:22:01.574 +12:00 [INF] Executing action method Pegasus_backend.Controllers.LessonController.GetLessonsForReceptionist (Pegasus_backend) - Validation state: "Valid"
2019-07-17 12:22:01.575 +12:00 [INF] Entity Framework Core 2.1.11-servicing-32099 initialized 'ablemusicContext' using provider 'MySql.Data.EntityFrameworkCore' with options: None
2019-07-17 12:22:01.756 +12:00 [INF] Executed DbCommand (72ms) [Parameters=[@__8__locals1_userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT `s`.`staff_id`, `s`.`dob`, `s`.`email`, `s`.`expiry_date`, `s`.`first_name`, `s`.`gender`, `s`.`home_phone`, `s`.`id_number`, `s`.`id_photo`, `s`.`id_type`, `s`.`ird_number`, `s`.`is_activate`, `s`.`last_name`, `s`.`mobile_phone`, `s`.`photo`, `s`.`user_id`, `s`.`visa`
FROM `ablemusic`.`staff` AS `s`
WHERE `s`.`user_id` = @__8__locals1_userId_0
LIMIT 1
2019-07-17 12:22:01.934 +12:00 [INF] Executed DbCommand (52ms) [Parameters=[@__staff_StaffId_0='?' (DbType = Int16)], CommandType='"Text"', CommandTimeout='30']
SELECT `s`.`staff_org_id`, `s`.`is_activate`, `s`.`org_id`, `s`.`staff_id`
FROM `ablemusic`.`staff_org` AS `s`
WHERE `s`.`staff_id` = @__staff_StaffId_0
LIMIT 1
2019-07-17 12:22:01.952 +12:00 [WRN] The Include operation for navigation '[s].CourseInstance' is unnecessary and was ignored because the navigation is not reachable in the final query results. See https://go.microsoft.com/fwlink/?linkid=850303 for more information.
2019-07-17 12:22:01.952 +12:00 [WRN] The Include operation for navigation '[s].Learner' is unnecessary and was ignored because the navigation is not reachable in the final query results. See https://go.microsoft.com/fwlink/?linkid=850303 for more information.
2019-07-17 12:22:01.952 +12:00 [WRN] The Include operation for navigation '[s].Teacher' is unnecessary and was ignored because the navigation is not reachable in the final query results. See https://go.microsoft.com/fwlink/?linkid=850303 for more information.
2019-07-17 12:22:01.952 +12:00 [WRN] The Include operation for navigation '[s].Room' is unnecessary and was ignored because the navigation is not reachable in the final query results. See https://go.microsoft.com/fwlink/?linkid=850303 for more information.
2019-07-17 12:22:01.952 +12:00 [WRN] The Include operation for navigation '[s].Org' is unnecessary and was ignored because the navigation is not reachable in the final query results. See https://go.microsoft.com/fwlink/?linkid=850303 for more information.
2019-07-17 12:22:01.952 +12:00 [WRN] The Include operation for navigation '[s].TrialCourse' is unnecessary and was ignored because the navigation is not reachable in the final query results. See https://go.microsoft.com/fwlink/?linkid=850303 for more information.
2019-07-17 12:22:01.952 +12:00 [WRN] The Include operation for navigation '[s].GroupCourseInstance.LearnerGroupCourse.Learner' is unnecessary and was ignored because the navigation is not reachable in the final query results. See https://go.microsoft.com/fwlink/?linkid=850303 for more information.
2019-07-17 12:22:01.952 +12:00 [WRN] The Include operation for navigation '[s].AwaitMakeUpLessonNewLesson' is unnecessary and was ignored because the navigation is not reachable in the final query results. See https://go.microsoft.com/fwlink/?linkid=850303 for more information.
2019-07-17 12:22:01.981 +12:00 [WRN] The LINQ expression 'where ((((Convert(Convert([s].OrgId, Int32), Nullable`1) == Convert(__orgId_0, Nullable`1)) AndAlso (Convert([s].BeginTime, DateTime).Year == __8__locals1_date_Year_1)) AndAlso (Convert([s].BeginTime, DateTime).Month == __8__locals1_date_Month_2)) AndAlso (Convert([s].BeginTime, DateTime).Day == __8__locals1_date_Day_3))' could not be translated and will be evaluated locally.
2019-07-17 12:22:02.248 +12:00 [INF] Executed DbCommand (101ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT `s.CourseInstance`.`course_instance_id`, `s.CourseInstance`.`begin_date`, `s.CourseInstance`.`course_id`, `s.CourseInstance`.`end_date`, `s.CourseInstance`.`invoice_date`, `s.CourseInstance`.`learner_id`, `s.CourseInstance`.`org_id`, `s.CourseInstance`.`room_id`, `s.CourseInstance`.`teacher_id`, `s.GroupCourseInstance`.`group_course_instance_id`, `s.GroupCourseInstance`.`begin_date`, `s.GroupCourseInstance`.`course_id`, `s.GroupCourseInstance`.`end_date`, `s.GroupCourseInstance`.`invoice_date`, `s.GroupCourseInstance`.`is_activate`, `s.GroupCourseInstance`.`is_started`, `s.GroupCourseInstance`.`org_id`, `s.GroupCourseInstance`.`room_id`, `s.GroupCourseInstance`.`teacher_id`, `s`.`org_id` AS `OrgId`, `s`.`begin_time` AS `start`, `s`.`lesson_id` AS `id`, `s`.`room_id` AS `resourceId`, `s`.`end_time` AS `end`, `s.Teacher`.`first_name` AS `TeacherFirstName0`, `s`.`is_canceled` AS `IsCanceled`, `s`.`is_confirm` AS `IsConfirm`, `s`.`is_changed` AS `IsChanged`, (
    SELECT `z`.`first_name`
    FROM `ablemusic`.`teacher` AS `z`
    WHERE `z`.`teacher_id` = (
        SELECT `r`.`teacher_id`
        FROM `ablemusic`.`lesson` AS `r`
        WHERE `r`.`lesson_id` = `s`.`new_lesson_id`
        LIMIT 1
    )
    LIMIT 1
) AS `TeacherFirstName`, (
    SELECT `z0`.`last_name`
    FROM `ablemusic`.`teacher` AS `z0`
    WHERE `z0`.`teacher_id` = (
        SELECT `r0`.`teacher_id`
        FROM `ablemusic`.`lesson` AS `r0`
        WHERE `r0`.`lesson_id` = `s`.`new_lesson_id`
        LIMIT 1
    )
    LIMIT 1
) AS `TeacherLastName`, (
    SELECT `z1`.`room_name`
    FROM `ablemusic`.`room` AS `z1`
    WHERE `z1`.`room_id` = (
        SELECT `r1`.`room_id`
        FROM `ablemusic`.`lesson` AS `r1`
        WHERE `r1`.`lesson_id` = `s`.`new_lesson_id`
        LIMIT 1
    )
    LIMIT 1
) AS `RoomName`, (
    SELECT `z2`.`org_name`
    FROM `ablemusic`.`org` AS `z2`
    WHERE `z2`.`org_id` = (
        SELECT `r2`.`org_id`
        FROM `ablemusic`.`lesson` AS `r2`
        WHERE `r2`.`lesson_id` = `s`.`new_lesson_id`
        LIMIT 1
    )
    LIMIT 1
) AS `OrgName`, (
    SELECT `r3`.`begin_time`
    FROM `ablemusic`.`lesson` AS `r3`
    WHERE `r3`.`lesson_id` = `s`.`new_lesson_id`
    LIMIT 1
) AS `BeginTime`, `s`.`reason`, CASE
    WHEN `s`.`is_paid` = 1
    THEN 0 ELSE 1
END, CASE
    WHEN (
        SELECT `q1`.`quantity`
        FROM `ablemusic`.`lesson_remain` AS `q1`
        WHERE ((`q1`.`learner_id` = `s`.`learner_id`) OR (`q1`.`learner_id` IS NULL AND `s`.`learner_id` IS NULL)) AND ((`q1`.`course_instance_id` = `s`.`course_instance_id`) OR (`q1`.`course_instance_id` IS NULL AND `s`.`course_instance_id` IS NULL))
        LIMIT 1
    ) <= 3
    THEN 1 ELSE 0
END, `s.Learner`.`first_name` AS `FirstName`, `s`.`learner_id` AS `LearnerId`, `s.Room`.`room_name` AS `RoomName0`, `s.Org`.`org_name` AS `OrgName0`, `s`.`teacher_id` AS `TeacherId`, `s.GroupCourseInstance.Course`.`course_name`, `s.TrialCourse`.`course_name`, `s.CourseInstance.Course`.`course_name`, `s.GroupCourseInstance.Course`.`course_id`, `s`.`trial_course_id`, `s.CourseInstance.Course`.`course_id`, `s`.`learner_id` AS `LearnerId0`
FROM `ablemusic`.`lesson` AS `s`
LEFT JOIN `ablemusic`.`course` AS `s.TrialCourse` ON `s`.`trial_course_id` = `s.TrialCourse`.`course_id`
INNER JOIN `ablemusic`.`org` AS `s.Org` ON `s`.`org_id` = `s.Org`.`org_id`
LEFT JOIN `ablemusic`.`room` AS `s.Room` ON `s`.`room_id` = `s.Room`.`room_id`
LEFT JOIN `ablemusic`.`learner` AS `s.Learner` ON `s`.`learner_id` = `s.Learner`.`learner_id`
LEFT JOIN `ablemusic`.`teacher` AS `s.Teacher` ON `s`.`teacher_id` = `s.Teacher`.`teacher_id`
LEFT JOIN `ablemusic`.`one2one_course_instance` AS `s.CourseInstance` ON `s`.`course_instance_id` = `s.CourseInstance`.`course_instance_id`
LEFT JOIN `ablemusic`.`course` AS `s.CourseInstance.Course` ON `s.CourseInstance`.`course_id` = `s.CourseInstance.Course`.`course_id`
LEFT JOIN `ablemusic`.`group_course_instance` AS `s.GroupCourseInstance` ON `s`.`group_course_instance_id` = `s.GroupCourseInstance`.`group_course_instance_id`
LEFT JOIN `ablemusic`.`course` AS `s.GroupCourseInstance.Course` ON `s.GroupCourseInstance`.`course_id` = `s.GroupCourseInstance.Course`.`course_id`
2019-07-17 12:22:02.469 +12:00 [INF] Executed action method Pegasus_backend.Controllers.LessonController.GetLessonsForReceptionist (Pegasus_backend), returned result Microsoft.AspNetCore.Mvc.OkObjectResult in 894.2854000000001ms.
2019-07-17 12:22:02.469 +12:00 [INF] Executing ObjectResult, writing value of type 'Pegasus_backend.Models.Result`1[[System.Object, System.Private.CoreLib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2019-07-17 12:22:02.469 +12:00 [INF] Executed action Pegasus_backend.Controllers.LessonController.GetLessonsForReceptionist (Pegasus_backend) in 895.33310000000006ms
2019-07-17 12:22:02.469 +12:00 [INF] Request finished in 896.2525ms 200 application/json; charset=utf-8
2019-07-17 12:22:03.553 +12:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5000/api/lesson/GetLessonsForReceptionist/3/2019-07-19  
2019-07-17 12:22:03.553 +12:00 [INF] Policy execution successful.
2019-07-17 12:22:03.553 +12:00 [INF] Request finished in 0.4917ms 204 
2019-07-17 12:22:03.565 +12:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/api/lesson/GetLessonsForReceptionist/3/2019-07-19  
2019-07-17 12:22:03.565 +12:00 [INF] Policy execution successful.
2019-07-17 12:22:03.566 +12:00 [INF] Successfully validated the token.
2019-07-17 12:22:03.566 +12:00 [INF] Route matched with {action = "GetLessonsForReceptionist", controller = "Lesson"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetLessonsForReceptionist(Int32, System.DateTime) on controller Pegasus_backend.Controllers.LessonController (Pegasus_backend).
2019-07-17 12:22:03.566 +12:00 [INF] Executing action method Pegasus_backend.Controllers.LessonController.GetLessonsForReceptionist (Pegasus_backend) - Validation state: "Valid"
2019-07-17 12:22:03.567 +12:00 [INF] Entity Framework Core 2.1.11-servicing-32099 initialized 'ablemusicContext' using provider 'MySql.Data.EntityFrameworkCore' with options: None
2019-07-17 12:22:03.744 +12:00 [INF] Executed DbCommand (55ms) [Parameters=[@__8__locals1_userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT `s`.`staff_id`, `s`.`dob`, `s`.`email`, `s`.`expiry_date`, `s`.`first_name`, `s`.`gender`, `s`.`home_phone`, `s`.`id_number`, `s`.`id_photo`, `s`.`id_type`, `s`.`ird_number`, `s`.`is_activate`, `s`.`last_name`, `s`.`mobile_phone`, `s`.`photo`, `s`.`user_id`, `s`.`visa`
FROM `ablemusic`.`staff` AS `s`
WHERE `s`.`user_id` = @__8__locals1_userId_0
LIMIT 1
2019-07-17 12:22:03.922 +12:00 [INF] Executed DbCommand (49ms) [Parameters=[@__staff_StaffId_0='?' (DbType = Int16)], CommandType='"Text"', CommandTimeout='30']
SELECT `s`.`staff_org_id`, `s`.`is_activate`, `s`.`org_id`, `s`.`staff_id`
FROM `ablemusic`.`staff_org` AS `s`
WHERE `s`.`staff_id` = @__staff_StaffId_0
LIMIT 1
2019-07-17 12:22:03.940 +12:00 [WRN] The Include operation for navigation '[s].CourseInstance' is unnecessary and was ignored because the navigation is not reachable in the final query results. See https://go.microsoft.com/fwlink/?linkid=850303 for more information.
2019-07-17 12:22:03.940 +12:00 [WRN] The Include operation for navigation '[s].Learner' is unnecessary and was ignored because the navigation is not reachable in the final query results. See https://go.microsoft.com/fwlink/?linkid=850303 for more information.
2019-07-17 12:22:03.940 +12:00 [WRN] The Include operation for navigation '[s].Teacher' is unnecessary and was ignored because the navigation is not reachable in the final query results. See https://go.microsoft.com/fwlink/?linkid=850303 for more information.
2019-07-17 12:22:03.940 +12:00 [WRN] The Include operation for navigation '[s].Room' is unnecessary and was ignored because the navigation is not reachable in the final query results. See https://go.microsoft.com/fwlink/?linkid=850303 for more information.
2019-07-17 12:22:03.940 +12:00 [WRN] The Include operation for navigation '[s].Org' is unnecessary and was ignored because the navigation is not reachable in the final query results. See https://go.microsoft.com/fwlink/?linkid=850303 for more information.
2019-07-17 12:22:03.940 +12:00 [WRN] The Include operation for navigation '[s].TrialCourse' is unnecessary and was ignored because the navigation is not reachable in the final query results. See https://go.microsoft.com/fwlink/?linkid=850303 for more information.
2019-07-17 12:22:03.940 +12:00 [WRN] The Include operation for navigation '[s].GroupCourseInstance.LearnerGroupCourse.Learner' is unnecessary and was ignored because the navigation is not reachable in the final query results. See https://go.microsoft.com/fwlink/?linkid=850303 for more information.
2019-07-17 12:22:03.940 +12:00 [WRN] The Include operation for navigation '[s].AwaitMakeUpLessonNewLesson' is unnecessary and was ignored because the navigation is not reachable in the final query results. See https://go.microsoft.com/fwlink/?linkid=850303 for more information.
2019-07-17 12:22:03.968 +12:00 [WRN] The LINQ expression 'where ((((Convert(Convert([s].OrgId, Int32), Nullable`1) == Convert(__orgId_0, Nullable`1)) AndAlso (Convert([s].BeginTime, DateTime).Year == __8__locals1_date_Year_1)) AndAlso (Convert([s].BeginTime, DateTime).Month == __8__locals1_date_Month_2)) AndAlso (Convert([s].BeginTime, DateTime).Day == __8__locals1_date_Day_3))' could not be translated and will be evaluated locally.
2019-07-17 12:22:04.236 +12:00 [INF] Executed DbCommand (101ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT `s.CourseInstance`.`course_instance_id`, `s.CourseInstance`.`begin_date`, `s.CourseInstance`.`course_id`, `s.CourseInstance`.`end_date`, `s.CourseInstance`.`invoice_date`, `s.CourseInstance`.`learner_id`, `s.CourseInstance`.`org_id`, `s.CourseInstance`.`room_id`, `s.CourseInstance`.`teacher_id`, `s.GroupCourseInstance`.`group_course_instance_id`, `s.GroupCourseInstance`.`begin_date`, `s.GroupCourseInstance`.`course_id`, `s.GroupCourseInstance`.`end_date`, `s.GroupCourseInstance`.`invoice_date`, `s.GroupCourseInstance`.`is_activate`, `s.GroupCourseInstance`.`is_started`, `s.GroupCourseInstance`.`org_id`, `s.GroupCourseInstance`.`room_id`, `s.GroupCourseInstance`.`teacher_id`, `s`.`org_id` AS `OrgId`, `s`.`begin_time` AS `start`, `s`.`lesson_id` AS `id`, `s`.`room_id` AS `resourceId`, `s`.`end_time` AS `end`, `s.Teacher`.`first_name` AS `TeacherFirstName0`, `s`.`is_canceled` AS `IsCanceled`, `s`.`is_confirm` AS `IsConfirm`, `s`.`is_changed` AS `IsChanged`, (
    SELECT `z`.`first_name`
    FROM `ablemusic`.`teacher` AS `z`
    WHERE `z`.`teacher_id` = (
        SELECT `r`.`teacher_id`
        FROM `ablemusic`.`lesson` AS `r`
        WHERE `r`.`lesson_id` = `s`.`new_lesson_id`
        LIMIT 1
    )
    LIMIT 1
) AS `TeacherFirstName`, (
    SELECT `z0`.`last_name`
    FROM `ablemusic`.`teacher` AS `z0`
    WHERE `z0`.`teacher_id` = (
        SELECT `r0`.`teacher_id`
        FROM `ablemusic`.`lesson` AS `r0`
        WHERE `r0`.`lesson_id` = `s`.`new_lesson_id`
        LIMIT 1
    )
    LIMIT 1
) AS `TeacherLastName`, (
    SELECT `z1`.`room_name`
    FROM `ablemusic`.`room` AS `z1`
    WHERE `z1`.`room_id` = (
        SELECT `r1`.`room_id`
        FROM `ablemusic`.`lesson` AS `r1`
        WHERE `r1`.`lesson_id` = `s`.`new_lesson_id`
        LIMIT 1
    )
    LIMIT 1
) AS `RoomName`, (
    SELECT `z2`.`org_name`
    FROM `ablemusic`.`org` AS `z2`
    WHERE `z2`.`org_id` = (
        SELECT `r2`.`org_id`
        FROM `ablemusic`.`lesson` AS `r2`
        WHERE `r2`.`lesson_id` = `s`.`new_lesson_id`
        LIMIT 1
    )
    LIMIT 1
) AS `OrgName`, (
    SELECT `r3`.`begin_time`
    FROM `ablemusic`.`lesson` AS `r3`
    WHERE `r3`.`lesson_id` = `s`.`new_lesson_id`
    LIMIT 1
) AS `BeginTime`, `s`.`reason`, CASE
    WHEN `s`.`is_paid` = 1
    THEN 0 ELSE 1
END, CASE
    WHEN (
        SELECT `q1`.`quantity`
        FROM `ablemusic`.`lesson_remain` AS `q1`
        WHERE ((`q1`.`learner_id` = `s`.`learner_id`) OR (`q1`.`learner_id` IS NULL AND `s`.`learner_id` IS NULL)) AND ((`q1`.`course_instance_id` = `s`.`course_instance_id`) OR (`q1`.`course_instance_id` IS NULL AND `s`.`course_instance_id` IS NULL))
        LIMIT 1
    ) <= 3
    THEN 1 ELSE 0
END, `s.Learner`.`first_name` AS `FirstName`, `s`.`learner_id` AS `LearnerId`, `s.Room`.`room_name` AS `RoomName0`, `s.Org`.`org_name` AS `OrgName0`, `s`.`teacher_id` AS `TeacherId`, `s.GroupCourseInstance.Course`.`course_name`, `s.TrialCourse`.`course_name`, `s.CourseInstance.Course`.`course_name`, `s.GroupCourseInstance.Course`.`course_id`, `s`.`trial_course_id`, `s.CourseInstance.Course`.`course_id`, `s`.`learner_id` AS `LearnerId0`
FROM `ablemusic`.`lesson` AS `s`
LEFT JOIN `ablemusic`.`course` AS `s.TrialCourse` ON `s`.`trial_course_id` = `s.TrialCourse`.`course_id`
INNER JOIN `ablemusic`.`org` AS `s.Org` ON `s`.`org_id` = `s.Org`.`org_id`
LEFT JOIN `ablemusic`.`room` AS `s.Room` ON `s`.`room_id` = `s.Room`.`room_id`
LEFT JOIN `ablemusic`.`learner` AS `s.Learner` ON `s`.`learner_id` = `s.Learner`.`learner_id`
LEFT JOIN `ablemusic`.`teacher` AS `s.Teacher` ON `s`.`teacher_id` = `s.Teacher`.`teacher_id`
LEFT JOIN `ablemusic`.`one2one_course_instance` AS `s.CourseInstance` ON `s`.`course_instance_id` = `s.CourseInstance`.`course_instance_id`
LEFT JOIN `ablemusic`.`course` AS `s.CourseInstance.Course` ON `s.CourseInstance`.`course_id` = `s.CourseInstance.Course`.`course_id`
LEFT JOIN `ablemusic`.`group_course_instance` AS `s.GroupCourseInstance` ON `s`.`group_course_instance_id` = `s.GroupCourseInstance`.`group_course_instance_id`
LEFT JOIN `ablemusic`.`course` AS `s.GroupCourseInstance.Course` ON `s.GroupCourseInstance`.`course_id` = `s.GroupCourseInstance.Course`.`course_id`
2019-07-17 12:22:04.419 +12:00 [INF] Executed action method Pegasus_backend.Controllers.LessonController.GetLessonsForReceptionist (Pegasus_backend), returned result Microsoft.AspNetCore.Mvc.OkObjectResult in 852.9306ms.
2019-07-17 12:22:04.419 +12:00 [INF] Executing ObjectResult, writing value of type 'Pegasus_backend.Models.Result`1[[System.Object, System.Private.CoreLib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2019-07-17 12:22:04.420 +12:00 [INF] Executed action Pegasus_backend.Controllers.LessonController.GetLessonsForReceptionist (Pegasus_backend) in 853.779ms
2019-07-17 12:22:04.420 +12:00 [INF] Request finished in 854.7378ms 200 application/json; charset=utf-8
2019-07-17 12:22:16.437 +12:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5000/api/lesson/GetLessonsForReceptionist/3/2019-07-20  
2019-07-17 12:22:16.437 +12:00 [INF] Policy execution successful.
2019-07-17 12:22:16.437 +12:00 [INF] Request finished in 0.3844ms 204 
2019-07-17 12:22:16.460 +12:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/api/lesson/GetLessonsForReceptionist/3/2019-07-20  
2019-07-17 12:22:16.460 +12:00 [INF] Policy execution successful.
2019-07-17 12:22:16.461 +12:00 [INF] Successfully validated the token.
2019-07-17 12:22:16.461 +12:00 [INF] Route matched with {action = "GetLessonsForReceptionist", controller = "Lesson"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetLessonsForReceptionist(Int32, System.DateTime) on controller Pegasus_backend.Controllers.LessonController (Pegasus_backend).
2019-07-17 12:22:16.461 +12:00 [INF] Executing action method Pegasus_backend.Controllers.LessonController.GetLessonsForReceptionist (Pegasus_backend) - Validation state: "Valid"
2019-07-17 12:22:16.462 +12:00 [INF] Entity Framework Core 2.1.11-servicing-32099 initialized 'ablemusicContext' using provider 'MySql.Data.EntityFrameworkCore' with options: None
2019-07-17 12:22:16.643 +12:00 [INF] Executed DbCommand (54ms) [Parameters=[@__8__locals1_userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT `s`.`staff_id`, `s`.`dob`, `s`.`email`, `s`.`expiry_date`, `s`.`first_name`, `s`.`gender`, `s`.`home_phone`, `s`.`id_number`, `s`.`id_photo`, `s`.`id_type`, `s`.`ird_number`, `s`.`is_activate`, `s`.`last_name`, `s`.`mobile_phone`, `s`.`photo`, `s`.`user_id`, `s`.`visa`
FROM `ablemusic`.`staff` AS `s`
WHERE `s`.`user_id` = @__8__locals1_userId_0
LIMIT 1
2019-07-17 12:22:16.823 +12:00 [INF] Executed DbCommand (50ms) [Parameters=[@__staff_StaffId_0='?' (DbType = Int16)], CommandType='"Text"', CommandTimeout='30']
SELECT `s`.`staff_org_id`, `s`.`is_activate`, `s`.`org_id`, `s`.`staff_id`
FROM `ablemusic`.`staff_org` AS `s`
WHERE `s`.`staff_id` = @__staff_StaffId_0
LIMIT 1
2019-07-17 12:22:16.842 +12:00 [WRN] The Include operation for navigation '[s].CourseInstance' is unnecessary and was ignored because the navigation is not reachable in the final query results. See https://go.microsoft.com/fwlink/?linkid=850303 for more information.
2019-07-17 12:22:16.842 +12:00 [WRN] The Include operation for navigation '[s].Learner' is unnecessary and was ignored because the navigation is not reachable in the final query results. See https://go.microsoft.com/fwlink/?linkid=850303 for more information.
2019-07-17 12:22:16.842 +12:00 [WRN] The Include operation for navigation '[s].Teacher' is unnecessary and was ignored because the navigation is not reachable in the final query results. See https://go.microsoft.com/fwlink/?linkid=850303 for more information.
2019-07-17 12:22:16.842 +12:00 [WRN] The Include operation for navigation '[s].Room' is unnecessary and was ignored because the navigation is not reachable in the final query results. See https://go.microsoft.com/fwlink/?linkid=850303 for more information.
2019-07-17 12:22:16.842 +12:00 [WRN] The Include operation for navigation '[s].Org' is unnecessary and was ignored because the navigation is not reachable in the final query results. See https://go.microsoft.com/fwlink/?linkid=850303 for more information.
2019-07-17 12:22:16.842 +12:00 [WRN] The Include operation for navigation '[s].TrialCourse' is unnecessary and was ignored because the navigation is not reachable in the final query results. See https://go.microsoft.com/fwlink/?linkid=850303 for more information.
2019-07-17 12:22:16.842 +12:00 [WRN] The Include operation for navigation '[s].GroupCourseInstance.LearnerGroupCourse.Learner' is unnecessary and was ignored because the navigation is not reachable in the final query results. See https://go.microsoft.com/fwlink/?linkid=850303 for more information.
2019-07-17 12:22:16.842 +12:00 [WRN] The Include operation for navigation '[s].AwaitMakeUpLessonNewLesson' is unnecessary and was ignored because the navigation is not reachable in the final query results. See https://go.microsoft.com/fwlink/?linkid=850303 for more information.
2019-07-17 12:22:16.871 +12:00 [WRN] The LINQ expression 'where ((((Convert(Convert([s].OrgId, Int32), Nullable`1) == Convert(__orgId_0, Nullable`1)) AndAlso (Convert([s].BeginTime, DateTime).Year == __8__locals1_date_Year_1)) AndAlso (Convert([s].BeginTime, DateTime).Month == __8__locals1_date_Month_2)) AndAlso (Convert([s].BeginTime, DateTime).Day == __8__locals1_date_Day_3))' could not be translated and will be evaluated locally.
2019-07-17 12:22:17.158 +12:00 [INF] Executed DbCommand (103ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT `s.CourseInstance`.`course_instance_id`, `s.CourseInstance`.`begin_date`, `s.CourseInstance`.`course_id`, `s.CourseInstance`.`end_date`, `s.CourseInstance`.`invoice_date`, `s.CourseInstance`.`learner_id`, `s.CourseInstance`.`org_id`, `s.CourseInstance`.`room_id`, `s.CourseInstance`.`teacher_id`, `s.GroupCourseInstance`.`group_course_instance_id`, `s.GroupCourseInstance`.`begin_date`, `s.GroupCourseInstance`.`course_id`, `s.GroupCourseInstance`.`end_date`, `s.GroupCourseInstance`.`invoice_date`, `s.GroupCourseInstance`.`is_activate`, `s.GroupCourseInstance`.`is_started`, `s.GroupCourseInstance`.`org_id`, `s.GroupCourseInstance`.`room_id`, `s.GroupCourseInstance`.`teacher_id`, `s`.`org_id` AS `OrgId`, `s`.`begin_time` AS `start`, `s`.`lesson_id` AS `id`, `s`.`room_id` AS `resourceId`, `s`.`end_time` AS `end`, `s.Teacher`.`first_name` AS `TeacherFirstName0`, `s`.`is_canceled` AS `IsCanceled`, `s`.`is_confirm` AS `IsConfirm`, `s`.`is_changed` AS `IsChanged`, (
    SELECT `z`.`first_name`
    FROM `ablemusic`.`teacher` AS `z`
    WHERE `z`.`teacher_id` = (
        SELECT `r`.`teacher_id`
        FROM `ablemusic`.`lesson` AS `r`
        WHERE `r`.`lesson_id` = `s`.`new_lesson_id`
        LIMIT 1
    )
    LIMIT 1
) AS `TeacherFirstName`, (
    SELECT `z0`.`last_name`
    FROM `ablemusic`.`teacher` AS `z0`
    WHERE `z0`.`teacher_id` = (
        SELECT `r0`.`teacher_id`
        FROM `ablemusic`.`lesson` AS `r0`
        WHERE `r0`.`lesson_id` = `s`.`new_lesson_id`
        LIMIT 1
    )
    LIMIT 1
) AS `TeacherLastName`, (
    SELECT `z1`.`room_name`
    FROM `ablemusic`.`room` AS `z1`
    WHERE `z1`.`room_id` = (
        SELECT `r1`.`room_id`
        FROM `ablemusic`.`lesson` AS `r1`
        WHERE `r1`.`lesson_id` = `s`.`new_lesson_id`
        LIMIT 1
    )
    LIMIT 1
) AS `RoomName`, (
    SELECT `z2`.`org_name`
    FROM `ablemusic`.`org` AS `z2`
    WHERE `z2`.`org_id` = (
        SELECT `r2`.`org_id`
        FROM `ablemusic`.`lesson` AS `r2`
        WHERE `r2`.`lesson_id` = `s`.`new_lesson_id`
        LIMIT 1
    )
    LIMIT 1
) AS `OrgName`, (
    SELECT `r3`.`begin_time`
    FROM `ablemusic`.`lesson` AS `r3`
    WHERE `r3`.`lesson_id` = `s`.`new_lesson_id`
    LIMIT 1
) AS `BeginTime`, `s`.`reason`, CASE
    WHEN `s`.`is_paid` = 1
    THEN 0 ELSE 1
END, CASE
    WHEN (
        SELECT `q1`.`quantity`
        FROM `ablemusic`.`lesson_remain` AS `q1`
        WHERE ((`q1`.`learner_id` = `s`.`learner_id`) OR (`q1`.`learner_id` IS NULL AND `s`.`learner_id` IS NULL)) AND ((`q1`.`course_instance_id` = `s`.`course_instance_id`) OR (`q1`.`course_instance_id` IS NULL AND `s`.`course_instance_id` IS NULL))
        LIMIT 1
    ) <= 3
    THEN 1 ELSE 0
END, `s.Learner`.`first_name` AS `FirstName`, `s`.`learner_id` AS `LearnerId`, `s.Room`.`room_name` AS `RoomName0`, `s.Org`.`org_name` AS `OrgName0`, `s`.`teacher_id` AS `TeacherId`, `s.GroupCourseInstance.Course`.`course_name`, `s.TrialCourse`.`course_name`, `s.CourseInstance.Course`.`course_name`, `s.GroupCourseInstance.Course`.`course_id`, `s`.`trial_course_id`, `s.CourseInstance.Course`.`course_id`, `s`.`learner_id` AS `LearnerId0`
FROM `ablemusic`.`lesson` AS `s`
LEFT JOIN `ablemusic`.`course` AS `s.TrialCourse` ON `s`.`trial_course_id` = `s.TrialCourse`.`course_id`
INNER JOIN `ablemusic`.`org` AS `s.Org` ON `s`.`org_id` = `s.Org`.`org_id`
LEFT JOIN `ablemusic`.`room` AS `s.Room` ON `s`.`room_id` = `s.Room`.`room_id`
LEFT JOIN `ablemusic`.`learner` AS `s.Learner` ON `s`.`learner_id` = `s.Learner`.`learner_id`
LEFT JOIN `ablemusic`.`teacher` AS `s.Teacher` ON `s`.`teacher_id` = `s.Teacher`.`teacher_id`
LEFT JOIN `ablemusic`.`one2one_course_instance` AS `s.CourseInstance` ON `s`.`course_instance_id` = `s.CourseInstance`.`course_instance_id`
LEFT JOIN `ablemusic`.`course` AS `s.CourseInstance.Course` ON `s.CourseInstance`.`course_id` = `s.CourseInstance.Course`.`course_id`
LEFT JOIN `ablemusic`.`group_course_instance` AS `s.GroupCourseInstance` ON `s`.`group_course_instance_id` = `s.GroupCourseInstance`.`group_course_instance_id`
LEFT JOIN `ablemusic`.`course` AS `s.GroupCourseInstance.Course` ON `s.GroupCourseInstance`.`course_id` = `s.GroupCourseInstance.Course`.`course_id`
2019-07-17 12:22:17.347 +12:00 [INF] Executed action method Pegasus_backend.Controllers.LessonController.GetLessonsForReceptionist (Pegasus_backend), returned result Microsoft.AspNetCore.Mvc.OkObjectResult in 885.1785000000001ms.
2019-07-17 12:22:17.347 +12:00 [INF] Executing ObjectResult, writing value of type 'Pegasus_backend.Models.Result`1[[System.Object, System.Private.CoreLib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2019-07-17 12:22:17.347 +12:00 [INF] Executed action Pegasus_backend.Controllers.LessonController.GetLessonsForReceptionist (Pegasus_backend) in 886.26470000000006ms
2019-07-17 12:22:17.348 +12:00 [INF] Request finished in 887.6883ms 200 application/json; charset=utf-8
2019-07-17 12:22:42.185 +12:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/api/teacherfilter/sessionEditFilter/2  
2019-07-17 12:22:42.185 +12:00 [INF] Policy execution successful.
2019-07-17 12:22:42.186 +12:00 [INF] Route matched with {action = "sessionEditFilterGet", controller = "TeacherFilter"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] sessionEditFilterGet(Int32) on controller Pegasus_backend.Controllers.TeacherFilterController (Pegasus_backend).
2019-07-17 12:22:42.186 +12:00 [INF] Executing action method Pegasus_backend.Controllers.TeacherFilterController.sessionEditFilterGet (Pegasus_backend) - Validation state: "Valid"
2019-07-17 12:22:42.194 +12:00 [INF] Entity Framework Core 2.1.11-servicing-32099 initialized 'ablemusicContext' using provider 'MySql.Data.EntityFrameworkCore' with options: None
2019-07-17 12:22:44.154 +12:00 [INF] Executed DbCommand (57ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT `o`.`org_id` AS `OrgId`, `o`.`org_name` AS `OrgName`
FROM `ablemusic`.`org` AS `o`
2019-07-17 12:22:44.606 +12:00 [INF] Executed DbCommand (52ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT `r`.`room_id` AS `RoomId`, `r`.`room_name` AS `RoomName`, `r`.`org_id` AS `OrgId`
FROM `ablemusic`.`room` AS `r`
2019-07-17 12:22:44.814 +12:00 [INF] Executed DbCommand (57ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT `t`.`teacher_id` AS `TeacherId`, `t`.`first_name` AS `TeacherFirstName`, `t`.`last_name` AS `TeacherLastName`, `ta`.`org_id` AS `TeacherAvailableOrgId`, `t`.`level` AS `TeacherLevelId`
FROM `ablemusic`.`teacher` AS `t`
INNER JOIN `ablemusic`.`available_days` AS `ta` ON `t`.`teacher_id` = `ta`.`teacher_id`
INNER JOIN `ablemusic`.`teacher_course` AS `tc` ON `t`.`teacher_id` = `tc`.`teacher_id`
WHERE `tc`.`course_id` = @__courseId_0
ORDER BY `t`.`teacher_id`, `ta`.`org_id`
2019-07-17 12:22:44.815 +12:00 [INF] Executed action method Pegasus_backend.Controllers.TeacherFilterController.sessionEditFilterGet (Pegasus_backend), returned result Microsoft.AspNetCore.Mvc.OkObjectResult in 2629.2254000000003ms.
2019-07-17 12:22:44.815 +12:00 [INF] Executing ObjectResult, writing value of type 'Pegasus_backend.Models.Result`1[[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2019-07-17 12:22:44.816 +12:00 [INF] Executed action Pegasus_backend.Controllers.TeacherFilterController.sessionEditFilterGet (Pegasus_backend) in 2630.1679ms
2019-07-17 12:22:44.816 +12:00 [INF] Request finished in 2630.7991ms 200 application/json; charset=utf-8
2019-07-17 12:23:52.139 +12:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5000/api/LessonRearrange/3  
2019-07-17 12:23:52.139 +12:00 [INF] Policy execution successful.
2019-07-17 12:23:52.139 +12:00 [INF] Request finished in 0.508ms 204 
2019-07-17 12:23:52.164 +12:00 [INF] Request starting HTTP/1.1 PUT http://localhost:5000/api/LessonRearrange/3 application/json 117
2019-07-17 12:23:52.166 +12:00 [INF] Policy execution successful.
2019-07-17 12:23:52.171 +12:00 [INF] Route matched with {action = "PutLesson", controller = "LessonRearrange"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] PutLesson(Int16, Pegasus_backend.Models.LessonViewModel) on controller Pegasus_backend.Controllers.LessonRearrangeController (Pegasus_backend).
2019-07-17 12:23:52.176 +12:00 [INF] Executing action method Pegasus_backend.Controllers.LessonRearrangeController.PutLesson (Pegasus_backend) - Validation state: "Valid"
2019-07-17 12:23:52.178 +12:00 [INF] Entity Framework Core 2.1.11-servicing-32099 initialized 'ablemusicContext' using provider 'MySql.Data.EntityFrameworkCore' with options: None
2019-07-17 12:23:52.366 +12:00 [INF] Executed DbCommand (54ms) [Parameters=[@__newLesson_LessonId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT `l`.`lesson_id`, `l`.`begin_time`, `l`.`course_instance_id`, `l`.`created_at`, `l`.`end_time`, `l`.`group_course_instance_id`, `l`.`invoice_id`, `l`.`is_canceled`, `l`.`is_changed`, `l`.`is_confirm`, `l`.`is_paid`, `l`.`is_trial`, `l`.`learner_id`, `l`.`new_lesson_id`, `l`.`org_id`, `l`.`reason`, `l`.`room_id`, `l`.`teacher_id`, `l`.`trial_course_id`
FROM `ablemusic`.`lesson` AS `l`
WHERE `l`.`lesson_id` = @__newLesson_LessonId_0
LIMIT 1
2019-07-17 12:23:53.739 +12:00 [INF] Executed DbCommand (55ms) [Parameters=[@__oldLesson_LearnerId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT `l`.`learner_id`, `l`.`address`, `l`.`comment`, `l`.`contact_num`, `l`.`created_at`, `l`.`dob`, `l`.`email`, `l`.`enroll_date`, `l`.`first_name`, `l`.`form_url`, `l`.`g5_certification`, `l`.`gender`, `l`.`is_abrsm_g5`, `l`.`is_active`, `l`.`is_under_18`, `l`.`last_name`, `l`.`learner_level`, `l`.`level_type`, `l`.`middle_name`, `l`.`note`, `l`.`org_id`, `l`.`otherfile_url`, `l`.`payment_period`, `l`.`photo`, `l`.`referrer`, `l`.`referrer_learner_id`, `l`.`user_id`
FROM `ablemusic`.`learner` AS `l`
WHERE `l`.`learner_id` = @__oldLesson_LearnerId_0
LIMIT 1
2019-07-17 12:23:53.920 +12:00 [INF] Executed DbCommand (52ms) [Parameters=[@__newLesson_LessonId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT `c`.`course_id` AS `CourseId`, `c`.`course_name` AS `CourseName`
FROM `ablemusic`.`course` AS `c`
INNER JOIN `ablemusic`.`one2one_course_instance` AS `oto` ON `c`.`course_id` = `oto`.`course_id`
INNER JOIN `ablemusic`.`lesson` AS `l` ON `oto`.`course_instance_id` = `l`.`course_instance_id`
WHERE `l`.`lesson_id` = @__newLesson_LessonId_0
LIMIT 1
2019-07-17 12:23:54.104 +12:00 [INF] Executed DbCommand (56ms) [Parameters=[@__newLesson_TeacherId_0='?' (DbType = Int16)], CommandType='"Text"', CommandTimeout='30']
SELECT `t`.`teacher_id`, `t`.`ability`, `t`.`comment`, `t`.`cv_url`, `t`.`dob`, `t`.`email`, `t`.`expiry_date`, `t`.`first_name`, `t`.`form_url`, `t`.`gender`, `t`.`home_phone`, `t`.`id_number`, `t`.`id_photo`, `t`.`id_type`, `t`.`invoice_template`, `t`.`ird_number`, `t`.`is_activate`, `t`.`is_contract`, `t`.`is_left`, `t`.`last_name`, `t`.`level`, `t`.`minimum_hours`, `t`.`mobile_phone`, `t`.`otherfile_url`, `t`.`photo`, `t`.`user_id`, `t`.`visa`
FROM `ablemusic`.`teacher` AS `t`
WHERE `t`.`teacher_id` = @__newLesson_TeacherId_0
LIMIT 1
2019-07-17 12:23:54.315 +12:00 [INF] Executed DbCommand (63ms) [Parameters=[@__oldLesson_TeacherId_0='?' (DbType = Int16)], CommandType='"Text"', CommandTimeout='30']
SELECT `t`.`teacher_id`, `t`.`ability`, `t`.`comment`, `t`.`cv_url`, `t`.`dob`, `t`.`email`, `t`.`expiry_date`, `t`.`first_name`, `t`.`form_url`, `t`.`gender`, `t`.`home_phone`, `t`.`id_number`, `t`.`id_photo`, `t`.`id_type`, `t`.`invoice_template`, `t`.`ird_number`, `t`.`is_activate`, `t`.`is_contract`, `t`.`is_left`, `t`.`last_name`, `t`.`level`, `t`.`minimum_hours`, `t`.`mobile_phone`, `t`.`otherfile_url`, `t`.`photo`, `t`.`user_id`, `t`.`visa`
FROM `ablemusic`.`teacher` AS `t`
WHERE `t`.`teacher_id` = @__oldLesson_TeacherId_0
LIMIT 1
2019-07-17 12:23:54.487 +12:00 [INF] Executed DbCommand (52ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT `h`.`holiday_id`, `h`.`holiday_date`, `h`.`holiday_name`
FROM `ablemusic`.`holiday` AS `h`
2019-07-17 12:23:54.700 +12:00 [INF] Executed DbCommand (52ms) [Parameters=[@__oldLesson_OrgId_0='?' (DbType = Int16)], CommandType='"Text"', CommandTimeout='30']
SELECT `o`.`org_id`, `o`.`abbr`, `o`.`address`, `o`.`email`, `o`.`is_activate`, `o`.`is_headoffice`, `o`.`localtion_x`, `o`.`localtion_y`, `o`.`org_name`, `o`.`phone`
FROM `ablemusic`.`org` AS `o`
WHERE `o`.`org_id` = @__oldLesson_OrgId_0
LIMIT 1
2019-07-17 12:23:54.879 +12:00 [INF] Executed DbCommand (52ms) [Parameters=[@__oldLesson_RoomId_0='?' (DbType = Int16)], CommandType='"Text"', CommandTimeout='30']
SELECT `r`.`room_id`, `r`.`created_at`, `r`.`is_activate`, `r`.`org_id`, `r`.`room_name`
FROM `ablemusic`.`room` AS `r`
WHERE `r`.`room_id` = @__oldLesson_RoomId_0
LIMIT 1
2019-07-17 12:23:55.067 +12:00 [INF] Executed DbCommand (55ms) [Parameters=[@__newLesson_RoomId_0='?' (DbType = Int16)], CommandType='"Text"', CommandTimeout='30']
SELECT `r`.`room_id`, `r`.`created_at`, `r`.`is_activate`, `r`.`org_id`, `r`.`room_name`
FROM `ablemusic`.`room` AS `r`
WHERE `r`.`room_id` = @__newLesson_RoomId_0
LIMIT 1
2019-07-17 12:23:55.365 +12:00 [INF] Executed DbCommand (52ms) [Parameters=[@p2='?' (DbType = Int32), @p0='?' (DbType = Int16), @p1='?' (Size = -1)], CommandType='"Text"', CommandTimeout='30']
UPDATE `ablemusic`.`lesson` SET `is_canceled` = @p0, `reason` = @p1
WHERE `lesson_id` = @p2;
SELECT ROW_COUNT();
2019-07-17 12:23:55.428 +12:00 [INF] Executed DbCommand (62ms) [Parameters=[@p3='?' (DbType = DateTime), @p4='?' (DbType = Int32), @p5='?' (DbType = DateTime), @p6='?' (DbType = DateTime), @p7='?' (DbType = AnsiString), @p8='?' (DbType = Int32), @p9='?' (DbType = Int16), @p10='?' (DbType = Int16), @p11='?' (DbType = AnsiString), @p12='?' (DbType = AnsiString), @p13='?' (DbType = Byte), @p14='?' (DbType = Int32), @p15='?' (DbType = AnsiString), @p16='?' (DbType = Int16), @p17='?' (Size = -1), @p18='?' (DbType = Int16), @p19='?' (DbType = Int16), @p20='?' (DbType = AnsiString)], CommandType='"Text"', CommandTimeout='30']
INSERT INTO `ablemusic`.`lesson` (`begin_time`, `course_instance_id`, `created_at`, `end_time`, `group_course_instance_id`, `invoice_id`, `is_canceled`, `is_changed`, `is_confirm`, `is_paid`, `is_trial`, `learner_id`, `new_lesson_id`, `org_id`, `reason`, `room_id`, `teacher_id`, `trial_course_id`)
VALUES (@p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11, @p12, @p13, @p14, @p15, @p16, @p17, @p18, @p19, @p20);
SELECT `lesson_id`
FROM `ablemusic`.`lesson`
WHERE ROW_COUNT() = 1
 AND `lesson_id`=LAST_INSERT_ID();
2019-07-17 12:23:56.461 +12:00 [INF] Executed action method Pegasus_backend.Controllers.LessonRearrangeController.PutLesson (Pegasus_backend), returned result Microsoft.AspNetCore.Mvc.OkObjectResult in 4284.9462ms.
2019-07-17 12:23:56.462 +12:00 [INF] Executing ObjectResult, writing value of type 'Pegasus_backend.Models.Result`1[[Pegasus_backend.pegasusContext.Lesson, Pegasus_backend, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2019-07-17 12:23:56.466 +12:00 [INF] Executed action Pegasus_backend.Controllers.LessonRearrangeController.PutLesson (Pegasus_backend) in 4295.4703ms
2019-07-17 12:23:56.467 +12:00 [INF] Request finished in 4302.761ms 200 application/json; charset=utf-8
2019-07-17 12:26:35.840 +12:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5000/api/lesson/GetLessonsForReceptionist/3/2019-07-20  
2019-07-17 12:26:35.840 +12:00 [INF] Policy execution successful.
2019-07-17 12:26:35.841 +12:00 [INF] Request finished in 0.4357ms 204 
2019-07-17 12:26:35.859 +12:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/api/lesson/GetLessonsForReceptionist/3/2019-07-20  
2019-07-17 12:26:35.860 +12:00 [INF] Policy execution successful.
2019-07-17 12:26:35.864 +12:00 [INF] Successfully validated the token.
2019-07-17 12:26:35.864 +12:00 [INF] Route matched with {action = "GetLessonsForReceptionist", controller = "Lesson"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetLessonsForReceptionist(Int32, System.DateTime) on controller Pegasus_backend.Controllers.LessonController (Pegasus_backend).
2019-07-17 12:26:35.865 +12:00 [INF] Executing action method Pegasus_backend.Controllers.LessonController.GetLessonsForReceptionist (Pegasus_backend) - Validation state: "Valid"
2019-07-17 12:26:35.866 +12:00 [INF] Entity Framework Core 2.1.11-servicing-32099 initialized 'ablemusicContext' using provider 'MySql.Data.EntityFrameworkCore' with options: None
2019-07-17 12:26:36.056 +12:00 [INF] Executed DbCommand (56ms) [Parameters=[@__8__locals1_userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT `s`.`staff_id`, `s`.`dob`, `s`.`email`, `s`.`expiry_date`, `s`.`first_name`, `s`.`gender`, `s`.`home_phone`, `s`.`id_number`, `s`.`id_photo`, `s`.`id_type`, `s`.`ird_number`, `s`.`is_activate`, `s`.`last_name`, `s`.`mobile_phone`, `s`.`photo`, `s`.`user_id`, `s`.`visa`
FROM `ablemusic`.`staff` AS `s`
WHERE `s`.`user_id` = @__8__locals1_userId_0
LIMIT 1
2019-07-17 12:26:36.227 +12:00 [INF] Executed DbCommand (49ms) [Parameters=[@__staff_StaffId_0='?' (DbType = Int16)], CommandType='"Text"', CommandTimeout='30']
SELECT `s`.`staff_org_id`, `s`.`is_activate`, `s`.`org_id`, `s`.`staff_id`
FROM `ablemusic`.`staff_org` AS `s`
WHERE `s`.`staff_id` = @__staff_StaffId_0
LIMIT 1
2019-07-17 12:26:36.249 +12:00 [WRN] The Include operation for navigation '[s].CourseInstance' is unnecessary and was ignored because the navigation is not reachable in the final query results. See https://go.microsoft.com/fwlink/?linkid=850303 for more information.
2019-07-17 12:26:36.249 +12:00 [WRN] The Include operation for navigation '[s].Learner' is unnecessary and was ignored because the navigation is not reachable in the final query results. See https://go.microsoft.com/fwlink/?linkid=850303 for more information.
2019-07-17 12:26:36.249 +12:00 [WRN] The Include operation for navigation '[s].Teacher' is unnecessary and was ignored because the navigation is not reachable in the final query results. See https://go.microsoft.com/fwlink/?linkid=850303 for more information.
2019-07-17 12:26:36.249 +12:00 [WRN] The Include operation for navigation '[s].Room' is unnecessary and was ignored because the navigation is not reachable in the final query results. See https://go.microsoft.com/fwlink/?linkid=850303 for more information.
2019-07-17 12:26:36.249 +12:00 [WRN] The Include operation for navigation '[s].Org' is unnecessary and was ignored because the navigation is not reachable in the final query results. See https://go.microsoft.com/fwlink/?linkid=850303 for more information.
2019-07-17 12:26:36.249 +12:00 [WRN] The Include operation for navigation '[s].TrialCourse' is unnecessary and was ignored because the navigation is not reachable in the final query results. See https://go.microsoft.com/fwlink/?linkid=850303 for more information.
2019-07-17 12:26:36.249 +12:00 [WRN] The Include operation for navigation '[s].GroupCourseInstance.LearnerGroupCourse.Learner' is unnecessary and was ignored because the navigation is not reachable in the final query results. See https://go.microsoft.com/fwlink/?linkid=850303 for more information.
2019-07-17 12:26:36.249 +12:00 [WRN] The Include operation for navigation '[s].AwaitMakeUpLessonNewLesson' is unnecessary and was ignored because the navigation is not reachable in the final query results. See https://go.microsoft.com/fwlink/?linkid=850303 for more information.
2019-07-17 12:26:36.286 +12:00 [WRN] The LINQ expression 'where ((((Convert(Convert([s].OrgId, Int32), Nullable`1) == Convert(__orgId_0, Nullable`1)) AndAlso (Convert([s].BeginTime, DateTime).Year == __8__locals1_date_Year_1)) AndAlso (Convert([s].BeginTime, DateTime).Month == __8__locals1_date_Month_2)) AndAlso (Convert([s].BeginTime, DateTime).Day == __8__locals1_date_Day_3))' could not be translated and will be evaluated locally.
2019-07-17 12:26:36.564 +12:00 [INF] Executed DbCommand (108ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT `s.CourseInstance`.`course_instance_id`, `s.CourseInstance`.`begin_date`, `s.CourseInstance`.`course_id`, `s.CourseInstance`.`end_date`, `s.CourseInstance`.`invoice_date`, `s.CourseInstance`.`learner_id`, `s.CourseInstance`.`org_id`, `s.CourseInstance`.`room_id`, `s.CourseInstance`.`teacher_id`, `s.GroupCourseInstance`.`group_course_instance_id`, `s.GroupCourseInstance`.`begin_date`, `s.GroupCourseInstance`.`course_id`, `s.GroupCourseInstance`.`end_date`, `s.GroupCourseInstance`.`invoice_date`, `s.GroupCourseInstance`.`is_activate`, `s.GroupCourseInstance`.`is_started`, `s.GroupCourseInstance`.`org_id`, `s.GroupCourseInstance`.`room_id`, `s.GroupCourseInstance`.`teacher_id`, `s`.`org_id` AS `OrgId`, `s`.`begin_time` AS `start`, `s`.`lesson_id` AS `id`, `s`.`room_id` AS `resourceId`, `s`.`end_time` AS `end`, `s.Teacher`.`first_name` AS `TeacherFirstName0`, `s`.`is_canceled` AS `IsCanceled`, `s`.`is_confirm` AS `IsConfirm`, `s`.`is_changed` AS `IsChanged`, (
    SELECT `z`.`first_name`
    FROM `ablemusic`.`teacher` AS `z`
    WHERE `z`.`teacher_id` = (
        SELECT `r`.`teacher_id`
        FROM `ablemusic`.`lesson` AS `r`
        WHERE `r`.`lesson_id` = `s`.`new_lesson_id`
        LIMIT 1
    )
    LIMIT 1
) AS `TeacherFirstName`, (
    SELECT `z0`.`last_name`
    FROM `ablemusic`.`teacher` AS `z0`
    WHERE `z0`.`teacher_id` = (
        SELECT `r0`.`teacher_id`
        FROM `ablemusic`.`lesson` AS `r0`
        WHERE `r0`.`lesson_id` = `s`.`new_lesson_id`
        LIMIT 1
    )
    LIMIT 1
) AS `TeacherLastName`, (
    SELECT `z1`.`room_name`
    FROM `ablemusic`.`room` AS `z1`
    WHERE `z1`.`room_id` = (
        SELECT `r1`.`room_id`
        FROM `ablemusic`.`lesson` AS `r1`
        WHERE `r1`.`lesson_id` = `s`.`new_lesson_id`
        LIMIT 1
    )
    LIMIT 1
) AS `RoomName`, (
    SELECT `z2`.`org_name`
    FROM `ablemusic`.`org` AS `z2`
    WHERE `z2`.`org_id` = (
        SELECT `r2`.`org_id`
        FROM `ablemusic`.`lesson` AS `r2`
        WHERE `r2`.`lesson_id` = `s`.`new_lesson_id`
        LIMIT 1
    )
    LIMIT 1
) AS `OrgName`, (
    SELECT `r3`.`begin_time`
    FROM `ablemusic`.`lesson` AS `r3`
    WHERE `r3`.`lesson_id` = `s`.`new_lesson_id`
    LIMIT 1
) AS `BeginTime`, `s`.`reason`, CASE
    WHEN `s`.`is_paid` = 1
    THEN 0 ELSE 1
END, CASE
    WHEN (
        SELECT `q1`.`quantity`
        FROM `ablemusic`.`lesson_remain` AS `q1`
        WHERE ((`q1`.`learner_id` = `s`.`learner_id`) OR (`q1`.`learner_id` IS NULL AND `s`.`learner_id` IS NULL)) AND ((`q1`.`course_instance_id` = `s`.`course_instance_id`) OR (`q1`.`course_instance_id` IS NULL AND `s`.`course_instance_id` IS NULL))
        LIMIT 1
    ) <= 3
    THEN 1 ELSE 0
END, `s.Learner`.`first_name` AS `FirstName`, `s`.`learner_id` AS `LearnerId`, `s.Room`.`room_name` AS `RoomName0`, `s.Org`.`org_name` AS `OrgName0`, `s`.`teacher_id` AS `TeacherId`, `s.GroupCourseInstance.Course`.`course_name`, `s.TrialCourse`.`course_name`, `s.CourseInstance.Course`.`course_name`, `s.GroupCourseInstance.Course`.`course_id`, `s`.`trial_course_id`, `s.CourseInstance.Course`.`course_id`, `s`.`learner_id` AS `LearnerId0`
FROM `ablemusic`.`lesson` AS `s`
LEFT JOIN `ablemusic`.`course` AS `s.TrialCourse` ON `s`.`trial_course_id` = `s.TrialCourse`.`course_id`
INNER JOIN `ablemusic`.`org` AS `s.Org` ON `s`.`org_id` = `s.Org`.`org_id`
LEFT JOIN `ablemusic`.`room` AS `s.Room` ON `s`.`room_id` = `s.Room`.`room_id`
LEFT JOIN `ablemusic`.`learner` AS `s.Learner` ON `s`.`learner_id` = `s.Learner`.`learner_id`
LEFT JOIN `ablemusic`.`teacher` AS `s.Teacher` ON `s`.`teacher_id` = `s.Teacher`.`teacher_id`
LEFT JOIN `ablemusic`.`one2one_course_instance` AS `s.CourseInstance` ON `s`.`course_instance_id` = `s.CourseInstance`.`course_instance_id`
LEFT JOIN `ablemusic`.`course` AS `s.CourseInstance.Course` ON `s.CourseInstance`.`course_id` = `s.CourseInstance.Course`.`course_id`
LEFT JOIN `ablemusic`.`group_course_instance` AS `s.GroupCourseInstance` ON `s`.`group_course_instance_id` = `s.GroupCourseInstance`.`group_course_instance_id`
LEFT JOIN `ablemusic`.`course` AS `s.GroupCourseInstance.Course` ON `s.GroupCourseInstance`.`course_id` = `s.GroupCourseInstance.Course`.`course_id`
2019-07-17 12:26:36.806 +12:00 [INF] Executed action method Pegasus_backend.Controllers.LessonController.GetLessonsForReceptionist (Pegasus_backend), returned result Microsoft.AspNetCore.Mvc.OkObjectResult in 940.80810000000008ms.
2019-07-17 12:26:36.806 +12:00 [INF] Executing ObjectResult, writing value of type 'Pegasus_backend.Models.Result`1[[System.Object, System.Private.CoreLib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2019-07-17 12:26:36.807 +12:00 [INF] Executed action Pegasus_backend.Controllers.LessonController.GetLessonsForReceptionist (Pegasus_backend) in 942.61830000000009ms
2019-07-17 12:26:36.808 +12:00 [INF] Request finished in 949.0384ms 200 application/json; charset=utf-8
2019-07-17 12:26:49.600 +12:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5000/api/LessonRearrange/3  
2019-07-17 12:26:49.601 +12:00 [INF] Policy execution successful.
2019-07-17 12:26:49.601 +12:00 [INF] Request finished in 0.3848ms 204 
2019-07-17 12:26:49.611 +12:00 [INF] Request starting HTTP/1.1 PUT http://localhost:5000/api/LessonRearrange/3 application/json 139
2019-07-17 12:26:49.611 +12:00 [INF] Policy execution successful.
2019-07-17 12:26:49.611 +12:00 [INF] Route matched with {action = "PutLesson", controller = "LessonRearrange"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] PutLesson(Int16, Pegasus_backend.Models.LessonViewModel) on controller Pegasus_backend.Controllers.LessonRearrangeController (Pegasus_backend).
2019-07-17 12:26:49.612 +12:00 [INF] Executing action method Pegasus_backend.Controllers.LessonRearrangeController.PutLesson (Pegasus_backend) - Validation state: "Valid"
2019-07-17 12:26:49.612 +12:00 [INF] Entity Framework Core 2.1.11-servicing-32099 initialized 'ablemusicContext' using provider 'MySql.Data.EntityFrameworkCore' with options: None
2019-07-17 12:26:49.794 +12:00 [INF] Executed DbCommand (56ms) [Parameters=[@__newLesson_LessonId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT `l`.`lesson_id`, `l`.`begin_time`, `l`.`course_instance_id`, `l`.`created_at`, `l`.`end_time`, `l`.`group_course_instance_id`, `l`.`invoice_id`, `l`.`is_canceled`, `l`.`is_changed`, `l`.`is_confirm`, `l`.`is_paid`, `l`.`is_trial`, `l`.`learner_id`, `l`.`new_lesson_id`, `l`.`org_id`, `l`.`reason`, `l`.`room_id`, `l`.`teacher_id`, `l`.`trial_course_id`
FROM `ablemusic`.`lesson` AS `l`
WHERE `l`.`lesson_id` = @__newLesson_LessonId_0
LIMIT 1
2019-07-17 12:26:51.148 +12:00 [INF] Executed DbCommand (58ms) [Parameters=[@__oldLesson_LearnerId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT `l`.`learner_id`, `l`.`address`, `l`.`comment`, `l`.`contact_num`, `l`.`created_at`, `l`.`dob`, `l`.`email`, `l`.`enroll_date`, `l`.`first_name`, `l`.`form_url`, `l`.`g5_certification`, `l`.`gender`, `l`.`is_abrsm_g5`, `l`.`is_active`, `l`.`is_under_18`, `l`.`last_name`, `l`.`learner_level`, `l`.`level_type`, `l`.`middle_name`, `l`.`note`, `l`.`org_id`, `l`.`otherfile_url`, `l`.`payment_period`, `l`.`photo`, `l`.`referrer`, `l`.`referrer_learner_id`, `l`.`user_id`
FROM `ablemusic`.`learner` AS `l`
WHERE `l`.`learner_id` = @__oldLesson_LearnerId_0
LIMIT 1
2019-07-17 12:26:51.339 +12:00 [INF] Executed DbCommand (53ms) [Parameters=[@__newLesson_LessonId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT `c`.`course_id` AS `CourseId`, `c`.`course_name` AS `CourseName`
FROM `ablemusic`.`course` AS `c`
INNER JOIN `ablemusic`.`one2one_course_instance` AS `oto` ON `c`.`course_id` = `oto`.`course_id`
INNER JOIN `ablemusic`.`lesson` AS `l` ON `oto`.`course_instance_id` = `l`.`course_instance_id`
WHERE `l`.`lesson_id` = @__newLesson_LessonId_0
LIMIT 1
2019-07-17 12:26:51.502 +12:00 [INF] Executed DbCommand (55ms) [Parameters=[@__newLesson_TeacherId_0='?' (DbType = Int16)], CommandType='"Text"', CommandTimeout='30']
SELECT `t`.`teacher_id`, `t`.`ability`, `t`.`comment`, `t`.`cv_url`, `t`.`dob`, `t`.`email`, `t`.`expiry_date`, `t`.`first_name`, `t`.`form_url`, `t`.`gender`, `t`.`home_phone`, `t`.`id_number`, `t`.`id_photo`, `t`.`id_type`, `t`.`invoice_template`, `t`.`ird_number`, `t`.`is_activate`, `t`.`is_contract`, `t`.`is_left`, `t`.`last_name`, `t`.`level`, `t`.`minimum_hours`, `t`.`mobile_phone`, `t`.`otherfile_url`, `t`.`photo`, `t`.`user_id`, `t`.`visa`
FROM `ablemusic`.`teacher` AS `t`
WHERE `t`.`teacher_id` = @__newLesson_TeacherId_0
LIMIT 1
2019-07-17 12:26:51.675 +12:00 [INF] Executed DbCommand (49ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT `h`.`holiday_id`, `h`.`holiday_date`, `h`.`holiday_name`
FROM `ablemusic`.`holiday` AS `h`
2019-07-17 12:26:51.852 +12:00 [INF] Executed DbCommand (53ms) [Parameters=[@__oldLesson_OrgId_0='?' (DbType = Int16)], CommandType='"Text"', CommandTimeout='30']
SELECT `o`.`org_id`, `o`.`abbr`, `o`.`address`, `o`.`email`, `o`.`is_activate`, `o`.`is_headoffice`, `o`.`localtion_x`, `o`.`localtion_y`, `o`.`org_name`, `o`.`phone`
FROM `ablemusic`.`org` AS `o`
WHERE `o`.`org_id` = @__oldLesson_OrgId_0
LIMIT 1
2019-07-17 12:26:52.025 +12:00 [INF] Executed DbCommand (51ms) [Parameters=[@__oldLesson_RoomId_0='?' (DbType = Int16)], CommandType='"Text"', CommandTimeout='30']
SELECT `r`.`room_id`, `r`.`created_at`, `r`.`is_activate`, `r`.`org_id`, `r`.`room_name`
FROM `ablemusic`.`room` AS `r`
WHERE `r`.`room_id` = @__oldLesson_RoomId_0
LIMIT 1
2019-07-17 12:26:52.333 +12:00 [INF] Executed DbCommand (53ms) [Parameters=[@p2='?' (DbType = Int32), @p0='?' (DbType = Int16), @p1='?' (Size = -1)], CommandType='"Text"', CommandTimeout='30']
UPDATE `ablemusic`.`lesson` SET `is_canceled` = @p0, `reason` = @p1
WHERE `lesson_id` = @p2;
SELECT ROW_COUNT();
2019-07-17 12:26:52.392 +12:00 [INF] Executed DbCommand (58ms) [Parameters=[@p3='?' (DbType = DateTime), @p4='?' (DbType = Int32), @p5='?' (DbType = DateTime), @p6='?' (DbType = DateTime), @p7='?' (DbType = AnsiString), @p8='?' (DbType = Int32), @p9='?' (DbType = Int16), @p10='?' (DbType = Int16), @p11='?' (DbType = AnsiString), @p12='?' (DbType = AnsiString), @p13='?' (DbType = Byte), @p14='?' (DbType = Int32), @p15='?' (DbType = AnsiString), @p16='?' (DbType = Int16), @p17='?' (Size = -1), @p18='?' (DbType = Int16), @p19='?' (DbType = Int16), @p20='?' (DbType = AnsiString)], CommandType='"Text"', CommandTimeout='30']
INSERT INTO `ablemusic`.`lesson` (`begin_time`, `course_instance_id`, `created_at`, `end_time`, `group_course_instance_id`, `invoice_id`, `is_canceled`, `is_changed`, `is_confirm`, `is_paid`, `is_trial`, `learner_id`, `new_lesson_id`, `org_id`, `reason`, `room_id`, `teacher_id`, `trial_course_id`)
VALUES (@p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11, @p12, @p13, @p14, @p15, @p16, @p17, @p18, @p19, @p20);
SELECT `lesson_id`
FROM `ablemusic`.`lesson`
WHERE ROW_COUNT() = 1
 AND `lesson_id`=LAST_INSERT_ID();
2019-07-17 12:26:53.530 +12:00 [INF] Executed action method Pegasus_backend.Controllers.LessonRearrangeController.PutLesson (Pegasus_backend), returned result Microsoft.AspNetCore.Mvc.OkObjectResult in 3918.7230000000004ms.
2019-07-17 12:26:53.532 +12:00 [INF] Executing ObjectResult, writing value of type 'Pegasus_backend.Models.Result`1[[Pegasus_backend.pegasusContext.Lesson, Pegasus_backend, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2019-07-17 12:26:53.560 +12:00 [INF] Executed action Pegasus_backend.Controllers.LessonRearrangeController.PutLesson (Pegasus_backend) in 3948.6086ms
2019-07-17 12:26:53.560 +12:00 [INF] Request finished in 3949.5554ms 200 application/json; charset=utf-8
2019-07-17 12:26:54.699 +12:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5000/api/lesson/GetLessonsForReceptionist/3/2019-07-20  
2019-07-17 12:26:54.700 +12:00 [INF] Policy execution successful.
2019-07-17 12:26:54.705 +12:00 [INF] Request finished in 1.5121ms 204 
2019-07-17 12:26:54.717 +12:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/api/lesson/GetLessonsForReceptionist/3/2019-07-20  
2019-07-17 12:26:54.718 +12:00 [INF] Policy execution successful.
2019-07-17 12:26:54.718 +12:00 [INF] Successfully validated the token.
2019-07-17 12:26:54.718 +12:00 [INF] Route matched with {action = "GetLessonsForReceptionist", controller = "Lesson"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetLessonsForReceptionist(Int32, System.DateTime) on controller Pegasus_backend.Controllers.LessonController (Pegasus_backend).
2019-07-17 12:26:54.718 +12:00 [INF] Executing action method Pegasus_backend.Controllers.LessonController.GetLessonsForReceptionist (Pegasus_backend) - Validation state: "Valid"
2019-07-17 12:26:54.719 +12:00 [INF] Entity Framework Core 2.1.11-servicing-32099 initialized 'ablemusicContext' using provider 'MySql.Data.EntityFrameworkCore' with options: None
2019-07-17 12:26:54.918 +12:00 [INF] Executed DbCommand (52ms) [Parameters=[@__8__locals1_userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT `s`.`staff_id`, `s`.`dob`, `s`.`email`, `s`.`expiry_date`, `s`.`first_name`, `s`.`gender`, `s`.`home_phone`, `s`.`id_number`, `s`.`id_photo`, `s`.`id_type`, `s`.`ird_number`, `s`.`is_activate`, `s`.`last_name`, `s`.`mobile_phone`, `s`.`photo`, `s`.`user_id`, `s`.`visa`
FROM `ablemusic`.`staff` AS `s`
WHERE `s`.`user_id` = @__8__locals1_userId_0
LIMIT 1
2019-07-17 12:26:55.096 +12:00 [INF] Executed DbCommand (50ms) [Parameters=[@__staff_StaffId_0='?' (DbType = Int16)], CommandType='"Text"', CommandTimeout='30']
SELECT `s`.`staff_org_id`, `s`.`is_activate`, `s`.`org_id`, `s`.`staff_id`
FROM `ablemusic`.`staff_org` AS `s`
WHERE `s`.`staff_id` = @__staff_StaffId_0
LIMIT 1
2019-07-17 12:26:55.131 +12:00 [WRN] The Include operation for navigation '[s].CourseInstance' is unnecessary and was ignored because the navigation is not reachable in the final query results. See https://go.microsoft.com/fwlink/?linkid=850303 for more information.
2019-07-17 12:26:55.131 +12:00 [WRN] The Include operation for navigation '[s].Learner' is unnecessary and was ignored because the navigation is not reachable in the final query results. See https://go.microsoft.com/fwlink/?linkid=850303 for more information.
2019-07-17 12:26:55.131 +12:00 [WRN] The Include operation for navigation '[s].Teacher' is unnecessary and was ignored because the navigation is not reachable in the final query results. See https://go.microsoft.com/fwlink/?linkid=850303 for more information.
2019-07-17 12:26:55.131 +12:00 [WRN] The Include operation for navigation '[s].Room' is unnecessary and was ignored because the navigation is not reachable in the final query results. See https://go.microsoft.com/fwlink/?linkid=850303 for more information.
2019-07-17 12:26:55.131 +12:00 [WRN] The Include operation for navigation '[s].Org' is unnecessary and was ignored because the navigation is not reachable in the final query results. See https://go.microsoft.com/fwlink/?linkid=850303 for more information.
2019-07-17 12:26:55.131 +12:00 [WRN] The Include operation for navigation '[s].TrialCourse' is unnecessary and was ignored because the navigation is not reachable in the final query results. See https://go.microsoft.com/fwlink/?linkid=850303 for more information.
2019-07-17 12:26:55.131 +12:00 [WRN] The Include operation for navigation '[s].GroupCourseInstance.LearnerGroupCourse.Learner' is unnecessary and was ignored because the navigation is not reachable in the final query results. See https://go.microsoft.com/fwlink/?linkid=850303 for more information.
2019-07-17 12:26:55.132 +12:00 [WRN] The Include operation for navigation '[s].AwaitMakeUpLessonNewLesson' is unnecessary and was ignored because the navigation is not reachable in the final query results. See https://go.microsoft.com/fwlink/?linkid=850303 for more information.
2019-07-17 12:26:55.159 +12:00 [WRN] The LINQ expression 'where ((((Convert(Convert([s].OrgId, Int32), Nullable`1) == Convert(__orgId_0, Nullable`1)) AndAlso (Convert([s].BeginTime, DateTime).Year == __8__locals1_date_Year_1)) AndAlso (Convert([s].BeginTime, DateTime).Month == __8__locals1_date_Month_2)) AndAlso (Convert([s].BeginTime, DateTime).Day == __8__locals1_date_Day_3))' could not be translated and will be evaluated locally.
2019-07-17 12:26:55.547 +12:00 [INF] Executed DbCommand (223ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT `s.CourseInstance`.`course_instance_id`, `s.CourseInstance`.`begin_date`, `s.CourseInstance`.`course_id`, `s.CourseInstance`.`end_date`, `s.CourseInstance`.`invoice_date`, `s.CourseInstance`.`learner_id`, `s.CourseInstance`.`org_id`, `s.CourseInstance`.`room_id`, `s.CourseInstance`.`teacher_id`, `s.GroupCourseInstance`.`group_course_instance_id`, `s.GroupCourseInstance`.`begin_date`, `s.GroupCourseInstance`.`course_id`, `s.GroupCourseInstance`.`end_date`, `s.GroupCourseInstance`.`invoice_date`, `s.GroupCourseInstance`.`is_activate`, `s.GroupCourseInstance`.`is_started`, `s.GroupCourseInstance`.`org_id`, `s.GroupCourseInstance`.`room_id`, `s.GroupCourseInstance`.`teacher_id`, `s`.`org_id` AS `OrgId`, `s`.`begin_time` AS `start`, `s`.`lesson_id` AS `id`, `s`.`room_id` AS `resourceId`, `s`.`end_time` AS `end`, `s.Teacher`.`first_name` AS `TeacherFirstName0`, `s`.`is_canceled` AS `IsCanceled`, `s`.`is_confirm` AS `IsConfirm`, `s`.`is_changed` AS `IsChanged`, (
    SELECT `z`.`first_name`
    FROM `ablemusic`.`teacher` AS `z`
    WHERE `z`.`teacher_id` = (
        SELECT `r`.`teacher_id`
        FROM `ablemusic`.`lesson` AS `r`
        WHERE `r`.`lesson_id` = `s`.`new_lesson_id`
        LIMIT 1
    )
    LIMIT 1
) AS `TeacherFirstName`, (
    SELECT `z0`.`last_name`
    FROM `ablemusic`.`teacher` AS `z0`
    WHERE `z0`.`teacher_id` = (
        SELECT `r0`.`teacher_id`
        FROM `ablemusic`.`lesson` AS `r0`
        WHERE `r0`.`lesson_id` = `s`.`new_lesson_id`
        LIMIT 1
    )
    LIMIT 1
) AS `TeacherLastName`, (
    SELECT `z1`.`room_name`
    FROM `ablemusic`.`room` AS `z1`
    WHERE `z1`.`room_id` = (
        SELECT `r1`.`room_id`
        FROM `ablemusic`.`lesson` AS `r1`
        WHERE `r1`.`lesson_id` = `s`.`new_lesson_id`
        LIMIT 1
    )
    LIMIT 1
) AS `RoomName`, (
    SELECT `z2`.`org_name`
    FROM `ablemusic`.`org` AS `z2`
    WHERE `z2`.`org_id` = (
        SELECT `r2`.`org_id`
        FROM `ablemusic`.`lesson` AS `r2`
        WHERE `r2`.`lesson_id` = `s`.`new_lesson_id`
        LIMIT 1
    )
    LIMIT 1
) AS `OrgName`, (
    SELECT `r3`.`begin_time`
    FROM `ablemusic`.`lesson` AS `r3`
    WHERE `r3`.`lesson_id` = `s`.`new_lesson_id`
    LIMIT 1
) AS `BeginTime`, `s`.`reason`, CASE
    WHEN `s`.`is_paid` = 1
    THEN 0 ELSE 1
END, CASE
    WHEN (
        SELECT `q1`.`quantity`
        FROM `ablemusic`.`lesson_remain` AS `q1`
        WHERE ((`q1`.`learner_id` = `s`.`learner_id`) OR (`q1`.`learner_id` IS NULL AND `s`.`learner_id` IS NULL)) AND ((`q1`.`course_instance_id` = `s`.`course_instance_id`) OR (`q1`.`course_instance_id` IS NULL AND `s`.`course_instance_id` IS NULL))
        LIMIT 1
    ) <= 3
    THEN 1 ELSE 0
END, `s.Learner`.`first_name` AS `FirstName`, `s`.`learner_id` AS `LearnerId`, `s.Room`.`room_name` AS `RoomName0`, `s.Org`.`org_name` AS `OrgName0`, `s`.`teacher_id` AS `TeacherId`, `s.GroupCourseInstance.Course`.`course_name`, `s.TrialCourse`.`course_name`, `s.CourseInstance.Course`.`course_name`, `s.GroupCourseInstance.Course`.`course_id`, `s`.`trial_course_id`, `s.CourseInstance.Course`.`course_id`, `s`.`learner_id` AS `LearnerId0`
FROM `ablemusic`.`lesson` AS `s`
LEFT JOIN `ablemusic`.`course` AS `s.TrialCourse` ON `s`.`trial_course_id` = `s.TrialCourse`.`course_id`
INNER JOIN `ablemusic`.`org` AS `s.Org` ON `s`.`org_id` = `s.Org`.`org_id`
LEFT JOIN `ablemusic`.`room` AS `s.Room` ON `s`.`room_id` = `s.Room`.`room_id`
LEFT JOIN `ablemusic`.`learner` AS `s.Learner` ON `s`.`learner_id` = `s.Learner`.`learner_id`
LEFT JOIN `ablemusic`.`teacher` AS `s.Teacher` ON `s`.`teacher_id` = `s.Teacher`.`teacher_id`
LEFT JOIN `ablemusic`.`one2one_course_instance` AS `s.CourseInstance` ON `s`.`course_instance_id` = `s.CourseInstance`.`course_instance_id`
LEFT JOIN `ablemusic`.`course` AS `s.CourseInstance.Course` ON `s.CourseInstance`.`course_id` = `s.CourseInstance.Course`.`course_id`
LEFT JOIN `ablemusic`.`group_course_instance` AS `s.GroupCourseInstance` ON `s`.`group_course_instance_id` = `s.GroupCourseInstance`.`group_course_instance_id`
LEFT JOIN `ablemusic`.`course` AS `s.GroupCourseInstance.Course` ON `s.GroupCourseInstance`.`course_id` = `s.GroupCourseInstance.Course`.`course_id`
2019-07-17 12:26:56.083 +12:00 [INF] Executed action method Pegasus_backend.Controllers.LessonController.GetLessonsForReceptionist (Pegasus_backend), returned result Microsoft.AspNetCore.Mvc.OkObjectResult in 1364.9826ms.
2019-07-17 12:26:56.084 +12:00 [INF] Executing ObjectResult, writing value of type 'Pegasus_backend.Models.Result`1[[System.Object, System.Private.CoreLib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2019-07-17 12:26:56.085 +12:00 [INF] Executed action Pegasus_backend.Controllers.LessonController.GetLessonsForReceptionist (Pegasus_backend) in 1366.6525000000001ms
2019-07-17 12:26:56.085 +12:00 [INF] Request finished in 1367.7729ms 200 application/json; charset=utf-8
2019-07-17 12:28:58.316 +12:00 [INF] User profile is available. Using 'C:\Users\Learnspace\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2019-07-17 12:28:59.750 +12:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/  
2019-07-17 12:28:59.785 +12:00 [WRN] Failed to determine the https port for redirect.
2019-07-17 12:28:59.991 +12:00 [INF] Request finished in 243.1548ms 404 
2019-07-17 12:29:16.984 +12:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5000/api/LessonRearrange/3  
2019-07-17 12:29:16.985 +12:00 [INF] Policy execution successful.
2019-07-17 12:29:16.987 +12:00 [INF] Request finished in 2.8843ms 204 
2019-07-17 12:29:17.002 +12:00 [INF] Request starting HTTP/1.1 PUT http://localhost:5000/api/LessonRearrange/3 application/json 133
2019-07-17 12:29:17.003 +12:00 [INF] Policy execution successful.
2019-07-17 12:29:17.037 +12:00 [INF] Route matched with {action = "PutLesson", controller = "LessonRearrange"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] PutLesson(Int16, Pegasus_backend.Models.LessonViewModel) on controller Pegasus_backend.Controllers.LessonRearrangeController (Pegasus_backend).
2019-07-17 12:29:17.687 +12:00 [INF] Executing action method Pegasus_backend.Controllers.LessonRearrangeController.PutLesson (Pegasus_backend) - Validation state: "Valid"
2019-07-17 12:29:18.975 +12:00 [INF] Entity Framework Core 2.1.11-servicing-32099 initialized 'ablemusicContext' using provider 'MySql.Data.EntityFrameworkCore' with options: None
2019-07-17 12:29:22.423 +12:00 [INF] Executed DbCommand (68ms) [Parameters=[@__newLesson_LessonId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT `l`.`lesson_id`, `l`.`begin_time`, `l`.`course_instance_id`, `l`.`created_at`, `l`.`end_time`, `l`.`group_course_instance_id`, `l`.`invoice_id`, `l`.`is_canceled`, `l`.`is_changed`, `l`.`is_confirm`, `l`.`is_paid`, `l`.`is_trial`, `l`.`learner_id`, `l`.`new_lesson_id`, `l`.`org_id`, `l`.`reason`, `l`.`room_id`, `l`.`teacher_id`, `l`.`trial_course_id`
FROM `ablemusic`.`lesson` AS `l`
WHERE `l`.`lesson_id` = @__newLesson_LessonId_0
LIMIT 1
2019-07-17 12:29:24.857 +12:00 [INF] Executed action method Pegasus_backend.Controllers.LessonRearrangeController.PutLesson (Pegasus_backend), returned result Microsoft.AspNetCore.Mvc.BadRequestObjectResult in 7160.4696ms.
2019-07-17 12:29:24.868 +12:00 [INF] Executing ObjectResult, writing value of type 'Pegasus_backend.Models.Result`1[[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2019-07-17 12:29:24.898 +12:00 [INF] Executed action Pegasus_backend.Controllers.LessonRearrangeController.PutLesson (Pegasus_backend) in 7857.6761000000006ms
2019-07-17 12:29:24.900 +12:00 [INF] Request finished in 7897.1428ms 400 application/json; charset=utf-8
2019-07-17 12:30:23.314 +12:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5000/api/LessonRearrange/3  
2019-07-17 12:30:23.333 +12:00 [INF] Policy execution successful.
2019-07-17 12:30:23.333 +12:00 [INF] Request finished in 21.3466ms 204 
2019-07-17 12:30:23.344 +12:00 [INF] Request starting HTTP/1.1 PUT http://localhost:5000/api/LessonRearrange/3 application/json 133
2019-07-17 12:30:23.344 +12:00 [INF] Policy execution successful.
2019-07-17 12:30:23.345 +12:00 [INF] Route matched with {action = "PutLesson", controller = "LessonRearrange"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] PutLesson(Int16, Pegasus_backend.Models.LessonViewModel) on controller Pegasus_backend.Controllers.LessonRearrangeController (Pegasus_backend).
2019-07-17 12:30:23.347 +12:00 [INF] Executing action method Pegasus_backend.Controllers.LessonRearrangeController.PutLesson (Pegasus_backend) - Validation state: "Valid"
2019-07-17 12:30:23.368 +12:00 [INF] Entity Framework Core 2.1.11-servicing-32099 initialized 'ablemusicContext' using provider 'MySql.Data.EntityFrameworkCore' with options: None
2019-07-17 12:30:23.601 +12:00 [INF] Executed DbCommand (72ms) [Parameters=[@__newLesson_LessonId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT `l`.`lesson_id`, `l`.`begin_time`, `l`.`course_instance_id`, `l`.`created_at`, `l`.`end_time`, `l`.`group_course_instance_id`, `l`.`invoice_id`, `l`.`is_canceled`, `l`.`is_changed`, `l`.`is_confirm`, `l`.`is_paid`, `l`.`is_trial`, `l`.`learner_id`, `l`.`new_lesson_id`, `l`.`org_id`, `l`.`reason`, `l`.`room_id`, `l`.`teacher_id`, `l`.`trial_course_id`
FROM `ablemusic`.`lesson` AS `l`
WHERE `l`.`lesson_id` = @__newLesson_LessonId_0
LIMIT 1
2019-07-17 12:30:24.905 +12:00 [INF] Executed action method Pegasus_backend.Controllers.LessonRearrangeController.PutLesson (Pegasus_backend), returned result Microsoft.AspNetCore.Mvc.BadRequestObjectResult in 1557.9149ms.
2019-07-17 12:30:24.906 +12:00 [INF] Executing ObjectResult, writing value of type 'Pegasus_backend.Models.Result`1[[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2019-07-17 12:30:24.908 +12:00 [INF] Executed action Pegasus_backend.Controllers.LessonRearrangeController.PutLesson (Pegasus_backend) in 1562.999ms
2019-07-17 12:30:24.909 +12:00 [INF] Request finished in 1564.8776ms 400 application/json; charset=utf-8
2019-07-17 12:30:30.666 +12:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5000/api/lesson/GetLessonsForReceptionist/3/2019-07-20  
2019-07-17 12:30:30.667 +12:00 [INF] Policy execution successful.
2019-07-17 12:30:30.667 +12:00 [INF] Request finished in 0.446ms 204 
2019-07-17 12:30:30.676 +12:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/api/lesson/GetLessonsForReceptionist/3/2019-07-20  
2019-07-17 12:30:30.676 +12:00 [INF] Policy execution successful.
2019-07-17 12:30:30.689 +12:00 [INF] Successfully validated the token.
2019-07-17 12:30:30.695 +12:00 [INF] Route matched with {action = "GetLessonsForReceptionist", controller = "Lesson"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetLessonsForReceptionist(Int32, System.DateTime) on controller Pegasus_backend.Controllers.LessonController (Pegasus_backend).
2019-07-17 12:30:30.696 +12:00 [INF] Executing action method Pegasus_backend.Controllers.LessonController.GetLessonsForReceptionist (Pegasus_backend) - Validation state: "Valid"
2019-07-17 12:30:30.724 +12:00 [INF] Entity Framework Core 2.1.11-servicing-32099 initialized 'ablemusicContext' using provider 'MySql.Data.EntityFrameworkCore' with options: None
2019-07-17 12:30:31.030 +12:00 [INF] Executed DbCommand (61ms) [Parameters=[@__8__locals1_userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT `s`.`staff_id`, `s`.`dob`, `s`.`email`, `s`.`expiry_date`, `s`.`first_name`, `s`.`gender`, `s`.`home_phone`, `s`.`id_number`, `s`.`id_photo`, `s`.`id_type`, `s`.`ird_number`, `s`.`is_activate`, `s`.`last_name`, `s`.`mobile_phone`, `s`.`photo`, `s`.`user_id`, `s`.`visa`
FROM `ablemusic`.`staff` AS `s`
WHERE `s`.`user_id` = @__8__locals1_userId_0
LIMIT 1
2019-07-17 12:30:31.324 +12:00 [INF] Executed DbCommand (62ms) [Parameters=[@__staff_StaffId_0='?' (DbType = Int16)], CommandType='"Text"', CommandTimeout='30']
SELECT `s`.`staff_org_id`, `s`.`is_activate`, `s`.`org_id`, `s`.`staff_id`
FROM `ablemusic`.`staff_org` AS `s`
WHERE `s`.`staff_id` = @__staff_StaffId_0
LIMIT 1
2019-07-17 12:30:31.393 +12:00 [WRN] The Include operation for navigation '[s].CourseInstance' is unnecessary and was ignored because the navigation is not reachable in the final query results. See https://go.microsoft.com/fwlink/?linkid=850303 for more information.
2019-07-17 12:30:31.394 +12:00 [WRN] The Include operation for navigation '[s].Learner' is unnecessary and was ignored because the navigation is not reachable in the final query results. See https://go.microsoft.com/fwlink/?linkid=850303 for more information.
2019-07-17 12:30:31.394 +12:00 [WRN] The Include operation for navigation '[s].Teacher' is unnecessary and was ignored because the navigation is not reachable in the final query results. See https://go.microsoft.com/fwlink/?linkid=850303 for more information.
2019-07-17 12:30:31.394 +12:00 [WRN] The Include operation for navigation '[s].Room' is unnecessary and was ignored because the navigation is not reachable in the final query results. See https://go.microsoft.com/fwlink/?linkid=850303 for more information.
2019-07-17 12:30:31.394 +12:00 [WRN] The Include operation for navigation '[s].Org' is unnecessary and was ignored because the navigation is not reachable in the final query results. See https://go.microsoft.com/fwlink/?linkid=850303 for more information.
2019-07-17 12:30:31.394 +12:00 [WRN] The Include operation for navigation '[s].TrialCourse' is unnecessary and was ignored because the navigation is not reachable in the final query results. See https://go.microsoft.com/fwlink/?linkid=850303 for more information.
2019-07-17 12:30:31.394 +12:00 [WRN] The Include operation for navigation '[s].GroupCourseInstance.LearnerGroupCourse.Learner' is unnecessary and was ignored because the navigation is not reachable in the final query results. See https://go.microsoft.com/fwlink/?linkid=850303 for more information.
2019-07-17 12:30:31.394 +12:00 [WRN] The Include operation for navigation '[s].AwaitMakeUpLessonNewLesson' is unnecessary and was ignored because the navigation is not reachable in the final query results. See https://go.microsoft.com/fwlink/?linkid=850303 for more information.
2019-07-17 12:30:31.453 +12:00 [WRN] The LINQ expression 'where ((((Convert(Convert([s].OrgId, Int32), Nullable`1) == Convert(__orgId_0, Nullable`1)) AndAlso (Convert([s].BeginTime, DateTime).Year == __8__locals1_date_Year_1)) AndAlso (Convert([s].BeginTime, DateTime).Month == __8__locals1_date_Month_2)) AndAlso (Convert([s].BeginTime, DateTime).Day == __8__locals1_date_Day_3))' could not be translated and will be evaluated locally.
2019-07-17 12:30:31.788 +12:00 [INF] Executed DbCommand (112ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT `s.CourseInstance`.`course_instance_id`, `s.CourseInstance`.`begin_date`, `s.CourseInstance`.`course_id`, `s.CourseInstance`.`end_date`, `s.CourseInstance`.`invoice_date`, `s.CourseInstance`.`learner_id`, `s.CourseInstance`.`org_id`, `s.CourseInstance`.`room_id`, `s.CourseInstance`.`teacher_id`, `s.GroupCourseInstance`.`group_course_instance_id`, `s.GroupCourseInstance`.`begin_date`, `s.GroupCourseInstance`.`course_id`, `s.GroupCourseInstance`.`end_date`, `s.GroupCourseInstance`.`invoice_date`, `s.GroupCourseInstance`.`is_activate`, `s.GroupCourseInstance`.`is_started`, `s.GroupCourseInstance`.`org_id`, `s.GroupCourseInstance`.`room_id`, `s.GroupCourseInstance`.`teacher_id`, `s`.`org_id` AS `OrgId`, `s`.`begin_time` AS `start`, `s`.`lesson_id` AS `id`, `s`.`room_id` AS `resourceId`, `s`.`end_time` AS `end`, `s.Teacher`.`first_name` AS `TeacherFirstName0`, `s`.`is_canceled` AS `IsCanceled`, `s`.`is_confirm` AS `IsConfirm`, `s`.`is_changed` AS `IsChanged`, (
    SELECT `z`.`first_name`
    FROM `ablemusic`.`teacher` AS `z`
    WHERE `z`.`teacher_id` = (
        SELECT `r`.`teacher_id`
        FROM `ablemusic`.`lesson` AS `r`
        WHERE `r`.`lesson_id` = `s`.`new_lesson_id`
        LIMIT 1
    )
    LIMIT 1
) AS `TeacherFirstName`, (
    SELECT `z0`.`last_name`
    FROM `ablemusic`.`teacher` AS `z0`
    WHERE `z0`.`teacher_id` = (
        SELECT `r0`.`teacher_id`
        FROM `ablemusic`.`lesson` AS `r0`
        WHERE `r0`.`lesson_id` = `s`.`new_lesson_id`
        LIMIT 1
    )
    LIMIT 1
) AS `TeacherLastName`, (
    SELECT `z1`.`room_name`
    FROM `ablemusic`.`room` AS `z1`
    WHERE `z1`.`room_id` = (
        SELECT `r1`.`room_id`
        FROM `ablemusic`.`lesson` AS `r1`
        WHERE `r1`.`lesson_id` = `s`.`new_lesson_id`
        LIMIT 1
    )
    LIMIT 1
) AS `RoomName`, (
    SELECT `z2`.`org_name`
    FROM `ablemusic`.`org` AS `z2`
    WHERE `z2`.`org_id` = (
        SELECT `r2`.`org_id`
        FROM `ablemusic`.`lesson` AS `r2`
        WHERE `r2`.`lesson_id` = `s`.`new_lesson_id`
        LIMIT 1
    )
    LIMIT 1
) AS `OrgName`, (
    SELECT `r3`.`begin_time`
    FROM `ablemusic`.`lesson` AS `r3`
    WHERE `r3`.`lesson_id` = `s`.`new_lesson_id`
    LIMIT 1
) AS `BeginTime`, `s`.`reason`, CASE
    WHEN `s`.`is_paid` = 1
    THEN 0 ELSE 1
END, CASE
    WHEN (
        SELECT `q1`.`quantity`
        FROM `ablemusic`.`lesson_remain` AS `q1`
        WHERE ((`q1`.`learner_id` = `s`.`learner_id`) OR (`q1`.`learner_id` IS NULL AND `s`.`learner_id` IS NULL)) AND ((`q1`.`course_instance_id` = `s`.`course_instance_id`) OR (`q1`.`course_instance_id` IS NULL AND `s`.`course_instance_id` IS NULL))
        LIMIT 1
    ) <= 3
    THEN 1 ELSE 0
END, `s.Learner`.`first_name` AS `FirstName`, `s`.`learner_id` AS `LearnerId`, `s.Room`.`room_name` AS `RoomName0`, `s.Org`.`org_name` AS `OrgName0`, `s`.`teacher_id` AS `TeacherId`, `s.GroupCourseInstance.Course`.`course_name`, `s.TrialCourse`.`course_name`, `s.CourseInstance.Course`.`course_name`, `s.GroupCourseInstance.Course`.`course_id`, `s`.`trial_course_id`, `s.CourseInstance.Course`.`course_id`, `s`.`learner_id` AS `LearnerId0`
FROM `ablemusic`.`lesson` AS `s`
LEFT JOIN `ablemusic`.`course` AS `s.TrialCourse` ON `s`.`trial_course_id` = `s.TrialCourse`.`course_id`
INNER JOIN `ablemusic`.`org` AS `s.Org` ON `s`.`org_id` = `s.Org`.`org_id`
LEFT JOIN `ablemusic`.`room` AS `s.Room` ON `s`.`room_id` = `s.Room`.`room_id`
LEFT JOIN `ablemusic`.`learner` AS `s.Learner` ON `s`.`learner_id` = `s.Learner`.`learner_id`
LEFT JOIN `ablemusic`.`teacher` AS `s.Teacher` ON `s`.`teacher_id` = `s.Teacher`.`teacher_id`
LEFT JOIN `ablemusic`.`one2one_course_instance` AS `s.CourseInstance` ON `s`.`course_instance_id` = `s.CourseInstance`.`course_instance_id`
LEFT JOIN `ablemusic`.`course` AS `s.CourseInstance.Course` ON `s.CourseInstance`.`course_id` = `s.CourseInstance.Course`.`course_id`
LEFT JOIN `ablemusic`.`group_course_instance` AS `s.GroupCourseInstance` ON `s`.`group_course_instance_id` = `s.GroupCourseInstance`.`group_course_instance_id`
LEFT JOIN `ablemusic`.`course` AS `s.GroupCourseInstance.Course` ON `s.GroupCourseInstance`.`course_id` = `s.GroupCourseInstance.Course`.`course_id`
2019-07-17 12:30:32.067 +12:00 [INF] Executed action method Pegasus_backend.Controllers.LessonController.GetLessonsForReceptionist (Pegasus_backend), returned result Microsoft.AspNetCore.Mvc.OkObjectResult in 1370.5154ms.
2019-07-17 12:30:32.068 +12:00 [INF] Executing ObjectResult, writing value of type 'Pegasus_backend.Models.Result`1[[System.Object, System.Private.CoreLib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2019-07-17 12:30:32.113 +12:00 [INF] Executed action Pegasus_backend.Controllers.LessonController.GetLessonsForReceptionist (Pegasus_backend) in 1417.6359ms
2019-07-17 12:30:32.113 +12:00 [INF] Request finished in 1437.2789ms 200 application/json; charset=utf-8
2019-07-17 12:30:39.945 +12:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5000/api/LessonRearrange/3  
2019-07-17 12:30:39.945 +12:00 [INF] Policy execution successful.
2019-07-17 12:30:39.945 +12:00 [INF] Request finished in 0.4045ms 204 
2019-07-17 12:30:39.967 +12:00 [INF] Request starting HTTP/1.1 PUT http://localhost:5000/api/LessonRearrange/3 application/json 133
2019-07-17 12:30:39.967 +12:00 [INF] Policy execution successful.
2019-07-17 12:30:39.968 +12:00 [INF] Route matched with {action = "PutLesson", controller = "LessonRearrange"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] PutLesson(Int16, Pegasus_backend.Models.LessonViewModel) on controller Pegasus_backend.Controllers.LessonRearrangeController (Pegasus_backend).
2019-07-17 12:30:39.968 +12:00 [INF] Executing action method Pegasus_backend.Controllers.LessonRearrangeController.PutLesson (Pegasus_backend) - Validation state: "Valid"
2019-07-17 12:30:39.969 +12:00 [INF] Entity Framework Core 2.1.11-servicing-32099 initialized 'ablemusicContext' using provider 'MySql.Data.EntityFrameworkCore' with options: None
2019-07-17 12:30:40.815 +12:00 [INF] Executed DbCommand (310ms) [Parameters=[@__newLesson_LessonId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT `l`.`lesson_id`, `l`.`begin_time`, `l`.`course_instance_id`, `l`.`created_at`, `l`.`end_time`, `l`.`group_course_instance_id`, `l`.`invoice_id`, `l`.`is_canceled`, `l`.`is_changed`, `l`.`is_confirm`, `l`.`is_paid`, `l`.`is_trial`, `l`.`learner_id`, `l`.`new_lesson_id`, `l`.`org_id`, `l`.`reason`, `l`.`room_id`, `l`.`teacher_id`, `l`.`trial_course_id`
FROM `ablemusic`.`lesson` AS `l`
WHERE `l`.`lesson_id` = @__newLesson_LessonId_0
LIMIT 1
2019-07-17 12:30:44.269 +12:00 [INF] Executed action method Pegasus_backend.Controllers.LessonRearrangeController.PutLesson (Pegasus_backend), returned result Microsoft.AspNetCore.Mvc.BadRequestObjectResult in 4300.0182ms.
2019-07-17 12:30:44.269 +12:00 [INF] Executing ObjectResult, writing value of type 'Pegasus_backend.Models.Result`1[[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2019-07-17 12:30:44.270 +12:00 [INF] Executed action Pegasus_backend.Controllers.LessonRearrangeController.PutLesson (Pegasus_backend) in 4302.167ms
2019-07-17 12:30:44.270 +12:00 [INF] Request finished in 4303.2656ms 400 application/json; charset=utf-8
2019-07-17 12:31:00.932 +12:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5000/api/LessonRearrange/3  
2019-07-17 12:31:00.932 +12:00 [INF] Policy execution successful.
2019-07-17 12:31:00.933 +12:00 [INF] Request finished in 0.3878ms 204 
2019-07-17 12:31:00.951 +12:00 [INF] Request starting HTTP/1.1 PUT http://localhost:5000/api/LessonRearrange/3 application/json 133
2019-07-17 12:31:00.951 +12:00 [INF] Policy execution successful.
2019-07-17 12:31:00.951 +12:00 [INF] Route matched with {action = "PutLesson", controller = "LessonRearrange"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] PutLesson(Int16, Pegasus_backend.Models.LessonViewModel) on controller Pegasus_backend.Controllers.LessonRearrangeController (Pegasus_backend).
2019-07-17 12:31:00.952 +12:00 [INF] Executing action method Pegasus_backend.Controllers.LessonRearrangeController.PutLesson (Pegasus_backend) - Validation state: "Valid"
2019-07-17 12:31:23.428 +12:00 [INF] Entity Framework Core 2.1.11-servicing-32099 initialized 'ablemusicContext' using provider 'MySql.Data.EntityFrameworkCore' with options: None
2019-07-17 12:31:23.633 +12:00 [INF] Executed DbCommand (61ms) [Parameters=[@__newLesson_LessonId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT `l`.`lesson_id`, `l`.`begin_time`, `l`.`course_instance_id`, `l`.`created_at`, `l`.`end_time`, `l`.`group_course_instance_id`, `l`.`invoice_id`, `l`.`is_canceled`, `l`.`is_changed`, `l`.`is_confirm`, `l`.`is_paid`, `l`.`is_trial`, `l`.`learner_id`, `l`.`new_lesson_id`, `l`.`org_id`, `l`.`reason`, `l`.`room_id`, `l`.`teacher_id`, `l`.`trial_course_id`
FROM `ablemusic`.`lesson` AS `l`
WHERE `l`.`lesson_id` = @__newLesson_LessonId_0
LIMIT 1
2019-07-17 12:31:24.985 +12:00 [INF] Executed action method Pegasus_backend.Controllers.LessonRearrangeController.PutLesson (Pegasus_backend), returned result Microsoft.AspNetCore.Mvc.BadRequestObjectResult in 24033.5256ms.
2019-07-17 12:31:24.986 +12:00 [INF] Executing ObjectResult, writing value of type 'Pegasus_backend.Models.Result`1[[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2019-07-17 12:31:24.986 +12:00 [INF] Executed action Pegasus_backend.Controllers.LessonRearrangeController.PutLesson (Pegasus_backend) in 24035.1669ms
2019-07-17 12:31:24.987 +12:00 [INF] Request finished in 24036.011ms 400 application/json; charset=utf-8
2019-07-17 12:32:04.130 +12:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5000/api/LessonRearrange/3  
2019-07-17 12:32:04.130 +12:00 [INF] Policy execution successful.
2019-07-17 12:32:04.130 +12:00 [INF] Request finished in 0.419ms 204 
2019-07-17 12:32:04.144 +12:00 [INF] Request starting HTTP/1.1 PUT http://localhost:5000/api/LessonRearrange/3 application/json 133
2019-07-17 12:32:04.144 +12:00 [INF] Policy execution successful.
2019-07-17 12:32:04.145 +12:00 [INF] Route matched with {action = "PutLesson", controller = "LessonRearrange"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] PutLesson(Int16, Pegasus_backend.Models.LessonViewModel) on controller Pegasus_backend.Controllers.LessonRearrangeController (Pegasus_backend).
2019-07-17 12:32:04.145 +12:00 [INF] Executing action method Pegasus_backend.Controllers.LessonRearrangeController.PutLesson (Pegasus_backend) - Validation state: "Valid"
2019-07-17 12:32:08.312 +12:00 [INF] Entity Framework Core 2.1.11-servicing-32099 initialized 'ablemusicContext' using provider 'MySql.Data.EntityFrameworkCore' with options: None
2019-07-17 12:32:08.521 +12:00 [INF] Executed DbCommand (62ms) [Parameters=[@__newLesson_LessonId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT `l`.`lesson_id`, `l`.`begin_time`, `l`.`course_instance_id`, `l`.`created_at`, `l`.`end_time`, `l`.`group_course_instance_id`, `l`.`invoice_id`, `l`.`is_canceled`, `l`.`is_changed`, `l`.`is_confirm`, `l`.`is_paid`, `l`.`is_trial`, `l`.`learner_id`, `l`.`new_lesson_id`, `l`.`org_id`, `l`.`reason`, `l`.`room_id`, `l`.`teacher_id`, `l`.`trial_course_id`
FROM `ablemusic`.`lesson` AS `l`
WHERE `l`.`lesson_id` = @__newLesson_LessonId_0
LIMIT 1
2019-07-17 12:33:18.769 +12:00 [INF] Executed action method Pegasus_backend.Controllers.LessonRearrangeController.PutLesson (Pegasus_backend), returned result Microsoft.AspNetCore.Mvc.BadRequestObjectResult in 74616.2382ms.
2019-07-17 12:33:18.812 +12:00 [INF] Executing ObjectResult, writing value of type 'Pegasus_backend.Models.Result`1[[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2019-07-17 12:33:18.823 +12:00 [INF] Executed action Pegasus_backend.Controllers.LessonRearrangeController.PutLesson (Pegasus_backend) in 74677.909ms
2019-07-17 12:33:18.823 +12:00 [INF] Request finished in 74678.789ms 400 application/json; charset=utf-8
2019-07-17 12:34:50.746 +12:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5000/api/LessonRearrange/3  
2019-07-17 12:34:50.746 +12:00 [INF] Policy execution successful.
2019-07-17 12:34:50.746 +12:00 [INF] Request finished in 0.3852ms 204 
2019-07-17 12:34:50.751 +12:00 [INF] Request starting HTTP/1.1 PUT http://localhost:5000/api/LessonRearrange/3 application/json 133
2019-07-17 12:34:50.751 +12:00 [INF] Policy execution successful.
2019-07-17 12:34:50.751 +12:00 [INF] Route matched with {action = "PutLesson", controller = "LessonRearrange"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] PutLesson(Int16, Pegasus_backend.Models.LessonViewModel) on controller Pegasus_backend.Controllers.LessonRearrangeController (Pegasus_backend).
2019-07-17 12:34:50.752 +12:00 [INF] Executing action method Pegasus_backend.Controllers.LessonRearrangeController.PutLesson (Pegasus_backend) - Validation state: "Valid"
2019-07-17 12:35:00.494 +12:00 [INF] Entity Framework Core 2.1.11-servicing-32099 initialized 'ablemusicContext' using provider 'MySql.Data.EntityFrameworkCore' with options: None
2019-07-17 12:35:00.721 +12:00 [INF] Executed DbCommand (70ms) [Parameters=[@__newLesson_LessonId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT `l`.`lesson_id`, `l`.`begin_time`, `l`.`course_instance_id`, `l`.`created_at`, `l`.`end_time`, `l`.`group_course_instance_id`, `l`.`invoice_id`, `l`.`is_canceled`, `l`.`is_changed`, `l`.`is_confirm`, `l`.`is_paid`, `l`.`is_trial`, `l`.`learner_id`, `l`.`new_lesson_id`, `l`.`org_id`, `l`.`reason`, `l`.`room_id`, `l`.`teacher_id`, `l`.`trial_course_id`
FROM `ablemusic`.`lesson` AS `l`
WHERE `l`.`lesson_id` = @__newLesson_LessonId_0
LIMIT 1
2019-07-17 15:12:39.557 +12:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5000/api/lookups  
2019-07-17 15:12:39.560 +12:00 [INF] Policy execution successful.
2019-07-17 15:12:39.570 +12:00 [INF] Request finished in 12.9346ms 0 
2019-07-17 15:12:39.572 +12:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5000/api/navitems  
2019-07-17 15:12:39.573 +12:00 [INF] Policy execution successful.
2019-07-17 15:12:39.578 +12:00 [INF] Request finished in 3.3021ms 0 
2019-07-17 15:12:39.587 +12:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5000/api/room/forCalendar  
2019-07-17 15:12:39.587 +12:00 [INF] Policy execution successful.
2019-07-17 15:12:39.588 +12:00 [INF] Request finished in 1.4424ms 0 
2019-07-17 15:19:03.044 +12:00 [INF] Executed action method Pegasus_backend.Controllers.LessonRearrangeController.PutLesson (Pegasus_backend), returned result Microsoft.AspNetCore.Mvc.BadRequestObjectResult in 9852438.7756000012ms.
2019-07-17 15:19:03.044 +12:00 [INF] Executing ObjectResult, writing value of type 'Pegasus_backend.Models.Result`1[[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2019-07-17 15:19:03.045 +12:00 [INF] Executed action Pegasus_backend.Controllers.LessonRearrangeController.PutLesson (Pegasus_backend) in 9852440.5986ms
2019-07-17 15:19:03.045 +12:00 [INF] Request finished in 9852441.2794ms 400 application/json; charset=utf-8
